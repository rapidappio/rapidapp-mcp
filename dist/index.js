"use strict";var p0=Object.create;var df=Object.defineProperty;var g0=Object.getOwnPropertyDescriptor;var m0=Object.getOwnPropertyNames;var y0=Object.getPrototypeOf,v0=Object.prototype.hasOwnProperty;var S=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var _0=(t,e,r,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of m0(e))!v0.call(t,n)&&n!==r&&df(t,n,{get:()=>e[n],enumerable:!(i=g0(e,n))||i.enumerable});return t};var hf=(t,e,r)=>(r=t!=null?p0(y0(t)):{},_0(e||!t||!t.__esModule?df(r,"default",{value:t,enumerable:!0}):r,t));var ne=S(Ct=>{"use strict";Object.defineProperty(Ct,"__esModule",{value:!0});Ct.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=Ct.DEFAULT_MAX_SEND_MESSAGE_LENGTH=Ct.Propagate=Ct.LogVerbosity=Ct.Status=void 0;var qf;(function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED"})(qf||(Ct.Status=qf={}));var Bf;(function(t){t[t.DEBUG=0]="DEBUG",t[t.INFO=1]="INFO",t[t.ERROR=2]="ERROR",t[t.NONE=3]="NONE"})(Bf||(Ct.LogVerbosity=Bf={}));var jf;(function(t){t[t.DEADLINE=1]="DEADLINE",t[t.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",t[t.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",t[t.CANCELLATION=8]="CANCELLATION",t[t.DEFAULTS=65535]="DEFAULTS"})(jf||(Ct.Propagate=jf={}));Ct.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1;Ct.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4*1024*1024});var Vl=S((Yx,mS)=>{mS.exports={name:"@grpc/grpc-js",version:"1.13.2",description:"gRPC Library for Node - pure JS implementation",homepage:"https://grpc.io/",repository:"https://github.com/grpc/grpc-node/tree/master/packages/grpc-js",main:"build/src/index.js",engines:{node:">=12.10.0"},keywords:[],author:{name:"Google Inc."},types:"build/src/index.d.ts",license:"Apache-2.0",devDependencies:{"@grpc/proto-loader":"file:../proto-loader","@types/gulp":"^4.0.17","@types/gulp-mocha":"0.0.37","@types/lodash":"^4.14.202","@types/mocha":"^10.0.6","@types/ncp":"^2.0.8","@types/node":">=20.11.20","@types/pify":"^5.0.4","@types/semver":"^7.5.8","@typescript-eslint/eslint-plugin":"^7.1.0","@typescript-eslint/parser":"^7.1.0","@typescript-eslint/typescript-estree":"^7.1.0","clang-format":"^1.8.0",eslint:"^8.42.0","eslint-config-prettier":"^8.8.0","eslint-plugin-node":"^11.1.0","eslint-plugin-prettier":"^4.2.1",execa:"^2.0.3",gulp:"^4.0.2","gulp-mocha":"^6.0.0",lodash:"^4.17.21",madge:"^5.0.1","mocha-jenkins-reporter":"^0.4.1",ncp:"^2.0.0",pify:"^4.0.1",prettier:"^2.8.8",rimraf:"^3.0.2",semver:"^7.6.0","ts-node":"^10.9.2",typescript:"^5.3.3"},contributors:[{name:"Google Inc."}],scripts:{build:"npm run compile",clean:"rimraf ./build",compile:"tsc -p .",format:'clang-format -i -style="{Language: JavaScript, BasedOnStyle: Google, ColumnLimit: 80}" src/*.ts test/*.ts',lint:"eslint src/*.ts test/*.ts",prepare:"npm run generate-types && npm run compile",test:"gulp test",check:"npm run lint",fix:"eslint --fix src/*.ts test/*.ts",pretest:"npm run generate-types && npm run generate-test-types && npm run compile",posttest:"npm run check && madge -c ./build/src","generate-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --includeDirs proto/ --include-dirs test/fixtures/ -O src/generated/ --grpcLib ../index channelz.proto","generate-test-types":"proto-loader-gen-types --keepCase --longs String --enums String --defaults --oneofs --includeComments --include-dirs test/fixtures/ -O test/generated/ --grpcLib ../../src/index test_service.proto"},dependencies:{"@grpc/proto-loader":"^0.7.13","@js-sdsl/ordered-map":"^4.4.2"},files:["src/**/*.ts","build/src/**/*.{js,d.ts,js.map}","proto/*.proto","LICENSE","deps/envoy-api/envoy/api/v2/**/*.proto","deps/envoy-api/envoy/config/**/*.proto","deps/envoy-api/envoy/service/**/*.proto","deps/envoy-api/envoy/type/**/*.proto","deps/udpa/udpa/**/*.proto","deps/googleapis/google/api/*.proto","deps/googleapis/google/rpc/*.proto","deps/protoc-gen-validate/validate/**/*.proto"]}});var _e=S(pt=>{"use strict";var Gl,Zl,Yl,Jl;Object.defineProperty(pt,"__esModule",{value:!0});pt.log=pt.setLoggerVerbosity=pt.setLogger=pt.getLogger=void 0;pt.trace=kS;pt.isTracerEnabled=zf;var Nr=ne(),yS=require("process"),vS=Vl().version,_S={error:(t,...e)=>{console.error("E "+t,...e)},info:(t,...e)=>{console.error("I "+t,...e)},debug:(t,...e)=>{console.error("D "+t,...e)}},yi=_S,Xi=Nr.LogVerbosity.ERROR,SS=(Zl=(Gl=process.env.GRPC_NODE_VERBOSITY)!==null&&Gl!==void 0?Gl:process.env.GRPC_VERBOSITY)!==null&&Zl!==void 0?Zl:"";switch(SS.toUpperCase()){case"DEBUG":Xi=Nr.LogVerbosity.DEBUG;break;case"INFO":Xi=Nr.LogVerbosity.INFO;break;case"ERROR":Xi=Nr.LogVerbosity.ERROR;break;case"NONE":Xi=Nr.LogVerbosity.NONE;break;default:}var CS=()=>yi;pt.getLogger=CS;var bS=t=>{yi=t};pt.setLogger=bS;var ES=t=>{Xi=t};pt.setLoggerVerbosity=ES;var TS=(t,...e)=>{let r;if(t>=Xi){switch(t){case Nr.LogVerbosity.DEBUG:r=yi.debug;break;case Nr.LogVerbosity.INFO:r=yi.info;break;case Nr.LogVerbosity.ERROR:r=yi.error;break}r||(r=yi.error),r&&r.bind(yi)(...e)}};pt.log=TS;var wS=(Jl=(Yl=process.env.GRPC_NODE_TRACE)!==null&&Yl!==void 0?Yl:process.env.GRPC_TRACE)!==null&&Jl!==void 0?Jl:"",Kl=new Set,Uf=new Set;for(let t of wS.split(","))t.startsWith("-")?Uf.add(t.substring(1)):Kl.add(t);var RS=Kl.has("all");function kS(t,e,r){zf(e)&&(0,pt.log)(t,new Date().toISOString()+" | v"+vS+" "+yS.pid+" | "+e+" | "+r)}function zf(t){return!Uf.has(t)&&(RS||Kl.has(t))}});var mo=S(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.getErrorMessage=xS;go.getErrorCode=OS;function xS(t){return t instanceof Error?t.message:String(t)}function OS(t){return typeof t=="object"&&t!==null&&"code"in t&&typeof t.code=="number"?t.code:null}});var Ke=S(vo=>{"use strict";Object.defineProperty(vo,"__esModule",{value:!0});vo.Metadata=void 0;var AS=_e(),PS=ne(),MS=mo(),IS=/^[0-9a-z_.-]+$/,NS=/^[ -~]*$/;function DS(t){return IS.test(t)}function LS(t){return NS.test(t)}function Wf(t){return t.endsWith("-bin")}function FS(t){return!t.startsWith("grpc-")}function yo(t){return t.toLowerCase()}function Hf(t,e){if(!DS(t))throw new Error('Metadata key "'+t+'" contains illegal characters');if(e!=null)if(Wf(t)){if(!Buffer.isBuffer(e))throw new Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(e))throw new Error("keys that don't end with '-bin' must have String values");if(!LS(e))throw new Error('Metadata string value "'+e+'" contains illegal characters')}}var Xl=class t{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,r){e=yo(e),Hf(e,r),this.internalRepr.set(e,[r])}add(e,r){e=yo(e),Hf(e,r);let i=this.internalRepr.get(e);i===void 0?this.internalRepr.set(e,[r]):i.push(r)}remove(e){e=yo(e),this.internalRepr.delete(e)}get(e){return e=yo(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[r,i]of this.internalRepr)if(i.length>0){let n=i[0];e[r]=Buffer.isBuffer(n)?Buffer.from(n):n}return e}clone(){let e=new t(this.options),r=e.internalRepr;for(let[i,n]of this.internalRepr){let s=n.map(o=>Buffer.isBuffer(o)?Buffer.from(o):o);r.set(i,s)}return e}merge(e){for(let[r,i]of e.internalRepr){let n=(this.internalRepr.get(r)||[]).concat(i);this.internalRepr.set(r,n)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[r,i]of this.internalRepr)e[r]=i.map(qS);return e}toJSON(){let e={};for(let[r,i]of this.internalRepr)e[r]=i;return e}static fromHttp2Headers(e){let r=new t;for(let i of Object.keys(e)){if(i.charAt(0)===":")continue;let n=e[i];try{Wf(i)?Array.isArray(n)?n.forEach(s=>{r.add(i,Buffer.from(s,"base64"))}):n!==void 0&&(FS(i)?n.split(",").forEach(s=>{r.add(i,Buffer.from(s.trim(),"base64"))}):r.add(i,Buffer.from(n,"base64"))):Array.isArray(n)?n.forEach(s=>{r.add(i,s)}):n!==void 0&&r.add(i,n)}catch(s){let o=`Failed to add metadata entry ${i}: ${n}. ${(0,MS.getErrorMessage)(s)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,AS.log)(PS.LogVerbosity.ERROR,o)}}return r}};vo.Metadata=Xl;var qS=t=>Buffer.isBuffer(t)?t.toString("base64"):t});var So=S(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.CallCredentials=void 0;var rc=Ke();function BS(t){return"getRequestHeaders"in t&&typeof t.getRequestHeaders=="function"}var Qi=class t{static createFromMetadataGenerator(e){return new ec(e)}static createFromGoogleCredential(e){return t.createFromMetadataGenerator((r,i)=>{let n;BS(e)?n=e.getRequestHeaders(r.service_url):n=new Promise((s,o)=>{e.getRequestMetadata(r.service_url,(a,l)=>{if(a){o(a);return}if(!l){o(new Error("Headers not set by metadata plugin"));return}s(l)})}),n.then(s=>{let o=new rc.Metadata;for(let a of Object.keys(s))o.add(a,s[a]);i(null,o)},s=>{i(s)})})}static createEmpty(){return new tc}};_o.CallCredentials=Qi;var Ql=class t extends Qi{constructor(e){super(),this.creds=e}async generateMetadata(e){let r=new rc.Metadata,i=await Promise.all(this.creds.map(n=>n.generateMetadata(e)));for(let n of i)r.merge(n);return r}compose(e){return new t(this.creds.concat([e]))}_equals(e){return this===e?!0:e instanceof t?this.creds.every((r,i)=>r._equals(e.creds[i])):!1}},ec=class t extends Qi{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((r,i)=>{this.metadataGenerator(e,(n,s)=>{s!==void 0?r(s):i(n)})})}compose(e){return new Ql([this,e])}_equals(e){return this===e?!0:e instanceof t?this.metadataGenerator===e.metadataGenerator:!1}},tc=class t extends Qi{generateMetadata(e){return Promise.resolve(new rc.Metadata)}compose(e){return e}_equals(e){return e instanceof t}}});var nc=S(Wn=>{"use strict";Object.defineProperty(Wn,"__esModule",{value:!0});Wn.CIPHER_SUITES=void 0;Wn.getDefaultRootsData=US;var jS=require("fs");Wn.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;var $f=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,ic=null;function US(){return $f?(ic===null&&(ic=jS.readFileSync($f)),ic):null}});var st=S(en=>{"use strict";Object.defineProperty(en,"__esModule",{value:!0});en.parseUri=HS;en.splitHostPort=WS;en.combineHostPort=$S;en.uriToString=VS;var zS=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;function HS(t){let e=zS.exec(t);return e===null?null:{scheme:e[1],authority:e[2],path:e[3]}}var Vf=/^\d+$/;function WS(t){if(t.startsWith("[")){let e=t.indexOf("]");if(e===-1)return null;let r=t.substring(1,e);if(r.indexOf(":")===-1)return null;if(t.length>e+1)if(t[e+1]===":"){let i=t.substring(e+2);return Vf.test(i)?{host:r,port:+i}:null}else return null;else return{host:r}}else{let e=t.split(":");return e.length===2?Vf.test(e[1])?{host:e[0],port:+e[1]}:null:{host:t}}}function $S(t){return t.port===void 0?t.host:t.host.includes(":")?`[${t.host}]:${t.port}`:`${t.host}:${t.port}`}function VS(t){let e="";return t.scheme!==void 0&&(e+=t.scheme+":"),t.authority!==void 0&&(e+="//"+t.authority+"/"),e+=t.path,e}});var Kt=S(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.registerResolver=GS;vi.registerDefaultScheme=ZS;vi.createResolver=YS;vi.getDefaultAuthority=JS;vi.mapUriDefaultScheme=KS;var oc=st(),tn={},sc=null;function GS(t,e){tn[t]=e}function ZS(t){sc=t}function YS(t,e,r){if(t.scheme!==void 0&&t.scheme in tn)return new tn[t.scheme](t,e,r);throw new Error(`No resolver could be created for target ${(0,oc.uriToString)(t)}`)}function JS(t){if(t.scheme!==void 0&&t.scheme in tn)return tn[t.scheme].getDefaultAuthority(t);throw new Error(`Invalid target ${(0,oc.uriToString)(t)}`)}function KS(t){return t.scheme===void 0||!(t.scheme in tn)?sc!==null?{scheme:sc,authority:void 0,path:(0,oc.uriToString)(t)}:null:t}});var Gn=S(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.ChannelCredentials=void 0;Vn.createCertificateProviderChannelCredentials=eC;var $n=require("tls"),To=So(),lc=nc(),Co=st(),Gf=Kt(),XS=_e(),QS=ne();function ac(t,e){if(t&&!(t instanceof Buffer))throw new TypeError(`${e}, if provided, must be a Buffer.`)}var _i=class{compose(e){return new dc(this,e)}static createSsl(e,r,i,n){var s;if(ac(e,"Root certificate"),ac(r,"Private key"),ac(i,"Certificate chain"),r&&!i)throw new Error("Private key must be given with accompanying certificate chain");if(!r&&i)throw new Error("Certificate chain must be given with accompanying private key");let o=(0,$n.createSecureContext)({ca:(s=e??(0,lc.getDefaultRootsData)())!==null&&s!==void 0?s:void 0,key:r??void 0,cert:i??void 0,ciphers:lc.CIPHER_SUITES});return new bo(o,n??{})}static createFromSecureContext(e,r){return new bo(e,r??{})}static createInsecure(){return new cc}};Vn.ChannelCredentials=_i;var cc=class t extends _i{constructor(){super()}compose(e){throw new Error("Cannot compose insecure credentials")}_isSecure(){return!1}_equals(e){return e instanceof t}_createSecureConnector(e,r,i){return{connect(n){return Promise.resolve({socket:n,secure:!1})},waitForReady:()=>Promise.resolve(),getCallCredentials:()=>i??To.CallCredentials.createEmpty(),destroy(){}}}};function Zf(t,e,r,i){var n,s,o,a;let l={secureContext:t};if(e.checkServerIdentity&&(l.checkServerIdentity=e.checkServerIdentity),e.rejectUnauthorized!==void 0&&(l.rejectUnauthorized=e.rejectUnauthorized),l.ALPNProtocols=["h2"],i["grpc.ssl_target_name_override"]){let _=i["grpc.ssl_target_name_override"],T=(n=l.checkServerIdentity)!==null&&n!==void 0?n:$n.checkServerIdentity;l.checkServerIdentity=(C,k)=>T(_,k),l.servername=_}else if("grpc.http_connect_target"in i){let _=(0,Gf.getDefaultAuthority)((s=(0,Co.parseUri)(i["grpc.http_connect_target"]))!==null&&s!==void 0?s:{path:"localhost"}),T=(0,Co.splitHostPort)(_);l.servername=(o=T?.host)!==null&&o!==void 0?o:_}i["grpc-node.tls_enable_trace"]&&(l.enableTrace=!0);let c=r;if("grpc.http_connect_target"in i){let _=(0,Co.parseUri)(i["grpc.http_connect_target"]);_&&(c=_)}let u=(0,Gf.getDefaultAuthority)(c),f=(0,Co.splitHostPort)(u),m=(a=f?.host)!==null&&a!==void 0?a:u;return l.host=m,l.servername=m,l}var uc=class{constructor(e,r){this.connectionOptions=e,this.callCredentials=r}connect(e){let r=Object.assign({socket:e},this.connectionOptions);return new Promise((i,n)=>{let s=(0,$n.connect)(r,()=>{var o;if((!((o=this.connectionOptions.rejectUnauthorized)!==null&&o!==void 0)||o)&&!s.authorized){n(s.authorizationError);return}i({socket:s,secure:!0})});s.on("error",o=>{n(o)})})}waitForReady(){return Promise.resolve()}getCallCredentials(){return this.callCredentials}destroy(){}},bo=class t extends _i{constructor(e,r){super(),this.secureContext=e,this.verifyOptions=r}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof t?this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity:!1}_createSecureConnector(e,r,i){let n=Zf(this.secureContext,this.verifyOptions,e,r);return new uc(n,i??To.CallCredentials.createEmpty())}},Eo=class t extends _i{constructor(e,r,i){super(),this.caCertificateProvider=e,this.identityCertificateProvider=r,this.verifyOptions=i,this.refcount=0,this.latestCaUpdate=void 0,this.latestIdentityUpdate=void 0,this.caCertificateUpdateListener=this.handleCaCertificateUpdate.bind(this),this.identityCertificateUpdateListener=this.handleIdentityCertitificateUpdate.bind(this),this.secureContextWatchers=[]}_isSecure(){return!0}_equals(e){var r,i;return this===e?!0:e instanceof t?this.caCertificateProvider===e.caCertificateProvider&&this.identityCertificateProvider===e.identityCertificateProvider&&((r=this.verifyOptions)===null||r===void 0?void 0:r.checkServerIdentity)===((i=e.verifyOptions)===null||i===void 0?void 0:i.checkServerIdentity):!1}ref(){var e;this.refcount===0&&(this.caCertificateProvider.addCaCertificateListener(this.caCertificateUpdateListener),(e=this.identityCertificateProvider)===null||e===void 0||e.addIdentityCertificateListener(this.identityCertificateUpdateListener)),this.refcount+=1}unref(){var e;this.refcount-=1,this.refcount===0&&(this.caCertificateProvider.removeCaCertificateListener(this.caCertificateUpdateListener),(e=this.identityCertificateProvider)===null||e===void 0||e.removeIdentityCertificateListener(this.identityCertificateUpdateListener))}_createSecureConnector(e,r,i){return this.ref(),new t.SecureConnectorImpl(this,e,r,i??To.CallCredentials.createEmpty())}maybeUpdateWatchers(){if(this.hasReceivedUpdates()){for(let e of this.secureContextWatchers)e(this.getLatestSecureContext());this.secureContextWatchers=[]}}handleCaCertificateUpdate(e){this.latestCaUpdate=e,this.maybeUpdateWatchers()}handleIdentityCertitificateUpdate(e){this.latestIdentityUpdate=e,this.maybeUpdateWatchers()}hasReceivedUpdates(){return!(this.latestCaUpdate===void 0||this.identityCertificateProvider&&this.latestIdentityUpdate===void 0)}getSecureContext(){return this.hasReceivedUpdates()?Promise.resolve(this.getLatestSecureContext()):new Promise(e=>{this.secureContextWatchers.push(e)})}getLatestSecureContext(){var e,r;if(!this.latestCaUpdate||this.identityCertificateProvider!==null&&!this.latestIdentityUpdate)return null;try{return(0,$n.createSecureContext)({ca:this.latestCaUpdate.caCertificate,key:(e=this.latestIdentityUpdate)===null||e===void 0?void 0:e.privateKey,cert:(r=this.latestIdentityUpdate)===null||r===void 0?void 0:r.certificate,ciphers:lc.CIPHER_SUITES})}catch(i){return(0,XS.log)(QS.LogVerbosity.ERROR,"Failed to createSecureContext with error "+i.message),null}}};Eo.SecureConnectorImpl=class{constructor(t,e,r,i){this.parent=t,this.channelTarget=e,this.options=r,this.callCredentials=i}connect(t){return new Promise((e,r)=>{let i=this.parent.getLatestSecureContext();if(!i){r(new Error("Failed to load credentials"));return}t.closed&&r(new Error("Socket closed while loading credentials"));let n=Zf(i,this.parent.verifyOptions,this.channelTarget,this.options),s=Object.assign({socket:t},n),o=()=>{r(new Error("Socket closed"))},a=c=>{r(c)},l=(0,$n.connect)(s,()=>{var c;if(l.removeListener("close",o),l.removeListener("error",a),(!((c=this.parent.verifyOptions.rejectUnauthorized)!==null&&c!==void 0)||c)&&!l.authorized){r(l.authorizationError);return}e({socket:l,secure:!0})});l.once("close",o),l.once("error",a)})}async waitForReady(){await this.parent.getSecureContext()}getCallCredentials(){return this.callCredentials}destroy(){this.parent.unref()}};function eC(t,e,r){return new Eo(t,e,r??{})}var dc=class t extends _i{constructor(e,r){if(super(),this.channelCredentials=e,this.callCredentials=r,!e._isSecure())throw new Error("Cannot compose insecure credentials")}compose(e){let r=this.callCredentials.compose(e);return new t(this.channelCredentials,r)}_isSecure(){return!0}_equals(e){return this===e?!0:e instanceof t?this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials):!1}_createSecureConnector(e,r,i){let n=this.callCredentials.compose(i??To.CallCredentials.createEmpty());return this.channelCredentials._createSecureConnector(e,r,n)}}});var Si=S(Xt=>{"use strict";Object.defineProperty(Xt,"__esModule",{value:!0});Xt.createChildChannelControlHelper=iC;Xt.registerLoadBalancerType=nC;Xt.registerDefaultLoadBalancerType=sC;Xt.createLoadBalancer=oC;Xt.isLoadBalancerNameRegistered=aC;Xt.parseLoadBalancingConfig=Yf;Xt.getDefaultConfig=lC;Xt.selectLbConfigFromList=cC;var tC=_e(),rC=ne();function iC(t,e){var r,i,n,s,o,a,l,c,u,f;return{createSubchannel:(i=(r=e.createSubchannel)===null||r===void 0?void 0:r.bind(e))!==null&&i!==void 0?i:t.createSubchannel.bind(t),updateState:(s=(n=e.updateState)===null||n===void 0?void 0:n.bind(e))!==null&&s!==void 0?s:t.updateState.bind(t),requestReresolution:(a=(o=e.requestReresolution)===null||o===void 0?void 0:o.bind(e))!==null&&a!==void 0?a:t.requestReresolution.bind(t),addChannelzChild:(c=(l=e.addChannelzChild)===null||l===void 0?void 0:l.bind(e))!==null&&c!==void 0?c:t.addChannelzChild.bind(t),removeChannelzChild:(f=(u=e.removeChannelzChild)===null||u===void 0?void 0:u.bind(e))!==null&&f!==void 0?f:t.removeChannelzChild.bind(t)}}var Dr={},Zn=null;function nC(t,e,r){Dr[t]={LoadBalancer:e,LoadBalancingConfig:r}}function sC(t){Zn=t}function oC(t,e){let r=t.getLoadBalancerName();return r in Dr?new Dr[r].LoadBalancer(e):null}function aC(t){return t in Dr}function Yf(t){let e=Object.keys(t);if(e.length!==1)throw new Error("Provided load balancing config has multiple conflicting entries");let r=e[0];if(r in Dr)try{return Dr[r].LoadBalancingConfig.createFromJson(t[r])}catch(i){throw new Error(`${r}: ${i.message}`)}else throw new Error(`Unrecognized load balancing config name ${r}`)}function lC(){if(!Zn)throw new Error("No default load balancer type registered");return new Dr[Zn].LoadBalancingConfig}function cC(t,e=!1){for(let r of t)try{return Yf(r)}catch(i){(0,tC.log)(rC.LogVerbosity.DEBUG,"Config parsing failed with error",i.message);continue}return e&&Zn?new Dr[Zn].LoadBalancingConfig:null}});var hc=S(Yn=>{"use strict";Object.defineProperty(Yn,"__esModule",{value:!0});Yn.validateRetryThrottling=Jf;Yn.validateServiceConfig=Kf;Yn.extractAndSelectServiceConfig=_C;var uC=require("os"),wo=ne(),Ro=/^\d+(\.\d{1,9})?s$/,dC="node";function hC(t){if("service"in t&&t.service!==""){if(typeof t.service!="string")throw new Error(`Invalid method config name: invalid service: expected type string, got ${typeof t.service}`);if("method"in t&&t.method!==""){if(typeof t.method!="string")throw new Error(`Invalid method config name: invalid method: expected type string, got ${typeof t.service}`);return{service:t.service,method:t.method}}else return{service:t.service}}else{if("method"in t&&t.method!==void 0)throw new Error("Invalid method config name: method set with empty or unset service");return{}}}function fC(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in t)||typeof t.initialBackoff!="string"||!Ro.test(t.initialBackoff))throw new Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer or decimal followed by s");if(!("maxBackoff"in t)||typeof t.maxBackoff!="string"||!Ro.test(t.maxBackoff))throw new Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer or decimal followed by s");if(!("backoffMultiplier"in t)||typeof t.backoffMultiplier!="number"||t.backoffMultiplier<=0)throw new Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in t&&Array.isArray(t.retryableStatusCodes)))throw new Error("Invalid method config retry policy: retryableStatusCodes is required");if(t.retryableStatusCodes.length===0)throw new Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let e of t.retryableStatusCodes)if(typeof e=="number"){if(!Object.values(wo.Status).includes(e))throw new Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if(typeof e=="string"){if(!Object.values(wo.Status).includes(e.toUpperCase()))throw new Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw new Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:t.maxAttempts,initialBackoff:t.initialBackoff,maxBackoff:t.maxBackoff,backoffMultiplier:t.backoffMultiplier,retryableStatusCodes:t.retryableStatusCodes}}function pC(t){if(!("maxAttempts"in t)||!Number.isInteger(t.maxAttempts)||t.maxAttempts<2)throw new Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in t&&(typeof t.hedgingDelay!="string"||!Ro.test(t.hedgingDelay)))throw new Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in t&&Array.isArray(t.nonFatalStatusCodes))for(let r of t.nonFatalStatusCodes)if(typeof r=="number"){if(!Object.values(wo.Status).includes(r))throw new Error("Invalid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if(typeof r=="string"){if(!Object.values(wo.Status).includes(r.toUpperCase()))throw new Error("Invalid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw new Error("Invalid method config hedging policy: nonFatalStatusCodes value must be a string or number");let e={maxAttempts:t.maxAttempts};return t.hedgingDelay&&(e.hedgingDelay=t.hedgingDelay),t.nonFatalStatusCodes&&(e.nonFatalStatusCodes=t.nonFatalStatusCodes),e}function gC(t){var e;let r={name:[]};if(!("name"in t)||!Array.isArray(t.name))throw new Error("Invalid method config: invalid name array");for(let i of t.name)r.name.push(hC(i));if("waitForReady"in t){if(typeof t.waitForReady!="boolean")throw new Error("Invalid method config: invalid waitForReady");r.waitForReady=t.waitForReady}if("timeout"in t)if(typeof t.timeout=="object"){if(!("seconds"in t.timeout)||typeof t.timeout.seconds!="number")throw new Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in t.timeout)||typeof t.timeout.nanos!="number")throw new Error("Invalid method config: invalid timeout.nanos");r.timeout=t.timeout}else if(typeof t.timeout=="string"&&Ro.test(t.timeout)){let i=t.timeout.substring(0,t.timeout.length-1).split(".");r.timeout={seconds:i[0]|0,nanos:((e=i[1])!==null&&e!==void 0?e:0)|0}}else throw new Error("Invalid method config: invalid timeout");if("maxRequestBytes"in t){if(typeof t.maxRequestBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");r.maxRequestBytes=t.maxRequestBytes}if("maxResponseBytes"in t){if(typeof t.maxResponseBytes!="number")throw new Error("Invalid method config: invalid maxRequestBytes");r.maxResponseBytes=t.maxResponseBytes}if("retryPolicy"in t){if("hedgingPolicy"in t)throw new Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");r.retryPolicy=fC(t.retryPolicy)}else"hedgingPolicy"in t&&(r.hedgingPolicy=pC(t.hedgingPolicy));return r}function Jf(t){if(!("maxTokens"in t)||typeof t.maxTokens!="number"||t.maxTokens<=0||t.maxTokens>1e3)throw new Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in t)||typeof t.tokenRatio!="number"||t.tokenRatio<=0)throw new Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+t.maxTokens.toFixed(3),tokenRatio:+t.tokenRatio.toFixed(3)}}function mC(t){if(!(typeof t=="object"&&t!==null))throw new Error(`Invalid loadBalancingConfig: unexpected type ${typeof t}`);let e=Object.keys(t);if(e.length>1)throw new Error(`Invalid loadBalancingConfig: unexpected multiple keys ${e}`);if(e.length===0)throw new Error("Invalid loadBalancingConfig: load balancing policy name required");return{[e[0]]:t[e[0]]}}function Kf(t){let e={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in t)if(typeof t.loadBalancingPolicy=="string")e.loadBalancingPolicy=t.loadBalancingPolicy;else throw new Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in t)if(Array.isArray(t.loadBalancingConfig))for(let i of t.loadBalancingConfig)e.loadBalancingConfig.push(mC(i));else throw new Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in t&&Array.isArray(t.methodConfig))for(let i of t.methodConfig)e.methodConfig.push(gC(i));"retryThrottling"in t&&(e.retryThrottling=Jf(t.retryThrottling));let r=[];for(let i of e.methodConfig)for(let n of i.name){for(let s of r)if(n.service===s.service&&n.method===s.method)throw new Error(`Invalid service config: duplicate name ${n.service}/${n.method}`);r.push(n)}return e}function yC(t){if(!("serviceConfig"in t))throw new Error("Invalid service config choice: missing service config");let e={serviceConfig:Kf(t.serviceConfig)};if("clientLanguage"in t)if(Array.isArray(t.clientLanguage)){e.clientLanguage=[];for(let i of t.clientLanguage)if(typeof i=="string")e.clientLanguage.push(i);else throw new Error("Invalid service config choice: invalid clientLanguage")}else throw new Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in t)if(Array.isArray(t.clientHostname)){e.clientHostname=[];for(let i of t.clientHostname)if(typeof i=="string")e.clientHostname.push(i);else throw new Error("Invalid service config choice: invalid clientHostname")}else throw new Error("Invalid service config choice: invalid clientHostname");if("percentage"in t)if(typeof t.percentage=="number"&&0<=t.percentage&&t.percentage<=100)e.percentage=t.percentage;else throw new Error("Invalid service config choice: invalid percentage");let r=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let i in t)if(!r.includes(i))throw new Error(`Invalid service config choice: unexpected field ${i}`);return e}function vC(t,e){if(!Array.isArray(t))throw new Error("Invalid service config list");for(let r of t){let i=yC(r);if(!(typeof i.percentage=="number"&&e>i.percentage)){if(Array.isArray(i.clientHostname)){let n=!1;for(let s of i.clientHostname)s===uC.hostname()&&(n=!0);if(!n)continue}if(Array.isArray(i.clientLanguage)){let n=!1;for(let s of i.clientLanguage)s===dC&&(n=!0);if(!n)continue}return i.serviceConfig}}throw new Error("No matching service config found")}function _C(t,e){for(let r of t)if(r.length>0&&r[0].startsWith("grpc_config=")){let i=r.join("").substring(12),n=JSON.parse(i);return vC(n,e)}return null}});var bt=S(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.ConnectivityState=void 0;var Xf;(function(t){t[t.IDLE=0]="IDLE",t[t.CONNECTING=1]="CONNECTING",t[t.READY=2]="READY",t[t.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",t[t.SHUTDOWN=4]="SHUTDOWN"})(Xf||(ko.ConnectivityState=Xf={}))});var Fr=S(Lr=>{"use strict";Object.defineProperty(Lr,"__esModule",{value:!0});Lr.QueuePicker=Lr.UnavailablePicker=Lr.PickResultType=void 0;var SC=Ke(),CC=ne(),xo;(function(t){t[t.COMPLETE=0]="COMPLETE",t[t.QUEUE=1]="QUEUE",t[t.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",t[t.DROP=3]="DROP"})(xo||(Lr.PickResultType=xo={}));var fc=class{constructor(e){this.status=Object.assign({code:CC.Status.UNAVAILABLE,details:"No connection established",metadata:new SC.Metadata},e)}pick(e){return{pickResultType:xo.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}};Lr.UnavailablePicker=fc;var pc=class{constructor(e,r){this.loadBalancer=e,this.childPicker=r,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),this.childPicker?this.childPicker.pick(e):{pickResultType:xo.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}};Lr.QueuePicker=pc});var Jn=S(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.BackoffTimeout=void 0;var bC=ne(),EC=_e(),TC="backoff",wC=1e3,RC=1.6,kC=12e4,xC=.2;function OC(t,e){return Math.random()*(e-t)+t}var Oo=class t{constructor(e,r){this.callback=e,this.initialDelay=wC,this.multiplier=RC,this.maxDelay=kC,this.jitter=xC,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,this.id=t.getNextId(),r&&(r.initialDelay&&(this.initialDelay=r.initialDelay),r.multiplier&&(this.multiplier=r.multiplier),r.jitter&&(this.jitter=r.jitter),r.maxDelay&&(this.maxDelay=r.maxDelay)),this.trace("constructed initialDelay="+this.initialDelay+" multiplier="+this.multiplier+" jitter="+this.jitter+" maxDelay="+this.maxDelay),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}static getNextId(){return this.nextId++}trace(e){EC.trace(bC.LogVerbosity.DEBUG,TC,"{"+this.id+"} "+e)}runTimer(e){var r,i;this.trace("runTimer(delay="+e+")"),this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+e),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.trace("timer fired"),this.running=!1,this.callback()},e),this.hasRef||(i=(r=this.timerId).unref)===null||i===void 0||i.call(r)}runOnce(){this.trace("runOnce()"),this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),r=e*this.jitter;this.nextDelay=e+OC(-r,r)}stop(){this.trace("stop()"),clearTimeout(this.timerId),this.running=!1}reset(){if(this.trace("reset() running="+this.running),this.nextDelay=this.initialDelay,this.running){let e=new Date,r=this.startTime;r.setMilliseconds(r.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<r?this.runTimer(r.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,r;this.hasRef=!0,(r=(e=this.timerId).ref)===null||r===void 0||r.call(e)}unref(){var e,r;this.hasRef=!1,(r=(e=this.timerId).unref)===null||r===void 0||r.call(e)}getEndTime(){return this.endTime}};Ao.BackoffTimeout=Oo;Oo.nextId=0});var Mo=S(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.ChildLoadBalancerHandler=void 0;var AC=Si(),PC=bt(),MC="child_load_balancer_helper",gc=class{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(r){this.parent=r,this.child=null}createSubchannel(r,i){return this.parent.channelControlHelper.createSubchannel(r,i)}updateState(r,i,n){var s;if(this.calledByPendingChild()){if(r===PC.ConnectivityState.CONNECTING)return;(s=this.parent.currentChild)===null||s===void 0||s.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(r,i,n)}requestReresolution(){var r;let i=(r=this.parent.pendingChild)!==null&&r!==void 0?r:this.parent.currentChild;this.child===i&&this.parent.channelControlHelper.requestReresolution()}setChild(r){this.child=r}addChannelzChild(r){this.parent.channelControlHelper.addChannelzChild(r)}removeChannelzChild(r){this.parent.channelControlHelper.removeChannelzChild(r)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,r){return e.getLoadBalancerName()!==r.getLoadBalancerName()}updateAddressList(e,r,i){let n;if(this.currentChild===null||this.latestConfig===null||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,r)){let s=new this.ChildPolicyHelper(this),o=(0,AC.createLoadBalancer)(r,s);s.setChild(o),this.currentChild===null?(this.currentChild=o,n=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=o,n=this.pendingChild)}else this.pendingChild===null?n=this.currentChild:n=this.pendingChild;this.latestConfig=r,n.updateAddressList(e,r,i)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return MC}};Po.ChildLoadBalancerHandler=gc});var ep=S(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.ResolvingLoadBalancer=void 0;var IC=Si(),NC=hc(),ot=bt(),DC=Kt(),Kn=Fr(),LC=Jn(),mc=ne(),FC=Ke(),qC=_e(),BC=ne(),jC=st(),UC=Mo(),zC="resolving_load_balancer";function Qf(t){qC.trace(BC.LogVerbosity.DEBUG,zC,t)}var HC=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function WC(t,e,r,i){for(let n of r.name)switch(i){case"EMPTY":if(!n.service&&!n.method)return!0;break;case"SERVICE":if(n.service===t&&!n.method)return!0;break;case"SERVICE_AND_METHOD":if(n.service===t&&n.method===e)return!0}return!1}function $C(t,e,r,i){for(let n of r)if(WC(t,e,n,i))return n;return null}function VC(t){return{invoke(e,r){var i,n;let s=e.split("/").filter(l=>l.length>0),o=(i=s[0])!==null&&i!==void 0?i:"",a=(n=s[1])!==null&&n!==void 0?n:"";if(t&&t.methodConfig)for(let l of HC){let c=$C(o,a,t.methodConfig,l);if(c)return{methodConfig:c,pickInformation:{},status:mc.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:mc.Status.OK,dynamicFilterFactories:[]}},unref(){}}}var yc=class{constructor(e,r,i,n,s){this.target=e,this.channelControlHelper=r,this.channelOptions=i,this.onSuccessfulResolution=n,this.onFailedResolution=s,this.latestChildState=ot.ConnectivityState.IDLE,this.latestChildPicker=new Kn.QueuePicker(this),this.latestChildErrorMessage=null,this.currentState=ot.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,i["grpc.service_config"]?this.defaultServiceConfig=(0,NC.validateServiceConfig)(JSON.parse(i["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(ot.ConnectivityState.IDLE,new Kn.QueuePicker(this),null),this.childLoadBalancer=new UC.ChildLoadBalancerHandler({createSubchannel:r.createSubchannel.bind(r),requestReresolution:()=>{this.backoffTimeout.isRunning()?(Qf("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(a,l,c)=>{this.latestChildState=a,this.latestChildPicker=l,this.latestChildErrorMessage=c,this.updateState(a,l,c)},addChannelzChild:r.addChannelzChild.bind(r),removeChannelzChild:r.removeChannelzChild.bind(r)}),this.innerResolver=(0,DC.createResolver)(e,{onSuccessfulResolution:(a,l,c,u,f)=>{var m;this.backoffTimeout.stop(),this.backoffTimeout.reset();let _=null;l===null?c===null?(this.previousServiceConfig=null,_=this.defaultServiceConfig):this.previousServiceConfig===null?this.handleResolutionFailure(c):_=this.previousServiceConfig:(_=l,this.previousServiceConfig=l);let T=(m=_?.loadBalancingConfig)!==null&&m!==void 0?m:[],C=(0,IC.selectLbConfigFromList)(T,!0);if(C===null){this.handleResolutionFailure({code:mc.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new FC.Metadata}),u?.unref();return}this.childLoadBalancer.updateAddressList(a,C,Object.assign(Object.assign({},this.channelOptions),f));let k=_??this.defaultServiceConfig;this.onSuccessfulResolution(k,u??VC(k))},onError:a=>{this.handleResolutionFailure(a)}},i);let o={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new LC.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker,this.latestChildErrorMessage)},o),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===ot.ConnectivityState.IDLE&&this.updateState(ot.ConnectivityState.CONNECTING,this.latestChildPicker,this.latestChildErrorMessage),this.backoffTimeout.runOnce()}updateState(e,r,i){Qf((0,jC.uriToString)(this.target)+" "+ot.ConnectivityState[this.currentState]+" -> "+ot.ConnectivityState[e]),e===ot.ConnectivityState.IDLE&&(r=new Kn.QueuePicker(this,r)),this.currentState=e,this.channelControlHelper.updateState(e,r,i)}handleResolutionFailure(e){this.latestChildState===ot.ConnectivityState.IDLE&&(this.updateState(ot.ConnectivityState.TRANSIENT_FAILURE,new Kn.UnavailablePicker(e),e.details),this.onFailedResolution(e))}exitIdle(){(this.currentState===ot.ConnectivityState.IDLE||this.currentState===ot.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,r){throw new Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=ot.ConnectivityState.IDLE,this.latestChildPicker=new Kn.QueuePicker(this),this.currentState=ot.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}};Io.ResolvingLoadBalancer=yc});var tp=S(Xn=>{"use strict";Object.defineProperty(Xn,"__esModule",{value:!0});Xn.recognizedOptions=void 0;Xn.channelOptionsEqual=GC;Xn.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0,"grpc.lb.ring_hash.ring_size_cap":!0,"grpc-node.retry_max_attempts_limit":!0,"grpc-node.flow_control_window":!0};function GC(t,e){let r=Object.keys(t).sort(),i=Object.keys(e).sort();if(r.length!==i.length)return!1;for(let n=0;n<r.length;n+=1)if(r[n]!==i[n]||t[r[n]]!==e[i[n]])return!1;return!0}});var Et=S(Nt=>{"use strict";Object.defineProperty(Nt,"__esModule",{value:!0});Nt.EndpointMap=void 0;Nt.isTcpSubchannelAddress=es;Nt.subchannelAddressEqual=No;Nt.subchannelAddressToString=ip;Nt.stringToSubchannelAddress=YC;Nt.endpointEqual=JC;Nt.endpointToString=KC;Nt.endpointHasAddress=np;var rp=require("net");function es(t){return"port"in t}function No(t,e){return!t&&!e?!0:!t||!e?!1:es(t)?es(e)&&t.host===e.host&&t.port===e.port:!es(e)&&t.path===e.path}function ip(t){return es(t)?(0,rp.isIPv6)(t.host)?"["+t.host+"]:"+t.port:t.host+":"+t.port:t.path}var ZC=443;function YC(t,e){return(0,rp.isIP)(t)?{host:t,port:e??ZC}:{path:t}}function JC(t,e){if(t.addresses.length!==e.addresses.length)return!1;for(let r=0;r<t.addresses.length;r++)if(!No(t.addresses[r],e.addresses[r]))return!1;return!0}function KC(t){return"["+t.addresses.map(ip).join(", ")+"]"}function np(t,e){for(let r of t.addresses)if(No(r,e))return!0;return!1}function Qn(t,e){if(t.addresses.length!==e.addresses.length)return!1;for(let r of t.addresses){let i=!1;for(let n of e.addresses)if(No(r,n)){i=!0;break}if(!i)return!1}return!0}var vc=class{constructor(){this.map=new Set}get size(){return this.map.size}getForSubchannelAddress(e){for(let r of this.map)if(np(r.key,e))return r.value}deleteMissing(e){let r=[];for(let i of this.map){let n=!1;for(let s of e)Qn(s,i.key)&&(n=!0);n||(r.push(i.value),this.map.delete(i))}return r}get(e){for(let r of this.map)if(Qn(e,r.key))return r.value}set(e,r){for(let i of this.map)if(Qn(e,i.key)){i.value=r;return}this.map.add({key:e,value:r})}delete(e){for(let r of this.map)if(Qn(e,r.key)){this.map.delete(r);return}}has(e){for(let r of this.map)if(Qn(e,r.key))return!0;return!1}clear(){this.map.clear()}*keys(){for(let e of this.map)yield e.key}*values(){for(let e of this.map)yield e.value}*entries(){for(let e of this.map)yield[e.key,e.value]}};Nt.EndpointMap=vc});var sp=S(Rc=>{"use strict";Object.defineProperty(Rc,"t",{value:!0});var Do=class{constructor(e,r,i=1){this.i=void 0,this.h=void 0,this.o=void 0,this.u=e,this.l=r,this.p=i}I(){let e=this,r=e.o.o===e;if(r&&e.p===1)e=e.h;else if(e.i)for(e=e.i;e.h;)e=e.h;else{if(r)return e.o;let i=e.o;for(;i.i===e;)e=i,i=e.o;e=i}return e}B(){let e=this;if(e.h){for(e=e.h;e.i;)e=e.i;return e}else{let r=e.o;for(;r.h===e;)e=r,r=e.o;return e.h!==r?r:e}}_(){let e=this.o,r=this.h,i=r.i;return e.o===this?e.o=r:e.i===this?e.i=r:e.h=r,r.o=e,r.i=this,this.o=r,this.h=i,i&&(i.o=this),r}g(){let e=this.o,r=this.i,i=r.h;return e.o===this?e.o=r:e.i===this?e.i=r:e.h=r,r.o=e,r.h=this,this.o=r,this.i=i,i&&(i.o=this),r}},_c=class extends Do{constructor(){super(...arguments),this.M=1}_(){let e=super._();return this.O(),e.O(),e}g(){let e=super.g();return this.O(),e.O(),e}O(){this.M=1,this.i&&(this.M+=this.i.M),this.h&&(this.M+=this.h.M)}},Sc=class{constructor(e=0){this.iteratorType=e}equals(e){return this.T===e.T}},Cc=class{constructor(){this.m=0}get length(){return this.m}size(){return this.m}empty(){return this.m===0}},bc=class extends Cc{};function Ci(){throw new RangeError("Iterator access denied!")}var Ec=class extends bc{constructor(e=function(i,n){return i<n?-1:i>n?1:0},r=!1){super(),this.v=void 0,this.A=e,this.enableIndex=r,this.N=r?_c:Do,this.C=new this.N}R(e,r){let i=this.C;for(;e;){let n=this.A(e.u,r);if(n<0)e=e.h;else if(n>0)i=e,e=e.i;else return e}return i}K(e,r){let i=this.C;for(;e;)this.A(e.u,r)<=0?e=e.h:(i=e,e=e.i);return i}L(e,r){let i=this.C;for(;e;){let n=this.A(e.u,r);if(n<0)i=e,e=e.h;else if(n>0)e=e.i;else return e}return i}k(e,r){let i=this.C;for(;e;)this.A(e.u,r)<0?(i=e,e=e.h):e=e.i;return i}P(e){for(;;){let r=e.o;if(r===this.C)return;if(e.p===1){e.p=0;return}if(e===r.i){let i=r.h;if(i.p===1)i.p=0,r.p=1,r===this.v?this.v=r._():r._();else if(i.h&&i.h.p===1){i.p=r.p,r.p=0,i.h.p=0,r===this.v?this.v=r._():r._();return}else i.i&&i.i.p===1?(i.p=1,i.i.p=0,i.g()):(i.p=1,e=r)}else{let i=r.i;if(i.p===1)i.p=0,r.p=1,r===this.v?this.v=r.g():r.g();else if(i.i&&i.i.p===1){i.p=r.p,r.p=0,i.i.p=0,r===this.v?this.v=r.g():r.g();return}else i.h&&i.h.p===1?(i.p=1,i.h.p=0,i._()):(i.p=1,e=r)}}}S(e){if(this.m===1){this.clear();return}let r=e;for(;r.i||r.h;){if(r.h)for(r=r.h;r.i;)r=r.i;else r=r.i;let n=e.u;e.u=r.u,r.u=n;let s=e.l;e.l=r.l,r.l=s,e=r}this.C.i===r?this.C.i=r.o:this.C.h===r&&(this.C.h=r.o),this.P(r);let i=r.o;if(r===i.i?i.i=void 0:i.h=void 0,this.m-=1,this.v.p=0,this.enableIndex)for(;i!==this.C;)i.M-=1,i=i.o}U(e){let r=typeof e=="number"?e:void 0,i=typeof e=="function"?e:void 0,n=typeof e>"u"?[]:void 0,s=0,o=this.v,a=[];for(;a.length||o;)if(o)a.push(o),o=o.i;else{if(o=a.pop(),s===r)return o;n&&n.push(o),i&&i(o,s,this),s+=1,o=o.h}return n}j(e){for(;;){let r=e.o;if(r.p===0)return;let i=r.o;if(r===i.i){let n=i.h;if(n&&n.p===1){if(n.p=r.p=0,i===this.v)return;i.p=1,e=i;continue}else if(e===r.h){if(e.p=0,e.i&&(e.i.o=r),e.h&&(e.h.o=i),r.h=e.i,i.i=e.h,e.i=r,e.h=i,i===this.v)this.v=e,this.C.o=e;else{let s=i.o;s.i===i?s.i=e:s.h=e}e.o=i.o,r.o=e,i.o=e,i.p=1}else{r.p=0,i===this.v?this.v=i.g():i.g(),i.p=1;return}}else{let n=i.i;if(n&&n.p===1){if(n.p=r.p=0,i===this.v)return;i.p=1,e=i;continue}else if(e===r.i){if(e.p=0,e.i&&(e.i.o=i),e.h&&(e.h.o=r),i.h=e.i,r.i=e.h,e.i=i,e.h=r,i===this.v)this.v=e,this.C.o=e;else{let s=i.o;s.i===i?s.i=e:s.h=e}e.o=i.o,r.o=e,i.o=e,i.p=1}else{r.p=0,i===this.v?this.v=i._():i._(),i.p=1;return}}this.enableIndex&&(r.O(),i.O(),e.O());return}}q(e,r,i){if(this.v===void 0)return this.m+=1,this.v=new this.N(e,r,0),this.v.o=this.C,this.C.o=this.C.i=this.C.h=this.v,this.m;let n,s=this.C.i,o=this.A(s.u,e);if(o===0)return s.l=r,this.m;if(o>0)s.i=new this.N(e,r),s.i.o=s,n=s.i,this.C.i=n;else{let a=this.C.h,l=this.A(a.u,e);if(l===0)return a.l=r,this.m;if(l<0)a.h=new this.N(e,r),a.h.o=a,n=a.h,this.C.h=n;else{if(i!==void 0){let c=i.T;if(c!==this.C){let u=this.A(c.u,e);if(u===0)return c.l=r,this.m;if(u>0){let f=c.I(),m=this.A(f.u,e);if(m===0)return f.l=r,this.m;m<0&&(n=new this.N(e,r),f.h===void 0?(f.h=n,n.o=f):(c.i=n,n.o=c))}}}if(n===void 0)for(n=this.v;;){let c=this.A(n.u,e);if(c>0){if(n.i===void 0){n.i=new this.N(e,r),n.i.o=n,n=n.i;break}n=n.i}else if(c<0){if(n.h===void 0){n.h=new this.N(e,r),n.h.o=n,n=n.h;break}n=n.h}else return n.l=r,this.m}}}if(this.enableIndex){let a=n.o;for(;a!==this.C;)a.M+=1,a=a.o}return this.j(n),this.m+=1,this.m}H(e,r){for(;e;){let i=this.A(e.u,r);if(i<0)e=e.h;else if(i>0)e=e.i;else return e}return e||this.C}clear(){this.m=0,this.v=void 0,this.C.o=void 0,this.C.i=this.C.h=void 0}updateKeyByIterator(e,r){let i=e.T;if(i===this.C&&Ci(),this.m===1)return i.u=r,!0;let n=i.B().u;if(i===this.C.i)return this.A(n,r)>0?(i.u=r,!0):!1;let s=i.I().u;return i===this.C.h?this.A(s,r)<0?(i.u=r,!0):!1:this.A(s,r)>=0||this.A(n,r)<=0?!1:(i.u=r,!0)}eraseElementByPos(e){if(e<0||e>this.m-1)throw new RangeError;let r=this.U(e);return this.S(r),this.m}eraseElementByKey(e){if(this.m===0)return!1;let r=this.H(this.v,e);return r===this.C?!1:(this.S(r),!0)}eraseElementByIterator(e){let r=e.T;r===this.C&&Ci();let i=r.h===void 0;return e.iteratorType===0?i&&e.next():(!i||r.i===void 0)&&e.next(),this.S(r),e}getHeight(){if(this.m===0)return 0;function e(r){return r?Math.max(e(r.i),e(r.h))+1:0}return e(this.v)}},Tc=class extends Sc{constructor(e,r,i){super(i),this.T=e,this.C=r,this.iteratorType===0?(this.pre=function(){return this.T===this.C.i&&Ci(),this.T=this.T.I(),this},this.next=function(){return this.T===this.C&&Ci(),this.T=this.T.B(),this}):(this.pre=function(){return this.T===this.C.h&&Ci(),this.T=this.T.B(),this},this.next=function(){return this.T===this.C&&Ci(),this.T=this.T.I(),this})}get index(){let e=this.T,r=this.C.o;if(e===this.C)return r?r.M-1:0;let i=0;for(e.i&&(i+=e.i.M);e!==r;){let n=e.o;e===n.h&&(i+=1,n.i&&(i+=n.i.M)),e=n}return i}isAccessible(){return this.T!==this.C}},Dt=class t extends Tc{constructor(e,r,i,n){super(e,r,n),this.container=i}get pointer(){this.T===this.C&&Ci();let e=this;return new Proxy([],{get(r,i){return i==="0"?e.T.u:i==="1"?e.T.l:(r[0]=e.T.u,r[1]=e.T.l,r[i])},set(r,i,n){if(i!=="1")throw new TypeError("prop must be 1");return e.T.l=n,!0}})}copy(){return new t(this.T,this.C,this.container,this.iteratorType)}},wc=class extends Ec{constructor(e=[],r,i){super(r,i);let n=this;e.forEach(function(s){n.setElement(s[0],s[1])})}begin(){return new Dt(this.C.i||this.C,this.C,this)}end(){return new Dt(this.C,this.C,this)}rBegin(){return new Dt(this.C.h||this.C,this.C,this,1)}rEnd(){return new Dt(this.C,this.C,this,1)}front(){if(this.m===0)return;let e=this.C.i;return[e.u,e.l]}back(){if(this.m===0)return;let e=this.C.h;return[e.u,e.l]}lowerBound(e){let r=this.R(this.v,e);return new Dt(r,this.C,this)}upperBound(e){let r=this.K(this.v,e);return new Dt(r,this.C,this)}reverseLowerBound(e){let r=this.L(this.v,e);return new Dt(r,this.C,this)}reverseUpperBound(e){let r=this.k(this.v,e);return new Dt(r,this.C,this)}forEach(e){this.U(function(r,i,n){e([r.u,r.l],i,n)})}setElement(e,r,i){return this.q(e,r,i)}getElementByPos(e){if(e<0||e>this.m-1)throw new RangeError;let r=this.U(e);return[r.u,r.l]}find(e){let r=this.H(this.v,e);return new Dt(r,this.C,this)}getElementByKey(e){return this.H(this.v,e).l}union(e){let r=this;return e.forEach(function(i){r.setElement(i[0],i[1])}),this.m}*[Symbol.iterator](){let e=this.m,r=this.U();for(let i=0;i<e;++i){let n=r[i];yield[n.u,n.l]}}};Rc.OrderedMap=wc});var Fo=S(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.registerAdminService=XC;Lo.addAdminServicesToServer=QC;var op=[];function XC(t,e){op.push({getServiceDefinition:t,getHandlers:e})}function QC(t){for(let{getServiceDefinition:e,getHandlers:r}of op)t.addService(e(),r())}});var ap=S(Lt=>{"use strict";Object.defineProperty(Lt,"__esModule",{value:!0});Lt.ClientDuplexStreamImpl=Lt.ClientWritableStreamImpl=Lt.ClientReadableStreamImpl=Lt.ClientUnaryCallImpl=void 0;Lt.callErrorFromStatus=tb;var eb=require("events"),Pc=require("stream"),ts=ne();function tb(t,e){let r=`${t.code} ${ts.Status[t.code]}: ${t.details}`,n=`${new Error(r).stack}
for call at
${e}`;return Object.assign(new Error(r),t,{stack:n})}var kc=class extends eb.EventEmitter{constructor(){super()}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ts.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}};Lt.ClientUnaryCallImpl=kc;var xc=class extends Pc.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ts.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}_read(e){var r;(r=this.call)===null||r===void 0||r.startRead()}};Lt.ClientReadableStreamImpl=xc;var Oc=class extends Pc.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ts.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}_write(e,r,i){var n;let s={callback:i},o=Number(r);Number.isNaN(o)||(s.flags=o),(n=this.call)===null||n===void 0||n.sendMessageWithContext(s,e)}_final(e){var r;(r=this.call)===null||r===void 0||r.halfClose(),e()}};Lt.ClientWritableStreamImpl=Oc;var Ac=class extends Pc.Duplex{constructor(e,r){super({objectMode:!0}),this.serialize=e,this.deserialize=r}cancel(){var e;(e=this.call)===null||e===void 0||e.cancelWithStatus(ts.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,r;return(r=(e=this.call)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:"unknown"}_read(e){var r;(r=this.call)===null||r===void 0||r.startRead()}_write(e,r,i){var n;let s={callback:i},o=Number(r);Number.isNaN(o)||(s.flags=o),(n=this.call)===null||n===void 0||n.sendMessageWithContext(s,e)}_final(e){var r;(r=this.call)===null||r===void 0||r.halfClose(),e()}};Lt.ClientDuplexStreamImpl=Ac});var lp=S(rs=>{"use strict";Object.defineProperty(rs,"__esModule",{value:!0});rs.InterceptingListenerImpl=void 0;rs.isInterceptingListener=rb;function rb(t){return t.onReceiveMetadata!==void 0&&t.onReceiveMetadata.length===1}var Mc=class{constructor(e,r){this.listener=e,this.nextListener=r,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,r=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(r),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=r,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(r),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,r=>{this.processingMetadata||this.processingMessage?this.pendingStatus=r:this.nextListener.onReceiveStatus(r)})}};rs.InterceptingListenerImpl=Mc});var Bc=S(Ft=>{"use strict";Object.defineProperty(Ft,"__esModule",{value:!0});Ft.InterceptingCall=Ft.RequesterBuilder=Ft.ListenerBuilder=Ft.InterceptorConfigurationError=void 0;Ft.getInterceptingCall=ob;var ib=Ke(),cp=lp(),up=ne(),dp=mo(),ns=class t extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,t)}};Ft.InterceptorConfigurationError=ns;var Nc=class{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}};Ft.ListenerBuilder=Nc;var Dc=class{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}};Ft.RequesterBuilder=Dc;var Ic={onReceiveMetadata:(t,e)=>{e(t)},onReceiveMessage:(t,e)=>{e(t)},onReceiveStatus:(t,e)=>{e(t)}},is={start:(t,e,r)=>{r(t,e)},sendMessage:(t,e)=>{e(t)},halfClose:t=>{t()},cancel:t=>{t()}},Lc=class{constructor(e,r){var i,n,s,o;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,r?this.requester={start:(i=r.start)!==null&&i!==void 0?i:is.start,sendMessage:(n=r.sendMessage)!==null&&n!==void 0?n:is.sendMessage,halfClose:(s=r.halfClose)!==null&&s!==void 0?s:is.halfClose,cancel:(o=r.cancel)!==null&&o!==void 0?o:is.cancel}:this.requester=is}cancelWithStatus(e,r){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,r)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,r){var i,n,s,o,a,l;let c={onReceiveMetadata:(n=(i=r?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(r))!==null&&n!==void 0?n:u=>{},onReceiveMessage:(o=(s=r?.onReceiveMessage)===null||s===void 0?void 0:s.bind(r))!==null&&o!==void 0?o:u=>{},onReceiveStatus:(l=(a=r?.onReceiveStatus)===null||a===void 0?void 0:a.bind(r))!==null&&l!==void 0?l:u=>{}};this.processingMetadata=!0,this.requester.start(e,c,(u,f)=>{var m,_,T;this.processingMetadata=!1;let C;if((0,cp.isInterceptingListener)(f))C=f;else{let k={onReceiveMetadata:(m=f.onReceiveMetadata)!==null&&m!==void 0?m:Ic.onReceiveMetadata,onReceiveMessage:(_=f.onReceiveMessage)!==null&&_!==void 0?_:Ic.onReceiveMessage,onReceiveStatus:(T=f.onReceiveStatus)!==null&&T!==void 0?T:Ic.onReceiveStatus};C=new cp.InterceptingListenerImpl(k,c)}this.nextCall.start(u,C),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,r){this.processingMessage=!0,this.requester.sendMessage(r,i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=r):(this.nextCall.sendMessageWithContext(e,i),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}};Ft.InterceptingCall=Lc;function nb(t,e,r){var i,n;let s=(i=r.deadline)!==null&&i!==void 0?i:1/0,o=r.host,a=(n=r.parent)!==null&&n!==void 0?n:null,l=r.propagate_flags,c=r.credentials,u=t.createCall(e,s,o,a,l);return c&&u.setCredentials(c),u}var qo=class{constructor(e,r){this.call=e,this.methodDefinition=r}cancelWithStatus(e,r){this.call.cancelWithStatus(e,r)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,r){let i;try{i=this.methodDefinition.requestSerialize(r)}catch(n){this.call.cancelWithStatus(up.Status.INTERNAL,`Request message serialization failure: ${(0,dp.getErrorMessage)(n)}`);return}this.call.sendMessageWithContext(e,i)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,r){let i=null;this.call.start(e,{onReceiveMetadata:n=>{var s;(s=r?.onReceiveMetadata)===null||s===void 0||s.call(r,n)},onReceiveMessage:n=>{var s;let o;try{o=this.methodDefinition.responseDeserialize(n)}catch(a){i={code:up.Status.INTERNAL,details:`Response message parsing error: ${(0,dp.getErrorMessage)(a)}`,metadata:new ib.Metadata},this.call.cancelWithStatus(i.code,i.details);return}(s=r?.onReceiveMessage)===null||s===void 0||s.call(r,o)},onReceiveStatus:n=>{var s,o;i?(s=r?.onReceiveStatus)===null||s===void 0||s.call(r,i):(o=r?.onReceiveStatus)===null||o===void 0||o.call(r,n)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}},Fc=class extends qo{constructor(e,r){super(e,r)}start(e,r){var i,n;let s=!1,o={onReceiveMetadata:(n=(i=r?.onReceiveMetadata)===null||i===void 0?void 0:i.bind(r))!==null&&n!==void 0?n:a=>{},onReceiveMessage:a=>{var l;s=!0,(l=r?.onReceiveMessage)===null||l===void 0||l.call(r,a)},onReceiveStatus:a=>{var l,c;s||(l=r?.onReceiveMessage)===null||l===void 0||l.call(r,null),(c=r?.onReceiveStatus)===null||c===void 0||c.call(r,a)}};super.start(e,o),this.call.startRead()}},qc=class extends qo{};function sb(t,e,r){let i=nb(t,r.path,e);return r.responseStream?new qc(i,r):new Fc(i,r)}function ob(t,e,r,i){if(t.clientInterceptors.length>0&&t.clientInterceptorProviders.length>0)throw new ns("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(t.callInterceptors.length>0&&t.callInterceptorProviders.length>0)throw new ns("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let n=[];t.callInterceptors.length>0||t.callInterceptorProviders.length>0?n=[].concat(t.callInterceptors,t.callInterceptorProviders.map(a=>a(e))).filter(a=>a):n=[].concat(t.clientInterceptors,t.clientInterceptorProviders.map(a=>a(e))).filter(a=>a);let s=Object.assign({},r,{method_definition:e});return n.reduceRight((a,l)=>c=>l(c,a),a=>sb(i,a,e))(s)}});var zc=S(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.Client=void 0;var Qt=ap(),ab=Hc(),lb=bt(),qr=ne(),rn=Ke(),Bo=Bc(),qt=Symbol(),nn=Symbol(),sn=Symbol(),_r=Symbol();function jc(t){return typeof t=="function"}function on(t){var e;return((e=t.stack)===null||e===void 0?void 0:e.split(`
`).slice(1).join(`
`))||"no stack trace available"}var Uc=class{constructor(e,r,i={}){var n,s;if(i=Object.assign({},i),this[nn]=(n=i.interceptors)!==null&&n!==void 0?n:[],delete i.interceptors,this[sn]=(s=i.interceptor_providers)!==null&&s!==void 0?s:[],delete i.interceptor_providers,this[nn].length>0&&this[sn].length>0)throw new Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[_r]=i.callInvocationTransformer,delete i.callInvocationTransformer,i.channelOverride)this[qt]=i.channelOverride;else if(i.channelFactoryOverride){let o=i.channelFactoryOverride;delete i.channelFactoryOverride,this[qt]=o(e,r,i)}else this[qt]=new ab.ChannelImplementation(e,r,i)}close(){this[qt].close()}getChannel(){return this[qt]}waitForReady(e,r){let i=n=>{if(n){r(new Error("Failed to connect before the deadline"));return}let s;try{s=this[qt].getConnectivityState(!0)}catch{r(new Error("The channel has been closed"));return}if(s===lb.ConnectivityState.READY)r();else try{this[qt].watchConnectivityState(s,e,i)}catch{r(new Error("The channel has been closed"))}};setImmediate(i)}checkOptionalUnaryResponseArguments(e,r,i){if(jc(e))return{metadata:new rn.Metadata,options:{},callback:e};if(jc(r))return e instanceof rn.Metadata?{metadata:e,options:{},callback:r}:{metadata:new rn.Metadata,options:e,callback:r};if(!(e instanceof rn.Metadata&&r instanceof Object&&jc(i)))throw new Error("Incorrect arguments passed");return{metadata:e,options:r,callback:i}}makeUnaryRequest(e,r,i,n,s,o,a){var l,c;let u=this.checkOptionalUnaryResponseArguments(s,o,a),f={path:e,requestStream:!1,responseStream:!1,requestSerialize:r,responseDeserialize:i},m={argument:n,metadata:u.metadata,call:new Qt.ClientUnaryCallImpl,channel:this[qt],methodDefinition:f,callOptions:u.options,callback:u.callback};this[_r]&&(m=this[_r](m));let _=m.call,T={clientInterceptors:this[nn],clientInterceptorProviders:this[sn],callInterceptors:(l=m.callOptions.interceptors)!==null&&l!==void 0?l:[],callInterceptorProviders:(c=m.callOptions.interceptor_providers)!==null&&c!==void 0?c:[]},C=(0,Bo.getInterceptingCall)(T,m.methodDefinition,m.callOptions,m.channel);_.call=C;let k=null,M=!1,P=new Error;return C.start(m.metadata,{onReceiveMetadata:X=>{_.emit("metadata",X)},onReceiveMessage(X){k!==null&&C.cancelWithStatus(qr.Status.UNIMPLEMENTED,"Too many responses received"),k=X},onReceiveStatus(X){if(!M){if(M=!0,X.code===qr.Status.OK)if(k===null){let j=on(P);m.callback((0,Qt.callErrorFromStatus)({code:qr.Status.UNIMPLEMENTED,details:"No message received",metadata:X.metadata},j))}else m.callback(null,k);else{let j=on(P);m.callback((0,Qt.callErrorFromStatus)(X,j))}P=null,_.emit("status",X)}}}),C.sendMessage(n),C.halfClose(),_}makeClientStreamRequest(e,r,i,n,s,o){var a,l;let c=this.checkOptionalUnaryResponseArguments(n,s,o),u={path:e,requestStream:!0,responseStream:!1,requestSerialize:r,responseDeserialize:i},f={metadata:c.metadata,call:new Qt.ClientWritableStreamImpl(r),channel:this[qt],methodDefinition:u,callOptions:c.options,callback:c.callback};this[_r]&&(f=this[_r](f));let m=f.call,_={clientInterceptors:this[nn],clientInterceptorProviders:this[sn],callInterceptors:(a=f.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=f.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},T=(0,Bo.getInterceptingCall)(_,f.methodDefinition,f.callOptions,f.channel);m.call=T;let C=null,k=!1,M=new Error;return T.start(f.metadata,{onReceiveMetadata:P=>{m.emit("metadata",P)},onReceiveMessage(P){C!==null&&T.cancelWithStatus(qr.Status.UNIMPLEMENTED,"Too many responses received"),C=P,T.startRead()},onReceiveStatus(P){if(!k){if(k=!0,P.code===qr.Status.OK)if(C===null){let X=on(M);f.callback((0,Qt.callErrorFromStatus)({code:qr.Status.UNIMPLEMENTED,details:"No message received",metadata:P.metadata},X))}else f.callback(null,C);else{let X=on(M);f.callback((0,Qt.callErrorFromStatus)(P,X))}M=null,m.emit("status",P)}}}),m}checkMetadataAndOptions(e,r){let i,n;return e instanceof rn.Metadata?(i=e,r?n=r:n={}):(e?n=e:n={},i=new rn.Metadata),{metadata:i,options:n}}makeServerStreamRequest(e,r,i,n,s,o){var a,l;let c=this.checkMetadataAndOptions(s,o),u={path:e,requestStream:!1,responseStream:!0,requestSerialize:r,responseDeserialize:i},f={argument:n,metadata:c.metadata,call:new Qt.ClientReadableStreamImpl(i),channel:this[qt],methodDefinition:u,callOptions:c.options};this[_r]&&(f=this[_r](f));let m=f.call,_={clientInterceptors:this[nn],clientInterceptorProviders:this[sn],callInterceptors:(a=f.callOptions.interceptors)!==null&&a!==void 0?a:[],callInterceptorProviders:(l=f.callOptions.interceptor_providers)!==null&&l!==void 0?l:[]},T=(0,Bo.getInterceptingCall)(_,f.methodDefinition,f.callOptions,f.channel);m.call=T;let C=!1,k=new Error;return T.start(f.metadata,{onReceiveMetadata(M){m.emit("metadata",M)},onReceiveMessage(M){m.push(M)},onReceiveStatus(M){if(!C){if(C=!0,m.push(null),M.code!==qr.Status.OK){let P=on(k);m.emit("error",(0,Qt.callErrorFromStatus)(M,P))}k=null,m.emit("status",M)}}}),T.sendMessage(n),T.halfClose(),m}makeBidiStreamRequest(e,r,i,n,s){var o,a;let l=this.checkMetadataAndOptions(n,s),c={path:e,requestStream:!0,responseStream:!0,requestSerialize:r,responseDeserialize:i},u={metadata:l.metadata,call:new Qt.ClientDuplexStreamImpl(r,i),channel:this[qt],methodDefinition:c,callOptions:l.options};this[_r]&&(u=this[_r](u));let f=u.call,m={clientInterceptors:this[nn],clientInterceptorProviders:this[sn],callInterceptors:(o=u.callOptions.interceptors)!==null&&o!==void 0?o:[],callInterceptorProviders:(a=u.callOptions.interceptor_providers)!==null&&a!==void 0?a:[]},_=(0,Bo.getInterceptingCall)(m,u.methodDefinition,u.callOptions,u.channel);f.call=_;let T=!1,C=new Error;return _.start(u.metadata,{onReceiveMetadata(k){f.emit("metadata",k)},onReceiveMessage(k){f.push(k)},onReceiveStatus(k){if(!T){if(T=!0,f.push(null),k.code!==qr.Status.OK){let M=on(C);f.emit("error",(0,Qt.callErrorFromStatus)(k,M))}C=null,f.emit("status",k)}}}),f}};jo.Client=Uc});var $c=S(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.makeClientConstructor=hp;Uo.loadPackageDefinition=hb;var ss=zc(),cb={unary:ss.Client.prototype.makeUnaryRequest,server_stream:ss.Client.prototype.makeServerStreamRequest,client_stream:ss.Client.prototype.makeClientStreamRequest,bidi:ss.Client.prototype.makeBidiStreamRequest};function Wc(t){return["__proto__","prototype","constructor"].includes(t)}function hp(t,e,r){r||(r={});class i extends ss.Client{}return Object.keys(t).forEach(n=>{if(Wc(n))return;let s=t[n],o;if(typeof n=="string"&&n.charAt(0)==="$")throw new Error("Method names cannot start with $");s.requestStream?s.responseStream?o="bidi":o="client_stream":s.responseStream?o="server_stream":o="unary";let a=s.requestSerialize,l=s.responseDeserialize,c=ub(cb[o],s.path,a,l);i.prototype[n]=c,Object.assign(i.prototype[n],s),s.originalName&&!Wc(s.originalName)&&(i.prototype[s.originalName]=i.prototype[n])}),i.service=t,i.serviceName=e,i}function ub(t,e,r,i){return function(...n){return t.call(this,e,r,i,...n)}}function db(t){return"format"in t}function hb(t){let e={};for(let r in t)if(Object.prototype.hasOwnProperty.call(t,r)){let i=t[r],n=r.split(".");if(n.some(a=>Wc(a)))continue;let s=n[n.length-1],o=e;for(let a of n.slice(0,-1))o[a]||(o[a]={}),o=o[a];db(i)?o[s]=i:o[s]=hp(i,s,{})}return e}});var Fp=S((bO,Lp)=>{var fb=1/0,pb="[object Symbol]",gb=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,mb=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ho="\\ud800-\\udfff",Sp="\\u0300-\\u036f\\ufe20-\\ufe23",Cp="\\u20d0-\\u20f0",bp="\\u2700-\\u27bf",Ep="a-z\\xdf-\\xf6\\xf8-\\xff",yb="\\xac\\xb1\\xd7\\xf7",vb="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",_b="\\u2000-\\u206f",Sb=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Tp="A-Z\\xc0-\\xd6\\xd8-\\xde",wp="\\ufe0e\\ufe0f",Rp=yb+vb+_b+Sb,Gc="['\u2019]",Cb="["+Ho+"]",fp="["+Rp+"]",zo="["+Sp+Cp+"]",kp="\\d+",bb="["+bp+"]",xp="["+Ep+"]",Op="[^"+Ho+Rp+kp+bp+Ep+Tp+"]",Vc="\\ud83c[\\udffb-\\udfff]",Eb="(?:"+zo+"|"+Vc+")",Ap="[^"+Ho+"]",Zc="(?:\\ud83c[\\udde6-\\uddff]){2}",Yc="[\\ud800-\\udbff][\\udc00-\\udfff]",an="["+Tp+"]",Pp="\\u200d",pp="(?:"+xp+"|"+Op+")",Tb="(?:"+an+"|"+Op+")",gp="(?:"+Gc+"(?:d|ll|m|re|s|t|ve))?",mp="(?:"+Gc+"(?:D|LL|M|RE|S|T|VE))?",Mp=Eb+"?",Ip="["+wp+"]?",wb="(?:"+Pp+"(?:"+[Ap,Zc,Yc].join("|")+")"+Ip+Mp+")*",Np=Ip+Mp+wb,Rb="(?:"+[bb,Zc,Yc].join("|")+")"+Np,kb="(?:"+[Ap+zo+"?",zo,Zc,Yc,Cb].join("|")+")",xb=RegExp(Gc,"g"),Ob=RegExp(zo,"g"),Ab=RegExp(Vc+"(?="+Vc+")|"+kb+Np,"g"),Pb=RegExp([an+"?"+xp+"+"+gp+"(?="+[fp,an,"$"].join("|")+")",Tb+"+"+mp+"(?="+[fp,an+pp,"$"].join("|")+")",an+"?"+pp+"+"+gp,an+"+"+mp,kp,Rb].join("|"),"g"),Mb=RegExp("["+Pp+Ho+Sp+Cp+wp+"]"),Ib=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Nb={\u00C0:"A",\u00C1:"A",\u00C2:"A",\u00C3:"A",\u00C4:"A",\u00C5:"A",\u00E0:"a",\u00E1:"a",\u00E2:"a",\u00E3:"a",\u00E4:"a",\u00E5:"a",\u00C7:"C",\u00E7:"c",\u00D0:"D",\u00F0:"d",\u00C8:"E",\u00C9:"E",\u00CA:"E",\u00CB:"E",\u00E8:"e",\u00E9:"e",\u00EA:"e",\u00EB:"e",\u00CC:"I",\u00CD:"I",\u00CE:"I",\u00CF:"I",\u00EC:"i",\u00ED:"i",\u00EE:"i",\u00EF:"i",\u00D1:"N",\u00F1:"n",\u00D2:"O",\u00D3:"O",\u00D4:"O",\u00D5:"O",\u00D6:"O",\u00D8:"O",\u00F2:"o",\u00F3:"o",\u00F4:"o",\u00F5:"o",\u00F6:"o",\u00F8:"o",\u00D9:"U",\u00DA:"U",\u00DB:"U",\u00DC:"U",\u00F9:"u",\u00FA:"u",\u00FB:"u",\u00FC:"u",\u00DD:"Y",\u00FD:"y",\u00FF:"y",\u00C6:"Ae",\u00E6:"ae",\u00DE:"Th",\u00FE:"th",\u00DF:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010A:"C",\u010C:"C",\u0107:"c",\u0109:"c",\u010B:"c",\u010D:"c",\u010E:"D",\u0110:"D",\u010F:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011A:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011B:"e",\u011C:"G",\u011E:"G",\u0120:"G",\u0122:"G",\u011D:"g",\u011F:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012A:"I",\u012C:"I",\u012E:"I",\u0130:"I",\u0129:"i",\u012B:"i",\u012D:"i",\u012F:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013B:"L",\u013D:"L",\u013F:"L",\u0141:"L",\u013A:"l",\u013C:"l",\u013E:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014A:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014B:"n",\u014C:"O",\u014E:"O",\u0150:"O",\u014D:"o",\u014F:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015A:"S",\u015C:"S",\u015E:"S",\u0160:"S",\u015B:"s",\u015D:"s",\u015F:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016A:"U",\u016C:"U",\u016E:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016B:"u",\u016D:"u",\u016F:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017B:"Z",\u017D:"Z",\u017A:"z",\u017C:"z",\u017E:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017F:"ss"},Db=typeof global=="object"&&global&&global.Object===Object&&global,Lb=typeof self=="object"&&self&&self.Object===Object&&self,Fb=Db||Lb||Function("return this")();function qb(t,e,r,i){var n=-1,s=t?t.length:0;for(i&&s&&(r=t[++n]);++n<s;)r=e(r,t[n],n,t);return r}function Bb(t){return t.split("")}function jb(t){return t.match(gb)||[]}function Ub(t){return function(e){return t?.[e]}}var zb=Ub(Nb);function Dp(t){return Mb.test(t)}function Hb(t){return Ib.test(t)}function Wb(t){return Dp(t)?$b(t):Bb(t)}function $b(t){return t.match(Ab)||[]}function Vb(t){return t.match(Pb)||[]}var Gb=Object.prototype,Zb=Gb.toString,yp=Fb.Symbol,vp=yp?yp.prototype:void 0,_p=vp?vp.toString:void 0;function Yb(t,e,r){var i=-1,n=t.length;e<0&&(e=-e>n?0:n+e),r=r>n?n:r,r<0&&(r+=n),n=e>r?0:r-e>>>0,e>>>=0;for(var s=Array(n);++i<n;)s[i]=t[i+e];return s}function Jb(t){if(typeof t=="string")return t;if(tE(t))return _p?_p.call(t):"";var e=t+"";return e=="0"&&1/t==-fb?"-0":e}function Kb(t,e,r){var i=t.length;return r=r===void 0?i:r,!e&&r>=i?t:Yb(t,e,r)}function Xb(t){return function(e){e=Wo(e);var r=Dp(e)?Wb(e):void 0,i=r?r[0]:e.charAt(0),n=r?Kb(r,1).join(""):e.slice(1);return i[t]()+n}}function Qb(t){return function(e){return qb(oE(nE(e).replace(xb,"")),t,"")}}function eE(t){return!!t&&typeof t=="object"}function tE(t){return typeof t=="symbol"||eE(t)&&Zb.call(t)==pb}function Wo(t){return t==null?"":Jb(t)}var rE=Qb(function(t,e,r){return e=e.toLowerCase(),t+(r?iE(e):e)});function iE(t){return sE(Wo(t).toLowerCase())}function nE(t){return t=Wo(t),t&&t.replace(mb,zb).replace(Ob,"")}var sE=Xb("toUpperCase");function oE(t,e,r){return t=Wo(t),e=r?void 0:e,e===void 0?Hb(t)?Vb(t):jb(t):t.match(e)||[]}Lp.exports=rE});var Jc=S((EO,qp)=>{"use strict";qp.exports=aE;function aE(t,e){for(var r=new Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(a,l){r[i]=function(u){if(s)if(s=!1,u)l(u);else{for(var f=new Array(arguments.length-1),m=0;m<f.length;)f[m++]=arguments[m];a.apply(null,f)}};try{t.apply(e||null,r)}catch(c){s&&(s=!1,l(c))}})}});var zp=S(Up=>{"use strict";var $o=Up;$o.length=function(e){var r=e.length;if(!r)return 0;for(var i=0;--r%4>1&&e.charAt(r)==="=";)++i;return Math.ceil(e.length*3)/4-i};var ln=new Array(64),jp=new Array(123);for(Bt=0;Bt<64;)jp[ln[Bt]=Bt<26?Bt+65:Bt<52?Bt+71:Bt<62?Bt-4:Bt-59|43]=Bt++;var Bt;$o.encode=function(e,r,i){for(var n=null,s=[],o=0,a=0,l;r<i;){var c=e[r++];switch(a){case 0:s[o++]=ln[c>>2],l=(c&3)<<4,a=1;break;case 1:s[o++]=ln[l|c>>4],l=(c&15)<<2,a=2;break;case 2:s[o++]=ln[l|c>>6],s[o++]=ln[c&63],a=0;break}o>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),o=0)}return a&&(s[o++]=ln[l],s[o++]=61,a===1&&(s[o++]=61)),n?(o&&n.push(String.fromCharCode.apply(String,s.slice(0,o))),n.join("")):String.fromCharCode.apply(String,s.slice(0,o))};var Bp="invalid encoding";$o.decode=function(e,r,i){for(var n=i,s=0,o,a=0;a<e.length;){var l=e.charCodeAt(a++);if(l===61&&s>1)break;if((l=jp[l])===void 0)throw Error(Bp);switch(s){case 0:o=l,s=1;break;case 1:r[i++]=o<<2|(l&48)>>4,o=l,s=2;break;case 2:r[i++]=(o&15)<<4|(l&60)>>2,o=l,s=3;break;case 3:r[i++]=(o&3)<<6|l,s=0;break}}if(s===1)throw Error(Bp);return i-n};$o.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var Wp=S((wO,Hp)=>{"use strict";Hp.exports=Vo;function Vo(){this._listeners={}}Vo.prototype.on=function(e,r,i){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:i||this}),this};Vo.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var i=this._listeners[e],n=0;n<i.length;)i[n].fn===r?i.splice(n,1):++n;return this};Vo.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var i=[],n=1;n<arguments.length;)i.push(arguments[n++]);for(n=0;n<r.length;)r[n].fn.apply(r[n++].ctx,i)}return this}});var Kp=S((RO,Jp)=>{"use strict";Jp.exports=$p($p);function $p(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),i=r[3]===128;function n(l,c,u){e[0]=l,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function s(l,c,u){e[0]=l,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=i?n:s,t.writeFloatBE=i?s:n;function o(l,c){return r[0]=l[c],r[1]=l[c+1],r[2]=l[c+2],r[3]=l[c+3],e[0]}function a(l,c){return r[3]=l[c],r[2]=l[c+1],r[1]=l[c+2],r[0]=l[c+3],e[0]}t.readFloatLE=i?o:a,t.readFloatBE=i?a:o}():function(){function e(i,n,s,o){var a=n<0?1:0;if(a&&(n=-n),n===0)i(1/n>0?0:2147483648,s,o);else if(isNaN(n))i(2143289344,s,o);else if(n>34028234663852886e22)i((a<<31|2139095040)>>>0,s,o);else if(n<11754943508222875e-54)i((a<<31|Math.round(n/1401298464324817e-60))>>>0,s,o);else{var l=Math.floor(Math.log(n)/Math.LN2),c=Math.round(n*Math.pow(2,-l)*8388608)&8388607;i((a<<31|l+127<<23|c)>>>0,s,o)}}t.writeFloatLE=e.bind(null,Vp),t.writeFloatBE=e.bind(null,Gp);function r(i,n,s){var o=i(n,s),a=(o>>31)*2+1,l=o>>>23&255,c=o&8388607;return l===255?c?NaN:a*(1/0):l===0?a*1401298464324817e-60*c:a*Math.pow(2,l-150)*(c+8388608)}t.readFloatLE=r.bind(null,Zp),t.readFloatBE=r.bind(null,Yp)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),i=r[7]===128;function n(l,c,u){e[0]=l,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function s(l,c,u){e[0]=l,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=i?n:s,t.writeDoubleBE=i?s:n;function o(l,c){return r[0]=l[c],r[1]=l[c+1],r[2]=l[c+2],r[3]=l[c+3],r[4]=l[c+4],r[5]=l[c+5],r[6]=l[c+6],r[7]=l[c+7],e[0]}function a(l,c){return r[7]=l[c],r[6]=l[c+1],r[5]=l[c+2],r[4]=l[c+3],r[3]=l[c+4],r[2]=l[c+5],r[1]=l[c+6],r[0]=l[c+7],e[0]}t.readDoubleLE=i?o:a,t.readDoubleBE=i?a:o}():function(){function e(i,n,s,o,a,l){var c=o<0?1:0;if(c&&(o=-o),o===0)i(0,a,l+n),i(1/o>0?0:2147483648,a,l+s);else if(isNaN(o))i(0,a,l+n),i(2146959360,a,l+s);else if(o>17976931348623157e292)i(0,a,l+n),i((c<<31|2146435072)>>>0,a,l+s);else{var u;if(o<22250738585072014e-324)u=o/5e-324,i(u>>>0,a,l+n),i((c<<31|u/4294967296)>>>0,a,l+s);else{var f=Math.floor(Math.log(o)/Math.LN2);f===1024&&(f=1023),u=o*Math.pow(2,-f),i(u*4503599627370496>>>0,a,l+n),i((c<<31|f+1023<<20|u*1048576&1048575)>>>0,a,l+s)}}}t.writeDoubleLE=e.bind(null,Vp,0,4),t.writeDoubleBE=e.bind(null,Gp,4,0);function r(i,n,s,o,a){var l=i(o,a+n),c=i(o,a+s),u=(c>>31)*2+1,f=c>>>20&2047,m=4294967296*(c&1048575)+l;return f===2047?m?NaN:u*(1/0):f===0?u*5e-324*m:u*Math.pow(2,f-1075)*(m+4503599627370496)}t.readDoubleLE=r.bind(null,Zp,0,4),t.readDoubleBE=r.bind(null,Yp,4,0)}(),t}function Vp(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Gp(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function Zp(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function Yp(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var Kc=S((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Qp=S(Xp=>{"use strict";var Xc=Xp;Xc.length=function(e){for(var r=0,i=0,n=0;n<e.length;++n)i=e.charCodeAt(n),i<128?r+=1:i<2048?r+=2:(i&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,r+=4):r+=3;return r};Xc.read=function(e,r,i){var n=i-r;if(n<1)return"";for(var s=null,o=[],a=0,l;r<i;)l=e[r++],l<128?o[a++]=l:l>191&&l<224?o[a++]=(l&31)<<6|e[r++]&63:l>239&&l<365?(l=((l&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,o[a++]=55296+(l>>10),o[a++]=56320+(l&1023)):o[a++]=(l&15)<<12|(e[r++]&63)<<6|e[r++]&63,a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0);return s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};Xc.write=function(e,r,i){for(var n=i,s,o,a=0;a<e.length;++a)s=e.charCodeAt(a),s<128?r[i++]=s:s<2048?(r[i++]=s>>6|192,r[i++]=s&63|128):(s&64512)===55296&&((o=e.charCodeAt(a+1))&64512)===56320?(s=65536+((s&1023)<<10)+(o&1023),++a,r[i++]=s>>18|240,r[i++]=s>>12&63|128,r[i++]=s>>6&63|128,r[i++]=s&63|128):(r[i++]=s>>12|224,r[i++]=s>>6&63|128,r[i++]=s&63|128);return i-n}});var tg=S((xO,eg)=>{"use strict";eg.exports=lE;function lE(t,e,r){var i=r||8192,n=i>>>1,s=null,o=i;return function(l){if(l<1||l>n)return t(l);o+l>i&&(s=t(i),o=0);var c=e.call(s,o,o+=l);return o&7&&(o=(o|7)+1),c}}});var ig=S((OO,rg)=>{"use strict";rg.exports=ze;var os=er();function ze(t,e){this.lo=t>>>0,this.hi=e>>>0}var bi=ze.zero=new ze(0,0);bi.toNumber=function(){return 0};bi.zzEncode=bi.zzDecode=function(){return this};bi.length=function(){return 1};var cE=ze.zeroHash="\0\0\0\0\0\0\0\0";ze.fromNumber=function(e){if(e===0)return bi;var r=e<0;r&&(e=-e);var i=e>>>0,n=(e-i)/4294967296>>>0;return r&&(n=~n>>>0,i=~i>>>0,++i>4294967295&&(i=0,++n>4294967295&&(n=0))),new ze(i,n)};ze.from=function(e){if(typeof e=="number")return ze.fromNumber(e);if(os.isString(e))if(os.Long)e=os.Long.fromString(e);else return ze.fromNumber(parseInt(e,10));return e.low||e.high?new ze(e.low>>>0,e.high>>>0):bi};ze.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,i=~this.hi>>>0;return r||(i=i+1>>>0),-(r+i*4294967296)}return this.lo+this.hi*4294967296};ze.prototype.toLong=function(e){return os.Long?new os.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Br=String.prototype.charCodeAt;ze.fromHash=function(e){return e===cE?bi:new ze((Br.call(e,0)|Br.call(e,1)<<8|Br.call(e,2)<<16|Br.call(e,3)<<24)>>>0,(Br.call(e,4)|Br.call(e,5)<<8|Br.call(e,6)<<16|Br.call(e,7)<<24)>>>0)};ze.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};ze.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};ze.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};ze.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,i=this.hi>>>24;return i===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:i<128?9:10}});var er=S(Qc=>{"use strict";var W=Qc;W.asPromise=Jc();W.base64=zp();W.EventEmitter=Wp();W.float=Kp();W.inquire=Kc();W.utf8=Qp();W.pool=tg();W.LongBits=ig();W.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node);W.global=W.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||Qc;W.emptyArray=Object.freeze?Object.freeze([]):[];W.emptyObject=Object.freeze?Object.freeze({}):{};W.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};W.isString=function(e){return typeof e=="string"||e instanceof String};W.isObject=function(e){return e&&typeof e=="object"};W.isset=W.isSet=function(e,r){var i=e[r];return i!=null&&e.hasOwnProperty(r)?typeof i!="object"||(Array.isArray(i)?i.length:Object.keys(i).length)>0:!1};W.Buffer=function(){try{var t=W.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();W._Buffer_from=null;W._Buffer_allocUnsafe=null;W.newBuffer=function(e){return typeof e=="number"?W.Buffer?W._Buffer_allocUnsafe(e):new W.Array(e):W.Buffer?W._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};W.Array=typeof Uint8Array<"u"?Uint8Array:Array;W.Long=W.global.dcodeIO&&W.global.dcodeIO.Long||W.global.Long||W.inquire("long");W.key2Re=/^true|false|0|1$/;W.key32Re=/^-?(?:0|[1-9][0-9]*)$/;W.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;W.longToHash=function(e){return e?W.LongBits.from(e).toHash():W.LongBits.zeroHash};W.longFromHash=function(e,r){var i=W.LongBits.fromHash(e);return W.Long?W.Long.fromBits(i.lo,i.hi,r):i.toNumber(!!r)};function ng(t,e,r){for(var i=Object.keys(e),n=0;n<i.length;++n)(t[i[n]]===void 0||!r)&&(t[i[n]]=e[i[n]]);return t}W.merge=ng;W.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function sg(t){function e(r,i){if(!(this instanceof e))return new e(r,i);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),i&&ng(this,i)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}W.newError=sg;W.ProtocolError=sg("ProtocolError");W.oneOfGetter=function(e){for(var r={},i=0;i<e.length;++i)r[e[i]]=1;return function(){for(var n=Object.keys(this),s=n.length-1;s>-1;--s)if(r[n[s]]===1&&this[n[s]]!==void 0&&this[n[s]]!==null)return n[s]}};W.oneOfSetter=function(e){return function(r){for(var i=0;i<e.length;++i)e[i]!==r&&delete this[e[i]]}};W.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};W._configure=function(){var t=W.Buffer;if(!t){W._Buffer_from=W._Buffer_allocUnsafe=null;return}W._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,i){return new t(r,i)},W._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Zo=S((PO,cg)=>{"use strict";cg.exports=ce;var Tt=er(),eu,Go=Tt.LongBits,og=Tt.base64,ag=Tt.utf8;function as(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function ru(){}function uE(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function ce(){this.len=0,this.head=new as(ru,0,0),this.tail=this.head,this.states=null}var lg=function(){return Tt.Buffer?function(){return(ce.create=function(){return new eu})()}:function(){return new ce}};ce.create=lg();ce.alloc=function(e){return new Tt.Array(e)};Tt.Array!==Array&&(ce.alloc=Tt.pool(ce.alloc,Tt.Array.prototype.subarray));ce.prototype._push=function(e,r,i){return this.tail=this.tail.next=new as(e,r,i),this.len+=r,this};function iu(t,e,r){e[r]=t&255}function dE(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function nu(t,e){this.len=t,this.next=void 0,this.val=e}nu.prototype=Object.create(as.prototype);nu.prototype.fn=dE;ce.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new nu((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};ce.prototype.int32=function(e){return e<0?this._push(su,10,Go.fromNumber(e)):this.uint32(e)};ce.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function su(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}ce.prototype.uint64=function(e){var r=Go.from(e);return this._push(su,r.length(),r)};ce.prototype.int64=ce.prototype.uint64;ce.prototype.sint64=function(e){var r=Go.from(e).zzEncode();return this._push(su,r.length(),r)};ce.prototype.bool=function(e){return this._push(iu,1,e?1:0)};function tu(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}ce.prototype.fixed32=function(e){return this._push(tu,4,e>>>0)};ce.prototype.sfixed32=ce.prototype.fixed32;ce.prototype.fixed64=function(e){var r=Go.from(e);return this._push(tu,4,r.lo)._push(tu,4,r.hi)};ce.prototype.sfixed64=ce.prototype.fixed64;ce.prototype.float=function(e){return this._push(Tt.float.writeFloatLE,4,e)};ce.prototype.double=function(e){return this._push(Tt.float.writeDoubleLE,8,e)};var hE=Tt.Array.prototype.set?function(e,r,i){r.set(e,i)}:function(e,r,i){for(var n=0;n<e.length;++n)r[i+n]=e[n]};ce.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(iu,1,0);if(Tt.isString(e)){var i=ce.alloc(r=og.length(e));og.decode(e,i,0),e=i}return this.uint32(r)._push(hE,r,e)};ce.prototype.string=function(e){var r=ag.length(e);return r?this.uint32(r)._push(ag.write,r,e):this._push(iu,1,0)};ce.prototype.fork=function(){return this.states=new uE(this),this.head=this.tail=new as(ru,0,0),this.len=0,this};ce.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new as(ru,0,0),this.len=0),this};ce.prototype.ldelim=function(){var e=this.head,r=this.tail,i=this.len;return this.reset().uint32(i),i&&(this.tail.next=e.next,this.tail=r,this.len+=i),this};ce.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),i=0;e;)e.fn(e.val,r,i),i+=e.len,e=e.next;return r};ce._configure=function(t){eu=t,ce.create=lg(),eu._configure()}});var hg=S((MO,dg)=>{"use strict";dg.exports=tr;var ug=Zo();(tr.prototype=Object.create(ug.prototype)).constructor=tr;var jr=er();function tr(){ug.call(this)}tr._configure=function(){tr.alloc=jr._Buffer_allocUnsafe,tr.writeBytesBuffer=jr.Buffer&&jr.Buffer.prototype instanceof Uint8Array&&jr.Buffer.prototype.set.name==="set"?function(e,r,i){r.set(e,i)}:function(e,r,i){if(e.copy)e.copy(r,i,0,e.length);else for(var n=0;n<e.length;)r[i++]=e[n++]}};tr.prototype.bytes=function(e){jr.isString(e)&&(e=jr._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(tr.writeBytesBuffer,r,e),this};function fE(t,e,r){t.length<40?jr.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}tr.prototype.string=function(e){var r=jr.Buffer.byteLength(e);return this.uint32(r),r&&this._push(fE,r,e),this};tr._configure()});var Jo=S((IO,yg)=>{"use strict";yg.exports=Me;var jt=er(),au,gg=jt.LongBits,pE=jt.utf8;function Ut(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function Me(t){this.buf=t,this.pos=0,this.len=t.length}var fg=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new Me(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new Me(e);throw Error("illegal buffer")},mg=function(){return jt.Buffer?function(r){return(Me.create=function(n){return jt.Buffer.isBuffer(n)?new au(n):fg(n)})(r)}:fg};Me.create=mg();Me.prototype._slice=jt.Array.prototype.subarray||jt.Array.prototype.slice;Me.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Ut(this,10);return e}}();Me.prototype.int32=function(){return this.uint32()|0};Me.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function ou(){var t=new gg(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw Ut(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw Ut(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}Me.prototype.bool=function(){return this.uint32()!==0};function Yo(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}Me.prototype.fixed32=function(){if(this.pos+4>this.len)throw Ut(this,4);return Yo(this.buf,this.pos+=4)};Me.prototype.sfixed32=function(){if(this.pos+4>this.len)throw Ut(this,4);return Yo(this.buf,this.pos+=4)|0};function pg(){if(this.pos+8>this.len)throw Ut(this,8);return new gg(Yo(this.buf,this.pos+=4),Yo(this.buf,this.pos+=4))}Me.prototype.float=function(){if(this.pos+4>this.len)throw Ut(this,4);var e=jt.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};Me.prototype.double=function(){if(this.pos+8>this.len)throw Ut(this,4);var e=jt.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};Me.prototype.bytes=function(){var e=this.uint32(),r=this.pos,i=this.pos+e;if(i>this.len)throw Ut(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(r,i);if(r===i){var n=jt.Buffer;return n?n.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,r,i)};Me.prototype.string=function(){var e=this.bytes();return pE.read(e,0,e.length)};Me.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Ut(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Ut(this);while(this.buf[this.pos++]&128);return this};Me.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};Me._configure=function(t){au=t,Me.create=mg(),au._configure();var e=jt.Long?"toLong":"toNumber";jt.merge(Me.prototype,{int64:function(){return ou.call(this)[e](!1)},uint64:function(){return ou.call(this)[e](!0)},sint64:function(){return ou.call(this).zzDecode()[e](!1)},fixed64:function(){return pg.call(this)[e](!0)},sfixed64:function(){return pg.call(this)[e](!1)}})}});var Cg=S((NO,Sg)=>{"use strict";Sg.exports=Ei;var _g=Jo();(Ei.prototype=Object.create(_g.prototype)).constructor=Ei;var vg=er();function Ei(t){_g.call(this,t)}Ei._configure=function(){vg.Buffer&&(Ei.prototype._slice=vg.Buffer.prototype.slice)};Ei.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ei._configure()});var Eg=S((DO,bg)=>{"use strict";bg.exports=ls;var lu=er();(ls.prototype=Object.create(lu.EventEmitter.prototype)).constructor=ls;function ls(t,e,r){if(typeof t!="function")throw TypeError("rpcImpl must be a function");lu.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=!!e,this.responseDelimited=!!r}ls.prototype.rpcCall=function t(e,r,i,n,s){if(!n)throw TypeError("request must be specified");var o=this;if(!s)return lu.asPromise(t,o,e,r,i,n);if(!o.rpcImpl){setTimeout(function(){s(Error("already ended"))},0);return}try{return o.rpcImpl(e,r[o.requestDelimited?"encodeDelimited":"encode"](n).finish(),function(l,c){if(l)return o.emit("error",l,e),s(l);if(c===null){o.end(!0);return}if(!(c instanceof i))try{c=i[o.responseDelimited?"decodeDelimited":"decode"](c)}catch(u){return o.emit("error",u,e),s(u)}return o.emit("data",c,e),s(null,c)})}catch(a){o.emit("error",a,e),setTimeout(function(){s(a)},0);return}};ls.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}});var cu=S(Tg=>{"use strict";var gE=Tg;gE.Service=Eg()});var uu=S((FO,wg)=>{"use strict";wg.exports={}});var xg=S(kg=>{"use strict";var at=kg;at.build="minimal";at.Writer=Zo();at.BufferWriter=hg();at.Reader=Jo();at.BufferReader=Cg();at.util=er();at.rpc=cu();at.roots=uu();at.configure=Rg;function Rg(){at.util._configure(),at.Writer._configure(at.BufferWriter),at.Reader._configure(at.BufferReader)}Rg()});var Ag=S((BO,Og)=>{"use strict";Og.exports=du;function du(t,e){typeof t=="string"&&(e=t,t=void 0);var r=[];function i(s){if(typeof s!="string"){var o=n();if(du.verbose&&console.log("codegen: "+o),o="return "+o,s){for(var a=Object.keys(s),l=new Array(a.length+1),c=new Array(a.length),u=0;u<a.length;)l[u]=a[u],c[u]=s[a[u++]];return l[u]=o,Function.apply(null,l).apply(null,c)}return Function(o)()}for(var f=new Array(arguments.length-1),m=0;m<f.length;)f[m]=arguments[++m];if(m=0,s=s.replace(/%([%dfijs])/g,function(T,C){var k=f[m++];switch(C){case"d":case"f":return String(Number(k));case"i":return String(Math.floor(k));case"j":return JSON.stringify(k);case"s":return String(k)}return"%"}),m!==f.length)throw Error("parameter count mismatch");return r.push(s),i}function n(s){return"function "+(s||e||"")+"("+(t&&t.join(",")||"")+`){
  `+r.join(`
  `)+`
}`}return i.toString=n,i}du.verbose=!1});var Mg=S((jO,Pg)=>{"use strict";Pg.exports=cs;var mE=Jc(),yE=Kc(),hu=yE("fs");function cs(t,e,r){return typeof e=="function"?(r=e,e={}):e||(e={}),r?!e.xhr&&hu&&hu.readFile?hu.readFile(t,function(n,s){return n&&typeof XMLHttpRequest<"u"?cs.xhr(t,e,r):n?r(n):r(null,e.binary?s:s.toString("utf8"))}):cs.xhr(t,e,r):mE(cs,this,t,e)}cs.xhr=function(e,r,i){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===4){if(n.status!==0&&n.status!==200)return i(Error("status "+n.status));if(r.binary){var o=n.response;if(!o){o=[];for(var a=0;a<n.responseText.length;++a)o.push(n.responseText.charCodeAt(a)&255)}return i(null,typeof Uint8Array<"u"?new Uint8Array(o):o)}return i(null,n.responseText)}},r.binary&&("overrideMimeType"in n&&n.overrideMimeType("text/plain; charset=x-user-defined"),n.responseType="arraybuffer"),n.open("GET",e),n.send()}});var Dg=S(Ng=>{"use strict";var pu=Ng,Ig=pu.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},fu=pu.normalize=function(e){e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/");var r=e.split("/"),i=Ig(e),n="";i&&(n=r.shift()+"/");for(var s=0;s<r.length;)r[s]===".."?s>0&&r[s-1]!==".."?r.splice(--s,2):i?r.splice(s,1):++s:r[s]==="."?r.splice(s,1):++s;return n+r.join("/")};pu.resolve=function(e,r,i){return i||(r=fu(r)),Ig(r)?r:(i||(e=fu(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?fu(e+"/"+r):r)}});var Ti=S(Lg=>{"use strict";var us=Lg,vE=He(),_E=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function ds(t,e){var r=0,i={};for(e|=0;r<t.length;)i[_E[r+e]]=t[r++];return i}us.basic=ds([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]);us.defaults=ds([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",vE.emptyArray,null]);us.long=ds([0,0,0,1,1],7);us.mapKey=ds([0,0,0,5,5,0,0,0,1,1,0,2],2);us.packed=ds([1,5,0,0,0,5,5,0,0,0,1,1,0])});var Ur=S((HO,Bg)=>{"use strict";Bg.exports=wt;var Ko=wi();((wt.prototype=Object.create(Ko.prototype)).constructor=wt).className="Field";var Fg=zt(),qg=Ti(),Fe=He(),gu,SE=/^required|optional|repeated$/;wt.fromJSON=function(e,r){return new wt(e,r.id,r.type,r.rule,r.extend,r.options,r.comment)};function wt(t,e,r,i,n,s,o){if(Fe.isObject(i)?(o=n,s=i,i=n=void 0):Fe.isObject(n)&&(o=s,s=n,n=void 0),Ko.call(this,t,s),!Fe.isInteger(e)||e<0)throw TypeError("id must be a non-negative integer");if(!Fe.isString(r))throw TypeError("type must be a string");if(i!==void 0&&!SE.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(n!==void 0&&!Fe.isString(n))throw TypeError("extend must be a string");i==="proto3_optional"&&(i="optional"),this.rule=i&&i!=="optional"?i:void 0,this.type=r,this.id=e,this.extend=n||void 0,this.required=i==="required",this.optional=!this.required,this.repeated=i==="repeated",this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=Fe.Long?qg.long[r]!==void 0:!1,this.bytes=r==="bytes",this.resolvedType=null,this.extensionField=null,this.declaringField=null,this._packed=null,this.comment=o}Object.defineProperty(wt.prototype,"packed",{get:function(){return this._packed===null&&(this._packed=this.getOption("packed")!==!1),this._packed}});wt.prototype.setOption=function(e,r,i){return e==="packed"&&(this._packed=null),Ko.prototype.setOption.call(this,e,r,i)};wt.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return Fe.toObject(["rule",this.rule!=="optional"&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};wt.prototype.resolve=function(){if(this.resolved)return this;if((this.typeDefault=qg.defaults[this.type])===void 0?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof gu?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&this.options.default!=null&&(this.typeDefault=this.options.default,this.resolvedType instanceof Fg&&typeof this.typeDefault=="string"&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&((this.options.packed===!0||this.options.packed!==void 0&&this.resolvedType&&!(this.resolvedType instanceof Fg))&&delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=Fe.Long.fromNumber(this.typeDefault,this.type.charAt(0)==="u"),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&typeof this.typeDefault=="string"){var e;Fe.base64.test(this.typeDefault)?Fe.base64.decode(this.typeDefault,e=Fe.newBuffer(Fe.base64.length(this.typeDefault)),0):Fe.utf8.write(this.typeDefault,e=Fe.newBuffer(Fe.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=Fe.emptyObject:this.repeated?this.defaultValue=Fe.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof gu&&(this.parent.ctor.prototype[this.name]=this.defaultValue),Ko.prototype.resolve.call(this)};wt.d=function(e,r,i,n){return typeof r=="function"?r=Fe.decorateType(r).name:r&&typeof r=="object"&&(r=Fe.decorateEnum(r).name),function(o,a){Fe.decorateType(o.constructor).add(new wt(a,e,r,i,{default:n}))}};wt._configure=function(e){gu=e}});var cn=S((WO,zg)=>{"use strict";zg.exports=Rt;var Qo=wi();((Rt.prototype=Object.create(Qo.prototype)).constructor=Rt).className="OneOf";var jg=Ur(),Xo=He();function Rt(t,e,r,i){if(Array.isArray(e)||(r=e,e=void 0),Qo.call(this,t,r),!(e===void 0||Array.isArray(e)))throw TypeError("fieldNames must be an Array");this.oneof=e||[],this.fieldsArray=[],this.comment=i}Rt.fromJSON=function(e,r){return new Rt(e,r.oneof,r.options,r.comment)};Rt.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return Xo.toObject(["options",this.options,"oneof",this.oneof,"comment",r?this.comment:void 0])};function Ug(t){if(t.parent)for(var e=0;e<t.fieldsArray.length;++e)t.fieldsArray[e].parent||t.parent.add(t.fieldsArray[e])}Rt.prototype.add=function(e){if(!(e instanceof jg))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,Ug(this),this};Rt.prototype.remove=function(e){if(!(e instanceof jg))throw TypeError("field must be a Field");var r=this.fieldsArray.indexOf(e);if(r<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(r,1),r=this.oneof.indexOf(e.name),r>-1&&this.oneof.splice(r,1),e.partOf=null,this};Rt.prototype.onAdd=function(e){Qo.prototype.onAdd.call(this,e);for(var r=this,i=0;i<this.oneof.length;++i){var n=e.get(this.oneof[i]);n&&!n.partOf&&(n.partOf=r,r.fieldsArray.push(n))}Ug(this)};Rt.prototype.onRemove=function(e){for(var r=0,i;r<this.fieldsArray.length;++r)(i=this.fieldsArray[r]).parent&&i.parent.remove(i);Qo.prototype.onRemove.call(this,e)};Rt.d=function(){for(var e=new Array(arguments.length),r=0;r<arguments.length;)e[r]=arguments[r++];return function(n,s){Xo.decorateType(n.constructor).add(new Rt(s,e)),Object.defineProperty(n,s,{get:Xo.oneOfGetter(e),set:Xo.oneOfSetter(e)})}}});var hn=S(($O,Vg)=>{"use strict";Vg.exports=ue;var mu=wi();((ue.prototype=Object.create(mu.prototype)).constructor=ue).className="Namespace";var Hg=Ur(),ea=He(),CE=cn(),un,hs,dn;ue.fromJSON=function(e,r){return new ue(e,r.options).addJSON(r.nested)};function Wg(t,e){if(t&&t.length){for(var r={},i=0;i<t.length;++i)r[t[i].name]=t[i].toJSON(e);return r}}ue.arrayToJSON=Wg;ue.isReservedId=function(e,r){if(e){for(var i=0;i<e.length;++i)if(typeof e[i]!="string"&&e[i][0]<=r&&e[i][1]>r)return!0}return!1};ue.isReservedName=function(e,r){if(e){for(var i=0;i<e.length;++i)if(e[i]===r)return!0}return!1};function ue(t,e){mu.call(this,t,e),this.nested=void 0,this._nestedArray=null}function $g(t){return t._nestedArray=null,t}Object.defineProperty(ue.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=ea.toArray(this.nested))}});ue.prototype.toJSON=function(e){return ea.toObject(["options",this.options,"nested",Wg(this.nestedArray,e)])};ue.prototype.addJSON=function(e){var r=this;if(e)for(var i=Object.keys(e),n=0,s;n<i.length;++n)s=e[i[n]],r.add((s.fields!==void 0?un.fromJSON:s.values!==void 0?dn.fromJSON:s.methods!==void 0?hs.fromJSON:s.id!==void 0?Hg.fromJSON:ue.fromJSON)(i[n],s));return this};ue.prototype.get=function(e){return this.nested&&this.nested[e]||null};ue.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof dn)return this.nested[e].values;throw Error("no such enum: "+e)};ue.prototype.add=function(e){if(!(e instanceof Hg&&e.extend!==void 0||e instanceof un||e instanceof CE||e instanceof dn||e instanceof hs||e instanceof ue))throw TypeError("object must be a valid nested object");if(!this.nested)this.nested={};else{var r=this.get(e.name);if(r)if(r instanceof ue&&e instanceof ue&&!(r instanceof un||r instanceof hs)){for(var i=r.nestedArray,n=0;n<i.length;++n)e.add(i[n]);this.remove(r),this.nested||(this.nested={}),e.setOptions(r.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}return this.nested[e.name]=e,e.onAdd(this),$g(this)};ue.prototype.remove=function(e){if(!(e instanceof mu))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),$g(this)};ue.prototype.define=function(e,r){if(ea.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&e[0]==="")throw Error("path must be relative");for(var i=this;e.length>0;){var n=e.shift();if(i.nested&&i.nested[n]){if(i=i.nested[n],!(i instanceof ue))throw Error("path conflicts with non-namespace objects")}else i.add(i=new ue(n))}return r&&i.addJSON(r),i};ue.prototype.resolveAll=function(){for(var e=this.nestedArray,r=0;r<e.length;)e[r]instanceof ue?e[r++].resolveAll():e[r++].resolve();return this.resolve()};ue.prototype.lookup=function(e,r,i){if(typeof r=="boolean"?(i=r,r=void 0):r&&!Array.isArray(r)&&(r=[r]),ea.isString(e)&&e.length){if(e===".")return this.root;e=e.split(".")}else if(!e.length)return this;if(e[0]==="")return this.root.lookup(e.slice(1),r);var n=this.get(e[0]);if(n){if(e.length===1){if(!r||r.indexOf(n.constructor)>-1)return n}else if(n instanceof ue&&(n=n.lookup(e.slice(1),r,!0)))return n}else for(var s=0;s<this.nestedArray.length;++s)if(this._nestedArray[s]instanceof ue&&(n=this._nestedArray[s].lookup(e,r,!0)))return n;return this.parent===null||i?null:this.parent.lookup(e,r)};ue.prototype.lookupType=function(e){var r=this.lookup(e,[un]);if(!r)throw Error("no such type: "+e);return r};ue.prototype.lookupEnum=function(e){var r=this.lookup(e,[dn]);if(!r)throw Error("no such Enum '"+e+"' in "+this);return r};ue.prototype.lookupTypeOrEnum=function(e){var r=this.lookup(e,[un,dn]);if(!r)throw Error("no such Type or Enum '"+e+"' in "+this);return r};ue.prototype.lookupService=function(e){var r=this.lookup(e,[hs]);if(!r)throw Error("no such Service '"+e+"' in "+this);return r};ue._configure=function(t,e,r){un=t,hs=e,dn=r}});var ta=S((VO,Gg)=>{"use strict";Gg.exports=Sr;var yu=Ur();((Sr.prototype=Object.create(yu.prototype)).constructor=Sr).className="MapField";var bE=Ti(),fs=He();function Sr(t,e,r,i,n,s){if(yu.call(this,t,e,i,void 0,void 0,n,s),!fs.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}Sr.fromJSON=function(e,r){return new Sr(e,r.id,r.keyType,r.type,r.options,r.comment)};Sr.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return fs.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",r?this.comment:void 0])};Sr.prototype.resolve=function(){if(this.resolved)return this;if(bE.mapKey[this.keyType]===void 0)throw Error("invalid key type: "+this.keyType);return yu.prototype.resolve.call(this)};Sr.d=function(e,r,i){return typeof i=="function"?i=fs.decorateType(i).name:i&&typeof i=="object"&&(i=fs.decorateEnum(i).name),function(s,o){fs.decorateType(s.constructor).add(new Sr(o,e,r,i))}}});var ra=S((GO,Zg)=>{"use strict";Zg.exports=Ri;var vu=wi();((Ri.prototype=Object.create(vu.prototype)).constructor=Ri).className="Method";var fn=He();function Ri(t,e,r,i,n,s,o,a,l){if(fn.isObject(n)?(o=n,n=s=void 0):fn.isObject(s)&&(o=s,s=void 0),!(e===void 0||fn.isString(e)))throw TypeError("type must be a string");if(!fn.isString(r))throw TypeError("requestType must be a string");if(!fn.isString(i))throw TypeError("responseType must be a string");vu.call(this,t,o),this.type=e||"rpc",this.requestType=r,this.requestStream=n?!0:void 0,this.responseType=i,this.responseStream=s?!0:void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=a,this.parsedOptions=l}Ri.fromJSON=function(e,r){return new Ri(e,r.type,r.requestType,r.responseType,r.requestStream,r.responseStream,r.options,r.comment,r.parsedOptions)};Ri.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return fn.toObject(["type",this.type!=="rpc"&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",r?this.comment:void 0,"parsedOptions",this.parsedOptions])};Ri.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),vu.prototype.resolve.call(this))}});var ia=S((ZO,Jg)=>{"use strict";Jg.exports=kt;var zr=hn();((kt.prototype=Object.create(zr.prototype)).constructor=kt).className="Service";var _u=ra(),ps=He(),EE=cu();function kt(t,e){zr.call(this,t,e),this.methods={},this._methodsArray=null}kt.fromJSON=function(e,r){var i=new kt(e,r.options);if(r.methods)for(var n=Object.keys(r.methods),s=0;s<n.length;++s)i.add(_u.fromJSON(n[s],r.methods[n[s]]));return r.nested&&i.addJSON(r.nested),i.comment=r.comment,i};kt.prototype.toJSON=function(e){var r=zr.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return ps.toObject(["options",r&&r.options||void 0,"methods",zr.arrayToJSON(this.methodsArray,e)||{},"nested",r&&r.nested||void 0,"comment",i?this.comment:void 0])};Object.defineProperty(kt.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=ps.toArray(this.methods))}});function Yg(t){return t._methodsArray=null,t}kt.prototype.get=function(e){return this.methods[e]||zr.prototype.get.call(this,e)};kt.prototype.resolveAll=function(){for(var e=this.methodsArray,r=0;r<e.length;++r)e[r].resolve();return zr.prototype.resolve.call(this)};kt.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof _u?(this.methods[e.name]=e,e.parent=this,Yg(this)):zr.prototype.add.call(this,e)};kt.prototype.remove=function(e){if(e instanceof _u){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,Yg(this)}return zr.prototype.remove.call(this,e)};kt.prototype.create=function(e,r,i){for(var n=new EE.Service(e,r,i),s=0,o;s<this.methodsArray.length;++s){var a=ps.lcFirst((o=this._methodsArray[s]).resolve().name).replace(/[^$\w_]/g,"");n[a]=ps.codegen(["r","c"],ps.isReserved(a)?a+"_":a)("return this.rpcCall(m,q,s,r,c)")({m:o,q:o.resolvedRequestType.ctor,s:o.resolvedResponseType.ctor})}return n}});var na=S((YO,Kg)=>{"use strict";Kg.exports=rr;var TE=er();function rr(t){if(t)for(var e=Object.keys(t),r=0;r<e.length;++r)this[e[r]]=t[e[r]]}rr.create=function(e){return this.$type.create(e)};rr.encode=function(e,r){return this.$type.encode(e,r)};rr.encodeDelimited=function(e,r){return this.$type.encodeDelimited(e,r)};rr.decode=function(e){return this.$type.decode(e)};rr.decodeDelimited=function(e){return this.$type.decodeDelimited(e)};rr.verify=function(e){return this.$type.verify(e)};rr.fromObject=function(e){return this.$type.fromObject(e)};rr.toObject=function(e,r){return this.$type.toObject(e,r)};rr.prototype.toJSON=function(){return this.$type.toObject(this,TE.toJSONOptions)}});var Su=S((JO,Qg)=>{"use strict";Qg.exports=kE;var wE=zt(),Cr=Ti(),Xg=He();function RE(t){return"missing required '"+t.name+"'"}function kE(t){var e=Xg.codegen(["r","l"],t.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(t.fieldsArray.filter(function(a){return a.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()");t.group&&e("if((t&7)===4)")("break"),e("switch(t>>>3){");for(var r=0;r<t.fieldsArray.length;++r){var i=t._fieldsArray[r].resolve(),n=i.resolvedType instanceof wE?"int32":i.type,s="m"+Xg.safeProp(i.name);e("case %i: {",i.id),i.map?(e("if(%s===util.emptyObject)",s)("%s={}",s)("var c2 = r.uint32()+r.pos"),Cr.defaults[i.keyType]!==void 0?e("k=%j",Cr.defaults[i.keyType]):e("k=null"),Cr.defaults[n]!==void 0?e("value=%j",Cr.defaults[n]):e("value=null"),e("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",i.keyType)("case 2:"),Cr.basic[n]===void 0?e("value=types[%i].decode(r,r.uint32())",r):e("value=r.%s()",n),e("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),Cr.long[i.keyType]!==void 0?e('%s[typeof k==="object"?util.longToHash(k):k]=value',s):e("%s[k]=value",s)):i.repeated?(e("if(!(%s&&%s.length))",s,s)("%s=[]",s),Cr.packed[n]!==void 0&&e("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",s,n)("}else"),Cr.basic[n]===void 0?e(i.resolvedType.group?"%s.push(types[%i].decode(r))":"%s.push(types[%i].decode(r,r.uint32()))",s,r):e("%s.push(r.%s())",s,n)):Cr.basic[n]===void 0?e(i.resolvedType.group?"%s=types[%i].decode(r)":"%s=types[%i].decode(r,r.uint32())",s,r):e("%s=r.%s()",s,n),e("break")("}")}for(e("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<t._fieldsArray.length;++r){var o=t._fieldsArray[r];o.required&&e("if(!m.hasOwnProperty(%j))",o.name)("throw util.ProtocolError(%j,{instance:m})",RE(o))}return e("return m")}});var Eu=S((KO,em)=>{"use strict";em.exports=AE;var xE=zt(),Cu=He();function xt(t,e){return t.name+": "+e+(t.repeated&&e!=="array"?"[]":t.map&&e!=="object"?"{k:"+t.keyType+"}":"")+" expected"}function bu(t,e,r,i){if(e.resolvedType)if(e.resolvedType instanceof xE){t("switch(%s){",i)("default:")("return%j",xt(e,"enum value"));for(var n=Object.keys(e.resolvedType.values),s=0;s<n.length;++s)t("case %i:",e.resolvedType.values[n[s]]);t("break")("}")}else t("{")("var e=types[%i].verify(%s);",r,i)("if(e)")("return%j+e",e.name+".")("}");else switch(e.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.isInteger(%s))",i)("return%j",xt(e,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",i,i,i,i)("return%j",xt(e,"integer|Long"));break;case"float":case"double":t('if(typeof %s!=="number")',i)("return%j",xt(e,"number"));break;case"bool":t('if(typeof %s!=="boolean")',i)("return%j",xt(e,"boolean"));break;case"string":t("if(!util.isString(%s))",i)("return%j",xt(e,"string"));break;case"bytes":t('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',i,i,i)("return%j",xt(e,"buffer"));break}return t}function OE(t,e,r){switch(e.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":t("if(!util.key32Re.test(%s))",r)("return%j",xt(e,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":t("if(!util.key64Re.test(%s))",r)("return%j",xt(e,"integer|Long key"));break;case"bool":t("if(!util.key2Re.test(%s))",r)("return%j",xt(e,"boolean key"));break}return t}function AE(t){var e=Cu.codegen(["m"],t.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=t.oneofsArray,i={};r.length&&e("var p={}");for(var n=0;n<t.fieldsArray.length;++n){var s=t._fieldsArray[n].resolve(),o="m"+Cu.safeProp(s.name);if(s.optional&&e("if(%s!=null&&m.hasOwnProperty(%j)){",o,s.name),s.map)e("if(!util.isObject(%s))",o)("return%j",xt(s,"object"))("var k=Object.keys(%s)",o)("for(var i=0;i<k.length;++i){"),OE(e,s,"k[i]"),bu(e,s,n,o+"[k[i]]")("}");else if(s.repeated)e("if(!Array.isArray(%s))",o)("return%j",xt(s,"array"))("for(var i=0;i<%s.length;++i){",o),bu(e,s,n,o+"[i]")("}");else{if(s.partOf){var a=Cu.safeProp(s.partOf.name);i[s.partOf.name]===1&&e("if(p%s===1)",a)("return%j",s.partOf.name+": multiple values"),i[s.partOf.name]=1,e("p%s=1",a)}bu(e,s,n,o)}s.optional&&e("}")}return e("return null")}});var Ru=S(rm=>{"use strict";var tm=rm,gs=zt(),ir=He();function Tu(t,e,r,i){var n=!1;if(e.resolvedType)if(e.resolvedType instanceof gs){t("switch(d%s){",i);for(var s=e.resolvedType.values,o=Object.keys(s),a=0;a<o.length;++a)s[o[a]]===e.typeDefault&&!n&&(t("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',i,i,i),e.repeated||t("break"),n=!0),t("case%j:",o[a])("case %i:",s[o[a]])("m%s=%j",i,s[o[a]])("break");t("}")}else t('if(typeof d%s!=="object")',i)("throw TypeError(%j)",e.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,r,i);else{var l=!1;switch(e.type){case"double":case"float":t("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":t("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":t("m%s=d%s|0",i,i);break;case"uint64":l=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,l)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,l?"true":"");break;case"bytes":t('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length >= 0)",i)("m%s=d%s",i,i);break;case"string":t("m%s=String(d%s)",i,i);break;case"bool":t("m%s=Boolean(d%s)",i,i);break}}return t}tm.fromObject=function(e){var r=e.fieldsArray,i=ir.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!r.length)return i("return new this.ctor");i("var m=new this.ctor");for(var n=0;n<r.length;++n){var s=r[n].resolve(),o=ir.safeProp(s.name);s.map?(i("if(d%s){",o)('if(typeof d%s!=="object")',o)("throw TypeError(%j)",s.fullName+": object expected")("m%s={}",o)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",o),Tu(i,s,n,o+"[ks[i]]")("}")("}")):s.repeated?(i("if(d%s){",o)("if(!Array.isArray(d%s))",o)("throw TypeError(%j)",s.fullName+": array expected")("m%s=[]",o)("for(var i=0;i<d%s.length;++i){",o),Tu(i,s,n,o+"[i]")("}")("}")):(s.resolvedType instanceof gs||i("if(d%s!=null){",o),Tu(i,s,n,o),s.resolvedType instanceof gs||i("}"))}return i("return m")};function wu(t,e,r,i){if(e.resolvedType)e.resolvedType instanceof gs?t("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",i,r,i,i,r,i,i):t("d%s=types[%i].toObject(m%s,o)",i,r,i);else{var n=!1;switch(e.type){case"double":case"float":t("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":n=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":t('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,n?"true":"",i);break;case"bytes":t("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:t("d%s=m%s",i,i);break}}return t}tm.toObject=function(e){var r=e.fieldsArray.slice().sort(ir.compareFieldsById);if(!r.length)return ir.codegen()("return {}");for(var i=ir.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),n=[],s=[],o=[],a=0;a<r.length;++a)r[a].partOf||(r[a].resolve().repeated?n:r[a].map?s:o).push(r[a]);if(n.length){for(i("if(o.arrays||o.defaults){"),a=0;a<n.length;++a)i("d%s=[]",ir.safeProp(n[a].name));i("}")}if(s.length){for(i("if(o.objects||o.defaults){"),a=0;a<s.length;++a)i("d%s={}",ir.safeProp(s[a].name));i("}")}if(o.length){for(i("if(o.defaults){"),a=0;a<o.length;++a){var l=o[a],c=ir.safeProp(l.name);if(l.resolvedType instanceof gs)i("d%s=o.enums===String?%j:%j",c,l.resolvedType.valuesById[l.typeDefault],l.typeDefault);else if(l.long)i("if(util.Long){")("var n=new util.Long(%i,%i,%j)",l.typeDefault.low,l.typeDefault.high,l.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",c)("}else")("d%s=o.longs===String?%j:%i",c,l.typeDefault.toString(),l.typeDefault.toNumber());else if(l.bytes){var u="["+Array.prototype.slice.call(l.typeDefault).join(",")+"]";i("if(o.bytes===String)d%s=%j",c,String.fromCharCode.apply(String,l.typeDefault))("else{")("d%s=%s",c,u)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",c,c)("}")}else i("d%s=%j",c,l.typeDefault)}i("}")}var f=!1;for(a=0;a<r.length;++a){var l=r[a],m=e._fieldsArray.indexOf(l),c=ir.safeProp(l.name);l.map?(f||(f=!0,i("var ks2")),i("if(m%s&&(ks2=Object.keys(m%s)).length){",c,c)("d%s={}",c)("for(var j=0;j<ks2.length;++j){"),wu(i,l,m,c+"[ks2[j]]")("}")):l.repeated?(i("if(m%s&&m%s.length){",c,c)("d%s=[]",c)("for(var j=0;j<m%s.length;++j){",c),wu(i,l,m,c+"[j]")("}")):(i("if(m%s!=null&&m.hasOwnProperty(%j)){",c,l.name),wu(i,l,m,c),l.partOf&&i("if(o.oneofs)")("d%s=%j",ir.safeProp(l.partOf.name),l.name)),i("}")}return i("return d")}});var ku=S(im=>{"use strict";var PE=im,ME=na();PE[".google.protobuf.Any"]={fromObject:function(t){if(t&&t["@type"]){var e=t["@type"].substring(t["@type"].lastIndexOf("/")+1),r=this.lookup(e);if(r){var i=t["@type"].charAt(0)==="."?t["@type"].slice(1):t["@type"];return i.indexOf("/")===-1&&(i="/"+i),this.create({type_url:i,value:r.encode(r.fromObject(t)).finish()})}}return this.fromObject(t)},toObject:function(t,e){var r="type.googleapis.com/",i="",n="";if(e&&e.json&&t.type_url&&t.value){n=t.type_url.substring(t.type_url.lastIndexOf("/")+1),i=t.type_url.substring(0,t.type_url.lastIndexOf("/")+1);var s=this.lookup(n);s&&(t=s.decode(t.value))}if(!(t instanceof this.ctor)&&t instanceof ME){var o=t.$type.toObject(t,e),a=t.$type.fullName[0]==="."?t.$type.fullName.slice(1):t.$type.fullName;return i===""&&(i=r),n=i+a,o["@type"]=n,o}return this.toObject(t,e)}}});var aa=S((eA,sm)=>{"use strict";sm.exports=Se;var Ht=hn();((Se.prototype=Object.create(Ht.prototype)).constructor=Se).className="Type";var IE=zt(),Au=cn(),sa=Ur(),NE=ta(),DE=ia(),xu=na(),Ou=Jo(),LE=Zo(),Xe=He(),FE=Pu(),qE=Su(),BE=Eu(),nm=Ru(),jE=ku();function Se(t,e){Ht.call(this,t,e),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}Object.defineProperties(Se.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var t=Object.keys(this.fields),e=0;e<t.length;++e){var r=this.fields[t[e]],i=r.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=Xe.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=Xe.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=Se.generateConstructor(this)())},set:function(t){var e=t.prototype;e instanceof xu||((t.prototype=new xu).constructor=t,Xe.merge(t.prototype,e)),t.$type=t.prototype.$type=this,Xe.merge(t,xu,!0),this._ctor=t;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var i={};for(r=0;r<this.oneofsArray.length;++r)i[this._oneofsArray[r].resolve().name]={get:Xe.oneOfGetter(this._oneofsArray[r].oneof),set:Xe.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(t.prototype,i)}}});Se.generateConstructor=function(e){for(var r=Xe.codegen(["p"],e.name),i=0,n;i<e.fieldsArray.length;++i)(n=e._fieldsArray[i]).map?r("this%s={}",Xe.safeProp(n.name)):n.repeated&&r("this%s=[]",Xe.safeProp(n.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")};function oa(t){return t._fieldsById=t._fieldsArray=t._oneofsArray=null,delete t.encode,delete t.decode,delete t.verify,t}Se.fromJSON=function(e,r){var i=new Se(e,r.options);i.extensions=r.extensions,i.reserved=r.reserved;for(var n=Object.keys(r.fields),s=0;s<n.length;++s)i.add((typeof r.fields[n[s]].keyType<"u"?NE.fromJSON:sa.fromJSON)(n[s],r.fields[n[s]]));if(r.oneofs)for(n=Object.keys(r.oneofs),s=0;s<n.length;++s)i.add(Au.fromJSON(n[s],r.oneofs[n[s]]));if(r.nested)for(n=Object.keys(r.nested),s=0;s<n.length;++s){var o=r.nested[n[s]];i.add((o.id!==void 0?sa.fromJSON:o.fields!==void 0?Se.fromJSON:o.values!==void 0?IE.fromJSON:o.methods!==void 0?DE.fromJSON:Ht.fromJSON)(n[s],o))}return r.extensions&&r.extensions.length&&(i.extensions=r.extensions),r.reserved&&r.reserved.length&&(i.reserved=r.reserved),r.group&&(i.group=!0),r.comment&&(i.comment=r.comment),i};Se.prototype.toJSON=function(e){var r=Ht.prototype.toJSON.call(this,e),i=e?!!e.keepComments:!1;return Xe.toObject(["options",r&&r.options||void 0,"oneofs",Ht.arrayToJSON(this.oneofsArray,e),"fields",Ht.arrayToJSON(this.fieldsArray.filter(function(n){return!n.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",r&&r.nested||void 0,"comment",i?this.comment:void 0])};Se.prototype.resolveAll=function(){for(var e=this.fieldsArray,r=0;r<e.length;)e[r++].resolve();var i=this.oneofsArray;for(r=0;r<i.length;)i[r++].resolve();return Ht.prototype.resolveAll.call(this)};Se.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null};Se.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof sa&&e.extend===void 0){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),oa(this)}return e instanceof Au?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),oa(this)):Ht.prototype.add.call(this,e)};Se.prototype.remove=function(e){if(e instanceof sa&&e.extend===void 0){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),oa(this)}if(e instanceof Au){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),oa(this)}return Ht.prototype.remove.call(this,e)};Se.prototype.isReservedId=function(e){return Ht.isReservedId(this.reserved,e)};Se.prototype.isReservedName=function(e){return Ht.isReservedName(this.reserved,e)};Se.prototype.create=function(e){return new this.ctor(e)};Se.prototype.setup=function(){for(var e=this.fullName,r=[],i=0;i<this.fieldsArray.length;++i)r.push(this._fieldsArray[i].resolve().resolvedType);this.encode=FE(this)({Writer:LE,types:r,util:Xe}),this.decode=qE(this)({Reader:Ou,types:r,util:Xe}),this.verify=BE(this)({types:r,util:Xe}),this.fromObject=nm.fromObject(this)({types:r,util:Xe}),this.toObject=nm.toObject(this)({types:r,util:Xe});var n=jE[e];if(n){var s=Object.create(this);s.fromObject=this.fromObject,this.fromObject=n.fromObject.bind(s),s.toObject=this.toObject,this.toObject=n.toObject.bind(s)}return this};Se.prototype.encode=function(e,r){return this.setup().encode(e,r)};Se.prototype.encodeDelimited=function(e,r){return this.encode(e,r&&r.len?r.fork():r).ldelim()};Se.prototype.decode=function(e,r){return this.setup().decode(e,r)};Se.prototype.decodeDelimited=function(e){return e instanceof Ou||(e=Ou.create(e)),this.decode(e,e.uint32())};Se.prototype.verify=function(e){return this.setup().verify(e)};Se.prototype.fromObject=function(e){return this.setup().fromObject(e)};Se.prototype.toObject=function(e,r){return this.setup().toObject(e,r)};Se.d=function(e){return function(i){Xe.decorateType(i,e)}}});var ua=S((tA,um)=>{"use strict";um.exports=gt;var ca=hn();((gt.prototype=Object.create(ca.prototype)).constructor=gt).className="Root";var Iu=Ur(),am=zt(),UE=cn(),Hr=He(),lm,Mu,ms;function gt(t){ca.call(this,"",t),this.deferred=[],this.files=[]}gt.fromJSON=function(e,r){return r||(r=new gt),e.options&&r.setOptions(e.options),r.addJSON(e.nested)};gt.prototype.resolvePath=Hr.path.resolve;gt.prototype.fetch=Hr.fetch;function cm(){}gt.prototype.load=function t(e,r,i){typeof r=="function"&&(i=r,r=void 0);var n=this;if(!i)return Hr.asPromise(t,n,e,r);var s=i===cm;function o(_,T){if(i){if(s)throw _;var C=i;i=null,C(_,T)}}function a(_){var T=_.lastIndexOf("google/protobuf/");if(T>-1){var C=_.substring(T);if(C in ms)return C}return null}function l(_,T){try{if(Hr.isString(T)&&T.charAt(0)==="{"&&(T=JSON.parse(T)),!Hr.isString(T))n.setOptions(T.options).addJSON(T.nested);else{Mu.filename=_;var C=Mu(T,n,r),k,M=0;if(C.imports)for(;M<C.imports.length;++M)(k=a(C.imports[M])||n.resolvePath(_,C.imports[M]))&&c(k);if(C.weakImports)for(M=0;M<C.weakImports.length;++M)(k=a(C.weakImports[M])||n.resolvePath(_,C.weakImports[M]))&&c(k,!0)}}catch(P){o(P)}!s&&!u&&o(null,n)}function c(_,T){if(_=a(_)||_,!(n.files.indexOf(_)>-1)){if(n.files.push(_),_ in ms){s?l(_,ms[_]):(++u,setTimeout(function(){--u,l(_,ms[_])}));return}if(s){var C;try{C=Hr.fs.readFileSync(_).toString("utf8")}catch(k){T||o(k);return}l(_,C)}else++u,n.fetch(_,function(k,M){if(--u,!!i){if(k){T?u||o(null,n):o(k);return}l(_,M)}})}}var u=0;Hr.isString(e)&&(e=[e]);for(var f=0,m;f<e.length;++f)(m=n.resolvePath("",e[f]))&&c(m);if(s)return n;u||o(null,n)};gt.prototype.loadSync=function(e,r){if(!Hr.isNode)throw Error("not supported");return this.load(e,r,cm)};gt.prototype.resolveAll=function(){if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return ca.prototype.resolveAll.call(this)};var la=/^[A-Z]/;function om(t,e){var r=e.parent.lookup(e.extend);if(r){var i=new Iu(e.fullName,e.id,e.type,e.rule,void 0,e.options);return r.get(i.name)||(i.declaringField=e,e.extensionField=i,r.add(i)),!0}return!1}gt.prototype._handleAdd=function(e){if(e instanceof Iu)e.extend!==void 0&&!e.extensionField&&(om(this,e)||this.deferred.push(e));else if(e instanceof am)la.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof UE)){if(e instanceof lm)for(var r=0;r<this.deferred.length;)om(this,this.deferred[r])?this.deferred.splice(r,1):++r;for(var i=0;i<e.nestedArray.length;++i)this._handleAdd(e._nestedArray[i]);la.test(e.name)&&(e.parent[e.name]=e)}};gt.prototype._handleRemove=function(e){if(e instanceof Iu){if(e.extend!==void 0)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var r=this.deferred.indexOf(e);r>-1&&this.deferred.splice(r,1)}}else if(e instanceof am)la.test(e.name)&&delete e.parent[e.name];else if(e instanceof ca){for(var i=0;i<e.nestedArray.length;++i)this._handleRemove(e._nestedArray[i]);la.test(e.name)&&delete e.parent[e.name]}};gt._configure=function(t,e,r){lm=t,Mu=e,ms=r}});var He=S((rA,hm)=>{"use strict";var Ie=hm.exports=er(),dm=uu(),Nu,Du;Ie.codegen=Ag();Ie.fetch=Mg();Ie.path=Dg();Ie.fs=Ie.inquire("fs");Ie.toArray=function(e){if(e){for(var r=Object.keys(e),i=new Array(r.length),n=0;n<r.length;)i[n]=e[r[n++]];return i}return[]};Ie.toObject=function(e){for(var r={},i=0;i<e.length;){var n=e[i++],s=e[i++];s!==void 0&&(r[n]=s)}return r};var zE=/\\/g,HE=/"/g;Ie.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)};Ie.safeProp=function(e){return!/^[$\w_]+$/.test(e)||Ie.isReserved(e)?'["'+e.replace(zE,"\\\\").replace(HE,'\\"')+'"]':"."+e};Ie.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var WE=/_([a-z])/g;Ie.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(WE,function(r,i){return i.toUpperCase()})};Ie.compareFieldsById=function(e,r){return e.id-r.id};Ie.decorateType=function(e,r){if(e.$type)return r&&e.$type.name!==r&&(Ie.decorateRoot.remove(e.$type),e.$type.name=r,Ie.decorateRoot.add(e.$type)),e.$type;Nu||(Nu=aa());var i=new Nu(r||e.name);return Ie.decorateRoot.add(i),i.ctor=e,Object.defineProperty(e,"$type",{value:i,enumerable:!1}),Object.defineProperty(e.prototype,"$type",{value:i,enumerable:!1}),i};var $E=0;Ie.decorateEnum=function(e){if(e.$type)return e.$type;Du||(Du=zt());var r=new Du("Enum"+$E++,e);return Ie.decorateRoot.add(r),Object.defineProperty(e,"$type",{value:r,enumerable:!1}),r};Ie.setProperty=function(e,r,i){function n(s,o,a){var l=o.shift();if(l==="__proto__"||l==="prototype")return s;if(o.length>0)s[l]=n(s[l]||{},o,a);else{var c=s[l];c&&(a=[].concat(c).concat(a)),s[l]=a}return s}if(typeof e!="object")throw TypeError("dst must be an object");if(!r)throw TypeError("path must be specified");return r=r.split("."),n(e,r,i)};Object.defineProperty(Ie,"decorateRoot",{get:function(){return dm.decorated||(dm.decorated=new(ua()))}})});var wi=S((iA,fm)=>{"use strict";fm.exports=mt;mt.className="ReflectionObject";var da=He(),ha;function mt(t,e){if(!da.isString(t))throw TypeError("name must be a string");if(e&&!da.isObject(e))throw TypeError("options must be an object");this.options=e,this.parsedOptions=null,this.name=t,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(mt.prototype,{root:{get:function(){for(var t=this;t.parent!==null;)t=t.parent;return t}},fullName:{get:function(){for(var t=[this.name],e=this.parent;e;)t.unshift(e.name),e=e.parent;return t.join(".")}}});mt.prototype.toJSON=function(){throw Error()};mt.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var r=e.root;r instanceof ha&&r._handleAdd(this)};mt.prototype.onRemove=function(e){var r=e.root;r instanceof ha&&r._handleRemove(this),this.parent=null,this.resolved=!1};mt.prototype.resolve=function(){return this.resolved?this:(this.root instanceof ha&&(this.resolved=!0),this)};mt.prototype.getOption=function(e){if(this.options)return this.options[e]};mt.prototype.setOption=function(e,r,i){return(!i||!this.options||this.options[e]===void 0)&&((this.options||(this.options={}))[e]=r),this};mt.prototype.setParsedOption=function(e,r,i){this.parsedOptions||(this.parsedOptions=[]);var n=this.parsedOptions;if(i){var s=n.find(function(l){return Object.prototype.hasOwnProperty.call(l,e)});if(s){var o=s[e];da.setProperty(o,i,r)}else s={},s[e]=da.setProperty({},i,r),n.push(s)}else{var a={};a[e]=r,n.push(a)}return this};mt.prototype.setOptions=function(e,r){if(e)for(var i=Object.keys(e),n=0;n<i.length;++n)this.setOption(i[n],e[i[n]],r);return this};mt.prototype.toString=function(){var e=this.constructor.className,r=this.fullName;return r.length?e+" "+r:e};mt._configure=function(t){ha=t}});var zt=S((nA,mm)=>{"use strict";mm.exports=nr;var pm=wi();((nr.prototype=Object.create(pm.prototype)).constructor=nr).className="Enum";var gm=hn(),fa=He();function nr(t,e,r,i,n,s){if(pm.call(this,t,r),e&&typeof e!="object")throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=i,this.comments=n||{},this.valuesOptions=s,this.reserved=void 0,e)for(var o=Object.keys(e),a=0;a<o.length;++a)typeof e[o[a]]=="number"&&(this.valuesById[this.values[o[a]]=e[o[a]]]=o[a])}nr.fromJSON=function(e,r){var i=new nr(e,r.values,r.options,r.comment,r.comments);return i.reserved=r.reserved,i};nr.prototype.toJSON=function(e){var r=e?!!e.keepComments:!1;return fa.toObject(["options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",r?this.comment:void 0,"comments",r?this.comments:void 0])};nr.prototype.add=function(e,r,i,n){if(!fa.isString(e))throw TypeError("name must be a string");if(!fa.isInteger(r))throw TypeError("id must be an integer");if(this.values[e]!==void 0)throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(r))throw Error("id "+r+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(this.valuesById[r]!==void 0){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+r+" in "+this);this.values[e]=r}else this.valuesById[this.values[e]=r]=e;return n&&(this.valuesOptions===void 0&&(this.valuesOptions={}),this.valuesOptions[e]=n||null),this.comments[e]=i||null,this};nr.prototype.remove=function(e){if(!fa.isString(e))throw TypeError("name must be a string");var r=this.values[e];if(r==null)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[r],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this};nr.prototype.isReservedId=function(e){return gm.isReservedId(this.reserved,e)};nr.prototype.isReservedName=function(e){return gm.isReservedName(this.reserved,e)}});var Pu=S((sA,vm)=>{"use strict";vm.exports=GE;var VE=zt(),Lu=Ti(),Fu=He();function ym(t,e,r,i){return e.resolvedType.group?t("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,i,(e.id<<3|3)>>>0,(e.id<<3|4)>>>0):t("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,i,(e.id<<3|2)>>>0)}function GE(t){for(var e=Fu.codegen(["m","w"],t.name+"$encode")("if(!w)")("w=Writer.create()"),r,i,n=t.fieldsArray.slice().sort(Fu.compareFieldsById),r=0;r<n.length;++r){var s=n[r].resolve(),o=t._fieldsArray.indexOf(s),a=s.resolvedType instanceof VE?"int32":s.type,l=Lu.basic[a];i="m"+Fu.safeProp(s.name),s.map?(e("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",i,s.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",i)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(s.id<<3|2)>>>0,8|Lu.mapKey[s.keyType],s.keyType),l===void 0?e("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",o,i):e(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|l,a,i),e("}")("}")):s.repeated?(e("if(%s!=null&&%s.length){",i,i),s.packed&&Lu.packed[a]!==void 0?e("w.uint32(%i).fork()",(s.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",i)("w.%s(%s[i])",a,i)("w.ldelim()"):(e("for(var i=0;i<%s.length;++i)",i),l===void 0?ym(e,s,o,i+"[i]"):e("w.uint32(%i).%s(%s[i])",(s.id<<3|l)>>>0,a,i)),e("}")):(s.optional&&e("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",i,s.name),l===void 0?ym(e,s,o,i):e("w.uint32(%i).%s(%s)",(s.id<<3|l)>>>0,a,i))}return e("return w")}});var Sm=S((oA,_m)=>{"use strict";var le=_m.exports=xg();le.build="light";function ZE(t,e,r){return typeof e=="function"?(r=e,e=new le.Root):e||(e=new le.Root),e.load(t,r)}le.load=ZE;function YE(t,e){return e||(e=new le.Root),e.loadSync(t)}le.loadSync=YE;le.encoder=Pu();le.decoder=Su();le.verifier=Eu();le.converter=Ru();le.ReflectionObject=wi();le.Namespace=hn();le.Root=ua();le.Enum=zt();le.Type=aa();le.Field=Ur();le.OneOf=cn();le.MapField=ta();le.Service=ia();le.Method=ra();le.Message=na();le.wrappers=ku();le.types=Ti();le.util=He();le.ReflectionObject._configure(le.Root);le.Namespace._configure(le.Type,le.Service,le.Enum);le.Root._configure(le.Type);le.Field._configure(le.Type)});var Bu=S((aA,Em)=>{"use strict";Em.exports=bm;var qu=/[\s{}=;:[\],'"()<>]/g,JE=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,KE=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,XE=/^ *[*/]+ */,QE=/^\s*\*?\/*/,eT=/\n/g,tT=/\s/,rT=/\\(.?)/g,iT={0:"\0",r:"\r",n:`
`,t:"	"};function Cm(t){return t.replace(rT,function(e,r){switch(r){case"\\":case"":return r;default:return iT[r]||""}})}bm.unescape=Cm;function bm(t,e){t=t.toString();var r=0,i=t.length,n=1,s=0,o={},a=[],l=null;function c(j){return Error("illegal "+j+" (line "+n+")")}function u(){var j=l==="'"?KE:JE;j.lastIndex=r-1;var re=j.exec(t);if(!re)throw c("string");return r=j.lastIndex,k(l),l=null,Cm(re[1])}function f(j){return t.charAt(j)}function m(j,re,J){var oe={type:t.charAt(j++),lineEmpty:!1,leading:J},be;e?be=2:be=3;var Ae=j-be,fe;do if(--Ae<0||(fe=t.charAt(Ae))===`
`){oe.lineEmpty=!0;break}while(fe===" "||fe==="	");for(var b=t.substring(j,re).split(eT),Re=0;Re<b.length;++Re)b[Re]=b[Re].replace(e?QE:XE,"").trim();oe.text=b.join(`
`).trim(),o[n]=oe,s=n}function _(j){var re=T(j),J=t.substring(j,re),oe=/^\s*\/\//.test(J);return oe}function T(j){for(var re=j;re<i&&f(re)!==`
`;)re++;return re}function C(){if(a.length>0)return a.shift();if(l)return u();var j,re,J,oe,be,Ae=r===0;do{if(r===i)return null;for(j=!1;tT.test(J=f(r));)if(J===`
`&&(Ae=!0,++n),++r===i)return null;if(f(r)==="/"){if(++r===i)throw c("comment");if(f(r)==="/")if(e){if(oe=r,be=!1,_(r-1)){be=!0;do if(r=T(r),r===i||(r++,!Ae))break;while(_(r))}else r=Math.min(i,T(r)+1);be&&(m(oe,r,Ae),Ae=!0),n++,j=!0}else{for(be=f(oe=r+1)==="/";f(++r)!==`
`;)if(r===i)return null;++r,be&&(m(oe,r-1,Ae),Ae=!0),++n,j=!0}else if((J=f(r))==="*"){oe=r+1,be=e||f(oe)==="*";do{if(J===`
`&&++n,++r===i)throw c("comment");re=J,J=f(r)}while(re!=="*"||J!=="/");++r,be&&(m(oe,r-2,Ae),Ae=!0),j=!0}else return"/"}}while(j);var fe=r;qu.lastIndex=0;var b=qu.test(f(fe++));if(!b)for(;fe<i&&!qu.test(f(fe));)++fe;var Re=t.substring(r,r=fe);return(Re==='"'||Re==="'")&&(l=Re),Re}function k(j){a.push(j)}function M(){if(!a.length){var j=C();if(j===null)return null;k(j)}return a[0]}function P(j,re){var J=M(),oe=J===j;if(oe)return C(),!0;if(!re)throw c("token '"+J+"', '"+j+"' expected");return!1}function X(j){var re=null,J;return j===void 0?(J=o[n-1],delete o[n-1],J&&(e||J.type==="*"||J.lineEmpty)&&(re=J.leading?J.text:null)):(s<j&&M(),J=o[j],delete o[j],J&&!J.lineEmpty&&(e||J.type==="/")&&(re=J.leading?null:J.text)),re}return Object.defineProperty({next:C,peek:M,push:k,skip:P,cmnt:X},"line",{get:function(){return n}})}});var Om=S((lA,xm)=>{"use strict";xm.exports=br;br.filename=null;br.defaults={keepCase:!1};var nT=Bu(),Tm=ua(),wm=aa(),Rm=Ur(),sT=ta(),km=cn(),oT=zt(),aT=ia(),lT=ra(),ju=Ti(),Uu=He(),cT=/^[1-9][0-9]*$/,uT=/^-?[1-9][0-9]*$/,dT=/^0[x][0-9a-fA-F]+$/,hT=/^-?0[x][0-9a-fA-F]+$/,fT=/^0[0-7]+$/,pT=/^-?0[0-7]+$/,gT=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,sr=/^[a-zA-Z_][a-zA-Z_0-9]*$/,or=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/,mT=/^(?:\.[a-zA-Z_][a-zA-Z_0-9]*)+$/;function br(t,e,r){e instanceof Tm||(r=e,e=new Tm),r||(r=br.defaults);var i=r.preferTrailingComment||!1,n=nT(t,r.alternateCommentMode||!1),s=n.next,o=n.push,a=n.peek,l=n.skip,c=n.cmnt,u=!0,f,m,_,T,C=!1,k=e,M=r.keepCase?function(w){return w}:Uu.camelCase;function P(w,R,N){var $=br.filename;return N||(br.filename=null),Error("illegal "+(R||"token")+" '"+w+"' ("+($?$+", ":"")+"line "+n.line+")")}function X(){var w=[],R;do{if((R=s())!=='"'&&R!=="'")throw P(R);w.push(s()),l(R),R=a()}while(R==='"'||R==="'");return w.join("")}function j(w){var R=s();switch(R){case"'":case'"':return o(R),X();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return J(R,!0)}catch{if(w&&or.test(R))return R;throw P(R,"value")}}function re(w,R){var N,$;do R&&((N=a())==='"'||N==="'")?w.push(X()):w.push([$=oe(s()),l("to",!0)?oe(s()):$]);while(l(",",!0));var z={options:void 0};z.setOption=function(te,Ee){this.options===void 0&&(this.options={}),this.options[te]=Ee},Re(z,function(Ee){if(Ee==="option")ve(z,Ee),l(";");else throw P(Ee)},function(){Ge(z)})}function J(w,R){var N=1;switch(w.charAt(0)==="-"&&(N=-1,w=w.substring(1)),w){case"inf":case"INF":case"Inf":return N*(1/0);case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(cT.test(w))return N*parseInt(w,10);if(dT.test(w))return N*parseInt(w,16);if(fT.test(w))return N*parseInt(w,8);if(gT.test(w))return N*parseFloat(w);throw P(w,"number",R)}function oe(w,R){switch(w){case"max":case"MAX":case"Max":return 536870911;case"0":return 0}if(!R&&w.charAt(0)==="-")throw P(w,"id");if(uT.test(w))return parseInt(w,10);if(hT.test(w))return parseInt(w,16);if(pT.test(w))return parseInt(w,8);throw P(w,"id")}function be(){if(f!==void 0)throw P("package");if(f=s(),!or.test(f))throw P(f,"name");k=k.define(f),l(";")}function Ae(){var w=a(),R;switch(w){case"weak":R=_||(_=[]),s();break;case"public":s();default:R=m||(m=[]);break}w=X(),l(";"),R.push(w)}function fe(){if(l("="),T=X(),C=T==="proto3",!C&&T!=="proto2")throw P(T,"syntax");e.setOption("syntax",T),l(";")}function b(w,R){switch(R){case"option":return ve(w,R),l(";"),!0;case"message":return E(w,R),!0;case"enum":return pe(w,R),!0;case"service":return Le(w,R),!0;case"extend":return zi(w,R),!0}return!1}function Re(w,R,N){var $=n.line;if(w&&(typeof w.comment!="string"&&(w.comment=c()),w.filename=br.filename),l("{",!0)){for(var z;(z=s())!=="}";)R(z);l(";",!0)}else N&&N(),l(";"),w&&(typeof w.comment!="string"||i)&&(w.comment=c($)||w.comment)}function E(w,R){if(!sr.test(R=s()))throw P(R,"type name");var N=new wm(R);Re(N,function(z){if(!b(N,z))switch(z){case"map":se(N,z);break;case"required":case"repeated":h(N,z);break;case"optional":C?h(N,"proto3_optional"):h(N,"optional");break;case"oneof":ye(N,z);break;case"extensions":re(N.extensions||(N.extensions=[]));break;case"reserved":re(N.reserved||(N.reserved=[]),!0);break;default:if(!C||!or.test(z))throw P(z);o(z),h(N,"optional");break}}),w.add(N)}function h(w,R,N){var $=s();if($==="group"){I(w,R);return}for(;$.endsWith(".")||a().startsWith(".");)$+=s();if(!or.test($))throw P($,"type");var z=s();if(!sr.test(z))throw P(z,"name");z=M(z),l("=");var te=new Rm(z,oe(s()),$,R,N);if(Re(te,function(ut){if(ut==="option")ve(te,ut),l(";");else throw P(ut)},function(){Ge(te)}),R==="proto3_optional"){var Ee=new km("_"+z);te.setOption("proto3_optional",!0),Ee.add(te),w.add(Ee)}else w.add(te);!C&&te.repeated&&(ju.packed[$]!==void 0||ju.basic[$]===void 0)&&te.setOption("packed",!1,!0)}function I(w,R){var N=s();if(!sr.test(N))throw P(N,"name");var $=Uu.lcFirst(N);N===$&&(N=Uu.ucFirst(N)),l("=");var z=oe(s()),te=new wm(N);te.group=!0;var Ee=new Rm($,z,N,R);Ee.filename=br.filename,Re(te,function(ut){switch(ut){case"option":ve(te,ut),l(";");break;case"required":case"repeated":h(te,ut);break;case"optional":C?h(te,"proto3_optional"):h(te,"optional");break;case"message":E(te,ut);break;case"enum":pe(te,ut);break;default:throw P(ut)}}),w.add(te).add(Ee)}function se(w){l("<");var R=s();if(ju.mapKey[R]===void 0)throw P(R,"type");l(",");var N=s();if(!or.test(N))throw P(N,"type");l(">");var $=s();if(!sr.test($))throw P($,"name");l("=");var z=new sT(M($),oe(s()),R,N);Re(z,function(Ee){if(Ee==="option")ve(z,Ee),l(";");else throw P(Ee)},function(){Ge(z)}),w.add(z)}function ye(w,R){if(!sr.test(R=s()))throw P(R,"name");var N=new km(M(R));Re(N,function(z){z==="option"?(ve(N,z),l(";")):(o(z),h(N,"optional"))}),w.add(N)}function pe(w,R){if(!sr.test(R=s()))throw P(R,"name");var N=new oT(R);Re(N,function(z){switch(z){case"option":ve(N,z),l(";");break;case"reserved":re(N.reserved||(N.reserved=[]),!0);break;default:Pe(N,z)}}),w.add(N)}function Pe(w,R){if(!sr.test(R))throw P(R,"name");l("=");var N=oe(s(),!0),$={options:void 0};$.setOption=function(z,te){this.options===void 0&&(this.options={}),this.options[z]=te},Re($,function(te){if(te==="option")ve($,te),l(";");else throw P(te)},function(){Ge($)}),w.add(R,N,$.comment,$.options)}function ve(w,R){var N=l("(",!0);if(!or.test(R=s()))throw P(R,"name");var $=R,z=$,te;N&&(l(")"),$="("+$+")",z=$,R=a(),mT.test(R)&&(te=R.slice(1),$+=R,s())),l("=");var Ee=Qe(w,$);ke(w,z,Ee,te)}function Qe(w,R){if(l("{",!0)){for(var N={};!l("}",!0);){if(!sr.test(Ye=s()))throw P(Ye,"name");if(Ye===null)throw P(Ye,"end of input");var $,z=Ye;if(l(":",!0),a()==="{")$=Qe(w,R+"."+Ye);else if(a()==="["){$=[];var te;if(l("[",!0)){do te=j(!0),$.push(te);while(l(",",!0));l("]"),typeof te<"u"&&De(w,R+"."+Ye,te)}}else $=j(!0),De(w,R+"."+Ye,$);var Ee=N[z];Ee&&($=[].concat(Ee).concat($)),N[z]=$,l(",",!0),l(";",!0)}return N}var Ar=j(!0);return De(w,R,Ar),Ar}function De(w,R,N){w.setOption&&w.setOption(R,N)}function ke(w,R,N,$){w.setParsedOption&&w.setParsedOption(R,N,$)}function Ge(w){if(l("[",!0)){do ve(w,"option");while(l(",",!0));l("]")}return w}function Le(w,R){if(!sr.test(R=s()))throw P(R,"service name");var N=new aT(R);Re(N,function(z){if(!b(N,z))if(z==="rpc")et(N,z);else throw P(z)}),w.add(N)}function et(w,R){var N=c(),$=R;if(!sr.test(R=s()))throw P(R,"name");var z=R,te,Ee,Ar,ut;if(l("("),l("stream",!0)&&(Ee=!0),!or.test(R=s())||(te=R,l(")"),l("returns"),l("("),l("stream",!0)&&(ut=!0),!or.test(R=s())))throw P(R);Ar=R,l(")");var Ys=new lT(z,$,te,Ar,Ee,ut);Ys.comment=N,Re(Ys,function(Ol){if(Ol==="option")ve(Ys,Ol),l(";");else throw P(Ol)}),w.add(Ys)}function zi(w,R){if(!or.test(R=s()))throw P(R,"reference");var N=R;Re(null,function(z){switch(z){case"required":case"repeated":h(w,z,N);break;case"optional":C?h(w,"proto3_optional",N):h(w,"optional",N);break;default:if(!C||!or.test(z))throw P(z);o(z),h(w,"optional",N);break}})}for(var Ye;(Ye=s())!==null;)switch(Ye){case"package":if(!u)throw P(Ye);be();break;case"import":if(!u)throw P(Ye);Ae();break;case"syntax":if(!u)throw P(Ye);fe();break;case"option":ve(k,Ye),l(";");break;default:if(b(k,Ye)){u=!1;continue}throw P(Ye)}return br.filename=null,{package:f,imports:m,weakImports:_,syntax:T,root:e}}});var Mm=S((cA,Pm)=>{"use strict";Pm.exports=Wt;var yT=/\/|\./;function Wt(t,e){yT.test(t)||(t="google/protobuf/"+t+".proto",e={nested:{google:{nested:{protobuf:{nested:e}}}}}),Wt[t]=e}Wt("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}});var Am;Wt("duration",{Duration:Am={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}});Wt("timestamp",{Timestamp:Am});Wt("empty",{Empty:{fields:{}}});Wt("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}});Wt("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}});Wt("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}});Wt.get=function(e){return Wt[e]||null}});var Nm=S((uA,Im)=>{"use strict";var Wr=Im.exports=Sm();Wr.build="full";Wr.tokenize=Bu();Wr.parse=Om();Wr.common=Mm();Wr.Root._configure(Wr.Type,Wr.parse,Wr.common)});var pa=S((dA,Dm)=>{"use strict";Dm.exports=Nm()});var zu=S((hA,vT)=>{vT.exports={nested:{google:{nested:{protobuf:{nested:{FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,536870911]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}}}}}}}}});var jm=S((ie,Bm)=>{"use strict";var rt=pa();Bm.exports=ie=rt.descriptor=rt.Root.fromJSON(zu()).lookup(".google.protobuf");var Lm=rt.Namespace,ys=rt.Root,Er=rt.Enum,$r=rt.Type,Vr=rt.Field,_T=rt.MapField,ga=rt.OneOf,vs=rt.Service,ma=rt.Method;ys.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.FileDescriptorSet.decode(e));var r=new ys;if(e.file)for(var i,n,s=0,o;s<e.file.length;++s){if(n=r,(i=e.file[s]).package&&i.package.length&&(n=r.define(i.package)),i.name&&i.name.length&&r.files.push(n.filename=i.name),i.messageType)for(o=0;o<i.messageType.length;++o)n.add($r.fromDescriptor(i.messageType[o],i.syntax));if(i.enumType)for(o=0;o<i.enumType.length;++o)n.add(Er.fromDescriptor(i.enumType[o]));if(i.extension)for(o=0;o<i.extension.length;++o)n.add(Vr.fromDescriptor(i.extension[o]));if(i.service)for(o=0;o<i.service.length;++o)n.add(vs.fromDescriptor(i.service[o]));var a=pn(i.options,ie.FileOptions);if(a){var l=Object.keys(a);for(o=0;o<l.length;++o)n.setOption(l[o],a[l[o]])}}return r};ys.prototype.toDescriptor=function(e){var r=ie.FileDescriptorSet.create();return Fm(this,r.file,e),r};function Fm(t,e,r){var i=ie.FileDescriptorProto.create({name:t.filename||(t.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});r&&(i.syntax=r),t instanceof ys||(i.package=t.fullName.substring(1));for(var n=0,s;n<t.nestedArray.length;++n)(s=t._nestedArray[n])instanceof $r?i.messageType.push(s.toDescriptor(r)):s instanceof Er?i.enumType.push(s.toDescriptor()):s instanceof Vr?i.extension.push(s.toDescriptor(r)):s instanceof vs?i.service.push(s.toDescriptor()):s instanceof Lm&&Fm(s,e,r);i.options=gn(t.options,ie.FileOptions),i.messageType.length+i.enumType.length+i.extension.length+i.service.length&&e.push(i)}var ST=0;$r.fromDescriptor=function(e,r){typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e));var i=new $r(e.name.length?e.name:"Type"+ST++,pn(e.options,ie.MessageOptions)),n;if(e.oneofDecl)for(n=0;n<e.oneofDecl.length;++n)i.add(ga.fromDescriptor(e.oneofDecl[n]));if(e.field)for(n=0;n<e.field.length;++n){var s=Vr.fromDescriptor(e.field[n],r);i.add(s),e.field[n].hasOwnProperty("oneofIndex")&&i.oneofsArray[e.field[n].oneofIndex].add(s)}if(e.extension)for(n=0;n<e.extension.length;++n)i.add(Vr.fromDescriptor(e.extension[n],r));if(e.nestedType)for(n=0;n<e.nestedType.length;++n)i.add($r.fromDescriptor(e.nestedType[n],r)),e.nestedType[n].options&&e.nestedType[n].options.mapEntry&&i.setOption("map_entry",!0);if(e.enumType)for(n=0;n<e.enumType.length;++n)i.add(Er.fromDescriptor(e.enumType[n]));if(e.extensionRange&&e.extensionRange.length)for(i.extensions=[],n=0;n<e.extensionRange.length;++n)i.extensions.push([e.extensionRange[n].start,e.extensionRange[n].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(i.reserved=[],e.reservedRange)for(n=0;n<e.reservedRange.length;++n)i.reserved.push([e.reservedRange[n].start,e.reservedRange[n].end]);if(e.reservedName)for(n=0;n<e.reservedName.length;++n)i.reserved.push(e.reservedName[n])}return i};$r.prototype.toDescriptor=function(e){var r=ie.DescriptorProto.create({name:this.name}),i;for(i=0;i<this.fieldsArray.length;++i){var n;if(r.field.push(n=this._fieldsArray[i].toDescriptor(e)),this._fieldsArray[i]instanceof _T){var s=Hu(this._fieldsArray[i].keyType,this._fieldsArray[i].resolvedKeyType),o=Hu(this._fieldsArray[i].type,this._fieldsArray[i].resolvedType),a=o===11||o===14?this._fieldsArray[i].resolvedType&&qm(this.parent,this._fieldsArray[i].resolvedType)||this._fieldsArray[i].type:void 0;r.nestedType.push(ie.DescriptorProto.create({name:n.typeName,field:[ie.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),ie.FieldDescriptorProto.create({name:"value",number:2,label:1,type:o,typeName:a})],options:ie.MessageOptions.create({mapEntry:!0})}))}}for(i=0;i<this.oneofsArray.length;++i)r.oneofDecl.push(this._oneofsArray[i].toDescriptor());for(i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof Vr?r.field.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof $r?r.nestedType.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof Er&&r.enumType.push(this._nestedArray[i].toDescriptor());if(this.extensions)for(i=0;i<this.extensions.length;++i)r.extensionRange.push(ie.DescriptorProto.ExtensionRange.create({start:this.extensions[i][0],end:this.extensions[i][1]}));if(this.reserved)for(i=0;i<this.reserved.length;++i)typeof this.reserved[i]=="string"?r.reservedName.push(this.reserved[i]):r.reservedRange.push(ie.DescriptorProto.ReservedRange.create({start:this.reserved[i][0],end:this.reserved[i][1]}));return r.options=gn(this.options,ie.MessageOptions),r};var CT=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;Vr.fromDescriptor=function(e,r){if(typeof e.length=="number"&&(e=ie.DescriptorProto.decode(e)),typeof e.number!="number")throw Error("missing field id");var i;e.typeName&&e.typeName.length?i=e.typeName:i=RT(e.type);var n;switch(e.label){case 1:n=void 0;break;case 2:n="required";break;case 3:n="repeated";break;default:throw Error("illegal label: "+e.label)}var s=e.extendee;e.extendee!==void 0&&(s=s.length?s:void 0);var o=new Vr(e.name.length?e.name:"field"+e.number,e.number,i,n,s);if(o.options=pn(e.options,ie.FieldOptions),e.defaultValue&&e.defaultValue.length){var a=e.defaultValue;switch(a){case"true":case"TRUE":a=!0;break;case"false":case"FALSE":a=!1;break;default:var l=CT.exec(a);l&&(a=parseInt(a));break}o.setOption("default",a)}return kT(e.type)&&(r==="proto3"?e.options&&!e.options.packed&&o.setOption("packed",!1):e.options&&e.options.packed||o.setOption("packed",!1)),o};Vr.prototype.toDescriptor=function(e){var r=ie.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)r.type=11,r.typeName=rt.util.ucFirst(this.name),r.label=3;else{switch(r.type=Hu(this.type,this.resolve().resolvedType)){case 10:case 11:case 14:r.typeName=this.resolvedType?qm(this.parent,this.resolvedType):this.type;break}switch(this.rule){case"repeated":r.label=3;break;case"required":r.label=2;break;default:r.label=1;break}}if(r.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(r.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(r.options=gn(this.options,ie.FieldOptions),this.options.default!=null&&(r.defaultValue=String(this.options.default))),e==="proto3"?this.packed||((r.options||(r.options=ie.FieldOptions.create())).packed=!1):this.packed&&((r.options||(r.options=ie.FieldOptions.create())).packed=!0),r};var bT=0;Er.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.EnumDescriptorProto.decode(e));var r={};if(e.value)for(var i=0;i<e.value.length;++i){var n=e.value[i].name,s=e.value[i].number||0;r[n&&n.length?n:"NAME"+s]=s}return new Er(e.name&&e.name.length?e.name:"Enum"+bT++,r,pn(e.options,ie.EnumOptions))};Er.prototype.toDescriptor=function(){for(var e=[],r=0,i=Object.keys(this.values);r<i.length;++r)e.push(ie.EnumValueDescriptorProto.create({name:i[r],number:this.values[i[r]]}));return ie.EnumDescriptorProto.create({name:this.name,value:e,options:gn(this.options,ie.EnumOptions)})};var ET=0;ga.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.OneofDescriptorProto.decode(e)),new ga(e.name&&e.name.length?e.name:"oneof"+ET++)};ga.prototype.toDescriptor=function(){return ie.OneofDescriptorProto.create({name:this.name})};var TT=0;vs.fromDescriptor=function(e){typeof e.length=="number"&&(e=ie.ServiceDescriptorProto.decode(e));var r=new vs(e.name&&e.name.length?e.name:"Service"+TT++,pn(e.options,ie.ServiceOptions));if(e.method)for(var i=0;i<e.method.length;++i)r.add(ma.fromDescriptor(e.method[i]));return r};vs.prototype.toDescriptor=function(){for(var e=[],r=0;r<this.methodsArray.length;++r)e.push(this._methodsArray[r].toDescriptor());return ie.ServiceDescriptorProto.create({name:this.name,method:e,options:gn(this.options,ie.ServiceOptions)})};var wT=0;ma.fromDescriptor=function(e){return typeof e.length=="number"&&(e=ie.MethodDescriptorProto.decode(e)),new ma(e.name&&e.name.length?e.name:"Method"+wT++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,pn(e.options,ie.MethodOptions))};ma.prototype.toDescriptor=function(){return ie.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:gn(this.options,ie.MethodOptions)})};function RT(t){switch(t){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+t)}function kT(t){switch(t){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function Hu(t,e){switch(t){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(e instanceof Er)return 14;if(e instanceof $r)return e.group?10:11;throw Error("illegal type: "+t)}function pn(t,e){if(t){for(var r=[],i=0,n,s,o;i<e.fieldsArray.length;++i)(s=(n=e._fieldsArray[i]).name)!=="uninterpretedOption"&&t.hasOwnProperty(s)&&(o=t[s],n.resolvedType instanceof Er&&typeof o=="number"&&n.resolvedType.valuesById[o]!==void 0&&(o=n.resolvedType.valuesById[o]),r.push(xT(s),o));return r.length?rt.util.toObject(r):void 0}}function gn(t,e){if(t){for(var r=[],i=0,n=Object.keys(t),s,o;i<n.length;++i)if(o=t[s=n[i]],s!=="default"){var a=e.fields[s];!a&&!(a=e.fields[s=rt.util.camelCase(s)])||r.push(s,o)}return r.length?e.fromObject(rt.util.toObject(r)):void 0}}function qm(t,e){var r=t.fullName.split("."),i=e.fullName.split("."),n=0,s=0,o=i.length-1;if(!(t instanceof ys)&&e instanceof Lm)for(;n<r.length&&s<o&&r[n]===i[s];){var a=e.lookup(r[n++],!0);if(a!==null&&a!==e)break;++s}else for(;n<r.length&&s<o&&r[n]===i[s];++n,++s);return i.slice(s).join(".")}function xT(t){return t.substring(0,1)+t.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,r){return"_"+r.toLowerCase()})}});var Um=S((fA,OT)=>{OT.exports={nested:{google:{nested:{protobuf:{nested:{Api:{fields:{name:{type:"string",id:1},methods:{rule:"repeated",type:"Method",id:2},options:{rule:"repeated",type:"Option",id:3},version:{type:"string",id:4},sourceContext:{type:"SourceContext",id:5},mixins:{rule:"repeated",type:"Mixin",id:6},syntax:{type:"Syntax",id:7}}},Method:{fields:{name:{type:"string",id:1},requestTypeUrl:{type:"string",id:2},requestStreaming:{type:"bool",id:3},responseTypeUrl:{type:"string",id:4},responseStreaming:{type:"bool",id:5},options:{rule:"repeated",type:"Option",id:6},syntax:{type:"Syntax",id:7}}},Mixin:{fields:{name:{type:"string",id:1},root:{type:"string",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}}}}}}}}});var zm=S((pA,AT)=>{AT.exports={nested:{google:{nested:{protobuf:{nested:{SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Hm=S((gA,PT)=>{PT.exports={nested:{google:{nested:{protobuf:{nested:{Type:{fields:{name:{type:"string",id:1},fields:{rule:"repeated",type:"Field",id:2},oneofs:{rule:"repeated",type:"string",id:3},options:{rule:"repeated",type:"Option",id:4},sourceContext:{type:"SourceContext",id:5},syntax:{type:"Syntax",id:6}}},Field:{fields:{kind:{type:"Kind",id:1},cardinality:{type:"Cardinality",id:2},number:{type:"int32",id:3},name:{type:"string",id:4},typeUrl:{type:"string",id:6},oneofIndex:{type:"int32",id:7},packed:{type:"bool",id:8},options:{rule:"repeated",type:"Option",id:9},jsonName:{type:"string",id:10},defaultValue:{type:"string",id:11}},nested:{Kind:{values:{TYPE_UNKNOWN:0,TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Cardinality:{values:{CARDINALITY_UNKNOWN:0,CARDINALITY_OPTIONAL:1,CARDINALITY_REQUIRED:2,CARDINALITY_REPEATED:3}}}},Enum:{fields:{name:{type:"string",id:1},enumvalue:{rule:"repeated",type:"EnumValue",id:2},options:{rule:"repeated",type:"Option",id:3},sourceContext:{type:"SourceContext",id:4},syntax:{type:"Syntax",id:5}}},EnumValue:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{rule:"repeated",type:"Option",id:3}}},Option:{fields:{name:{type:"string",id:1},value:{type:"Any",id:2}}},Syntax:{values:{SYNTAX_PROTO2:0,SYNTAX_PROTO3:1}},Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}},SourceContext:{fields:{fileName:{type:"string",id:1}}}}}}}}}});var Gm=S(Gr=>{"use strict";Object.defineProperty(Gr,"__esModule",{value:!0});Gr.addCommonProtos=Gr.loadProtosWithOptionsSync=Gr.loadProtosWithOptions=void 0;var Wm=require("fs"),$m=require("path"),mn=pa();function Vm(t,e){let r=t.resolvePath;t.resolvePath=(i,n)=>{if($m.isAbsolute(n))return n;for(let s of e){let o=$m.join(s,n);try{return Wm.accessSync(o,Wm.constants.R_OK),o}catch{continue}}return process.emitWarning(`${n} not found in any of the include paths ${e}`),r(i,n)}}async function MT(t,e){let r=new mn.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))return Promise.reject(new Error("The includeDirs option must be an array"));Vm(r,e.includeDirs)}let i=await r.load(t,e);return i.resolveAll(),i}Gr.loadProtosWithOptions=MT;function IT(t,e){let r=new mn.Root;if(e=e||{},e.includeDirs){if(!Array.isArray(e.includeDirs))throw new Error("The includeDirs option must be an array");Vm(r,e.includeDirs)}let i=r.loadSync(t,e);return i.resolveAll(),i}Gr.loadProtosWithOptionsSync=IT;function NT(){let t=Um(),e=zu(),r=zm(),i=Hm();mn.common("api",t.nested.google.nested.protobuf.nested),mn.common("descriptor",e.nested.google.nested.protobuf.nested),mn.common("source_context",r.nested.google.nested.protobuf.nested),mn.common("type",i.nested.google.nested.protobuf.nested)}Gr.addCommonProtos=NT});var Zm=S((_s,Wu)=>{(function(t,e){function r(i){return"default"in i?i.default:i}typeof define=="function"&&define.amd?define([],function(){var i={};return e(i),r(i)}):typeof _s=="object"?(e(_s),typeof Wu=="object"&&(Wu.exports=r(_s))):function(){var i={};e(i),t.Long=r(i)}()})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:_s,function(t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(E,h,I){this.low=E|0,this.high=h|0,this.unsigned=!!I}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0});function i(E){return(E&&E.__isLong__)===!0}function n(E){var h=Math.clz32(E&-E);return E?31-h:h}r.isLong=i;var s={},o={};function a(E,h){var I,se,ye;return h?(E>>>=0,(ye=0<=E&&E<256)&&(se=o[E],se)?se:(I=c(E,0,!0),ye&&(o[E]=I),I)):(E|=0,(ye=-128<=E&&E<128)&&(se=s[E],se)?se:(I=c(E,E<0?-1:0,!1),ye&&(s[E]=I),I))}r.fromInt=a;function l(E,h){if(isNaN(E))return h?j:X;if(h){if(E<0)return j;if(E>=k)return Ae}else{if(E<=-M)return fe;if(E+1>=M)return be}return E<0?l(-E,h).neg():c(E%C|0,E/C|0,h)}r.fromNumber=l;function c(E,h,I){return new r(E,h,I)}r.fromBits=c;var u=Math.pow;function f(E,h,I){if(E.length===0)throw Error("empty string");if(typeof h=="number"?(I=h,h=!1):h=!!h,E==="NaN"||E==="Infinity"||E==="+Infinity"||E==="-Infinity")return h?j:X;if(I=I||10,I<2||36<I)throw RangeError("radix");var se;if((se=E.indexOf("-"))>0)throw Error("interior hyphen");if(se===0)return f(E.substring(1),h,I).neg();for(var ye=l(u(I,8)),pe=X,Pe=0;Pe<E.length;Pe+=8){var ve=Math.min(8,E.length-Pe),Qe=parseInt(E.substring(Pe,Pe+ve),I);if(ve<8){var De=l(u(I,ve));pe=pe.mul(De).add(l(Qe))}else pe=pe.mul(ye),pe=pe.add(l(Qe))}return pe.unsigned=h,pe}r.fromString=f;function m(E,h){return typeof E=="number"?l(E,h):typeof E=="string"?f(E,h):c(E.low,E.high,typeof h=="boolean"?h:E.unsigned)}r.fromValue=m;var _=65536,T=1<<24,C=_*_,k=C*C,M=k/2,P=a(T),X=a(0);r.ZERO=X;var j=a(0,!0);r.UZERO=j;var re=a(1);r.ONE=re;var J=a(1,!0);r.UONE=J;var oe=a(-1);r.NEG_ONE=oe;var be=c(-1,2147483647,!1);r.MAX_VALUE=be;var Ae=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=Ae;var fe=c(0,-2147483648,!1);r.MIN_VALUE=fe;var b=r.prototype;b.toInt=function(){return this.unsigned?this.low>>>0:this.low},b.toNumber=function(){return this.unsigned?(this.high>>>0)*C+(this.low>>>0):this.high*C+(this.low>>>0)},b.toString=function(h){if(h=h||10,h<2||36<h)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(fe)){var I=l(h),se=this.div(I),ye=se.mul(I).sub(this);return se.toString(h)+ye.toInt().toString(h)}else return"-"+this.neg().toString(h);for(var pe=l(u(h,6),this.unsigned),Pe=this,ve="";;){var Qe=Pe.div(pe),De=Pe.sub(Qe.mul(pe)).toInt()>>>0,ke=De.toString(h);if(Pe=Qe,Pe.isZero())return ke+ve;for(;ke.length<6;)ke="0"+ke;ve=""+ke+ve}},b.getHighBits=function(){return this.high},b.getHighBitsUnsigned=function(){return this.high>>>0},b.getLowBits=function(){return this.low},b.getLowBitsUnsigned=function(){return this.low>>>0},b.getNumBitsAbs=function(){if(this.isNegative())return this.eq(fe)?64:this.neg().getNumBitsAbs();for(var h=this.high!=0?this.high:this.low,I=31;I>0&&!(h&1<<I);I--);return this.high!=0?I+33:I+1},b.isSafeInteger=function(){var h=this.high>>21;return h?this.unsigned?!1:h===-1&&!(this.low===0&&this.high===-2097152):!0},b.isZero=function(){return this.high===0&&this.low===0},b.eqz=b.isZero,b.isNegative=function(){return!this.unsigned&&this.high<0},b.isPositive=function(){return this.unsigned||this.high>=0},b.isOdd=function(){return(this.low&1)===1},b.isEven=function(){return(this.low&1)===0},b.equals=function(h){return i(h)||(h=m(h)),this.unsigned!==h.unsigned&&this.high>>>31===1&&h.high>>>31===1?!1:this.high===h.high&&this.low===h.low},b.eq=b.equals,b.notEquals=function(h){return!this.eq(h)},b.neq=b.notEquals,b.ne=b.notEquals,b.lessThan=function(h){return this.comp(h)<0},b.lt=b.lessThan,b.lessThanOrEqual=function(h){return this.comp(h)<=0},b.lte=b.lessThanOrEqual,b.le=b.lessThanOrEqual,b.greaterThan=function(h){return this.comp(h)>0},b.gt=b.greaterThan,b.greaterThanOrEqual=function(h){return this.comp(h)>=0},b.gte=b.greaterThanOrEqual,b.ge=b.greaterThanOrEqual,b.compare=function(h){if(i(h)||(h=m(h)),this.eq(h))return 0;var I=this.isNegative(),se=h.isNegative();return I&&!se?-1:!I&&se?1:this.unsigned?h.high>>>0>this.high>>>0||h.high===this.high&&h.low>>>0>this.low>>>0?-1:1:this.sub(h).isNegative()?-1:1},b.comp=b.compare,b.negate=function(){return!this.unsigned&&this.eq(fe)?fe:this.not().add(re)},b.neg=b.negate,b.add=function(h){i(h)||(h=m(h));var I=this.high>>>16,se=this.high&65535,ye=this.low>>>16,pe=this.low&65535,Pe=h.high>>>16,ve=h.high&65535,Qe=h.low>>>16,De=h.low&65535,ke=0,Ge=0,Le=0,et=0;return et+=pe+De,Le+=et>>>16,et&=65535,Le+=ye+Qe,Ge+=Le>>>16,Le&=65535,Ge+=se+ve,ke+=Ge>>>16,Ge&=65535,ke+=I+Pe,ke&=65535,c(Le<<16|et,ke<<16|Ge,this.unsigned)},b.subtract=function(h){return i(h)||(h=m(h)),this.add(h.neg())},b.sub=b.subtract,b.multiply=function(h){if(this.isZero())return this;if(i(h)||(h=m(h)),e){var I=e.mul(this.low,this.high,h.low,h.high);return c(I,e.get_high(),this.unsigned)}if(h.isZero())return this.unsigned?j:X;if(this.eq(fe))return h.isOdd()?fe:X;if(h.eq(fe))return this.isOdd()?fe:X;if(this.isNegative())return h.isNegative()?this.neg().mul(h.neg()):this.neg().mul(h).neg();if(h.isNegative())return this.mul(h.neg()).neg();if(this.lt(P)&&h.lt(P))return l(this.toNumber()*h.toNumber(),this.unsigned);var se=this.high>>>16,ye=this.high&65535,pe=this.low>>>16,Pe=this.low&65535,ve=h.high>>>16,Qe=h.high&65535,De=h.low>>>16,ke=h.low&65535,Ge=0,Le=0,et=0,zi=0;return zi+=Pe*ke,et+=zi>>>16,zi&=65535,et+=pe*ke,Le+=et>>>16,et&=65535,et+=Pe*De,Le+=et>>>16,et&=65535,Le+=ye*ke,Ge+=Le>>>16,Le&=65535,Le+=pe*De,Ge+=Le>>>16,Le&=65535,Le+=Pe*Qe,Ge+=Le>>>16,Le&=65535,Ge+=se*ke+ye*De+pe*Qe+Pe*ve,Ge&=65535,c(et<<16|zi,Ge<<16|Le,this.unsigned)},b.mul=b.multiply,b.divide=function(h){if(i(h)||(h=m(h)),h.isZero())throw Error("division by zero");if(e){if(!this.unsigned&&this.high===-2147483648&&h.low===-1&&h.high===-1)return this;var I=(this.unsigned?e.div_u:e.div_s)(this.low,this.high,h.low,h.high);return c(I,e.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?j:X;var se,ye,pe;if(this.unsigned){if(h.unsigned||(h=h.toUnsigned()),h.gt(this))return j;if(h.gt(this.shru(1)))return J;pe=j}else{if(this.eq(fe)){if(h.eq(re)||h.eq(oe))return fe;if(h.eq(fe))return re;var Pe=this.shr(1);return se=Pe.div(h).shl(1),se.eq(X)?h.isNegative()?re:oe:(ye=this.sub(h.mul(se)),pe=se.add(ye.div(h)),pe)}else if(h.eq(fe))return this.unsigned?j:X;if(this.isNegative())return h.isNegative()?this.neg().div(h.neg()):this.neg().div(h).neg();if(h.isNegative())return this.div(h.neg()).neg();pe=X}for(ye=this;ye.gte(h);){se=Math.max(1,Math.floor(ye.toNumber()/h.toNumber()));for(var ve=Math.ceil(Math.log(se)/Math.LN2),Qe=ve<=48?1:u(2,ve-48),De=l(se),ke=De.mul(h);ke.isNegative()||ke.gt(ye);)se-=Qe,De=l(se,this.unsigned),ke=De.mul(h);De.isZero()&&(De=re),pe=pe.add(De),ye=ye.sub(ke)}return pe},b.div=b.divide,b.modulo=function(h){if(i(h)||(h=m(h)),e){var I=(this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,h.low,h.high);return c(I,e.get_high(),this.unsigned)}return this.sub(this.div(h).mul(h))},b.mod=b.modulo,b.rem=b.modulo,b.not=function(){return c(~this.low,~this.high,this.unsigned)},b.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},b.clz=b.countLeadingZeros,b.countTrailingZeros=function(){return this.low?n(this.low):n(this.high)+32},b.ctz=b.countTrailingZeros,b.and=function(h){return i(h)||(h=m(h)),c(this.low&h.low,this.high&h.high,this.unsigned)},b.or=function(h){return i(h)||(h=m(h)),c(this.low|h.low,this.high|h.high,this.unsigned)},b.xor=function(h){return i(h)||(h=m(h)),c(this.low^h.low,this.high^h.high,this.unsigned)},b.shiftLeft=function(h){return i(h)&&(h=h.toInt()),(h&=63)===0?this:h<32?c(this.low<<h,this.high<<h|this.low>>>32-h,this.unsigned):c(0,this.low<<h-32,this.unsigned)},b.shl=b.shiftLeft,b.shiftRight=function(h){return i(h)&&(h=h.toInt()),(h&=63)===0?this:h<32?c(this.low>>>h|this.high<<32-h,this.high>>h,this.unsigned):c(this.high>>h-32,this.high>=0?0:-1,this.unsigned)},b.shr=b.shiftRight,b.shiftRightUnsigned=function(h){return i(h)&&(h=h.toInt()),(h&=63)===0?this:h<32?c(this.low>>>h|this.high<<32-h,this.high>>>h,this.unsigned):h===32?c(this.high,0,this.unsigned):c(this.high>>>h-32,0,this.unsigned)},b.shru=b.shiftRightUnsigned,b.shr_u=b.shiftRightUnsigned,b.rotateLeft=function(h){var I;return i(h)&&(h=h.toInt()),(h&=63)===0?this:h===32?c(this.high,this.low,this.unsigned):h<32?(I=32-h,c(this.low<<h|this.high>>>I,this.high<<h|this.low>>>I,this.unsigned)):(h-=32,I=32-h,c(this.high<<h|this.low>>>I,this.low<<h|this.high>>>I,this.unsigned))},b.rotl=b.rotateLeft,b.rotateRight=function(h){var I;return i(h)&&(h=h.toInt()),(h&=63)===0?this:h===32?c(this.high,this.low,this.unsigned):h<32?(I=32-h,c(this.high<<I|this.low>>>h,this.low<<I|this.high>>>h,this.unsigned)):(h-=32,I=32-h,c(this.low<<I|this.high>>>h,this.high<<I|this.low>>>h,this.unsigned))},b.rotr=b.rotateRight,b.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},b.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},b.toBytes=function(h){return h?this.toBytesLE():this.toBytesBE()},b.toBytesLE=function(){var h=this.high,I=this.low;return[I&255,I>>>8&255,I>>>16&255,I>>>24,h&255,h>>>8&255,h>>>16&255,h>>>24]},b.toBytesBE=function(){var h=this.high,I=this.low;return[h>>>24,h>>>16&255,h>>>8&255,h&255,I>>>24,I>>>16&255,I>>>8&255,I&255]},r.fromBytes=function(h,I,se){return se?r.fromBytesLE(h,I):r.fromBytesBE(h,I)},r.fromBytesLE=function(h,I){return new r(h[0]|h[1]<<8|h[2]<<16|h[3]<<24,h[4]|h[5]<<8|h[6]<<16|h[7]<<24,I)},r.fromBytesBE=function(h,I){return new r(h[4]<<24|h[5]<<16|h[6]<<8|h[7],h[0]<<24|h[1]<<16|h[2]<<8|h[3],I)},typeof BigInt=="function"&&(r.fromBigInt=function(h,I){var se=Number(BigInt.asIntN(32,h)),ye=Number(BigInt.asIntN(32,h>>BigInt(32)));return c(se,ye,I)},r.fromValue=function(h,I){return typeof h=="bigint"?fromBigInt(h,I):m(h,I)},b.toBigInt=function(){var h=BigInt(this.low>>>0),I=BigInt(this.unsigned?this.high>>>0:this.high);return I<<BigInt(32)|h});var Re=t.default=r})});var ty=S(Be=>{"use strict";Object.defineProperty(Be,"__esModule",{value:!0});Be.loadFileDescriptorSetFromObject=Be.loadFileDescriptorSetFromBuffer=Be.fromJSON=Be.loadSync=Be.load=Be.IdempotencyLevel=Be.isAnyExtension=Be.Long=void 0;var DT=Fp(),ar=pa(),Vu=jm(),Gu=Gm(),LT=Zm();Be.Long=LT;function FT(t){return"@type"in t&&typeof t["@type"]=="string"}Be.isAnyExtension=FT;var Km;(function(t){t.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",t.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",t.IDEMPOTENT="IDEMPOTENT"})(Km=Be.IdempotencyLevel||(Be.IdempotencyLevel={}));var Xm={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function qT(t,e){return t===""?e:t+"."+e}function BT(t){return t instanceof ar.Service||t instanceof ar.Type||t instanceof ar.Enum}function jT(t){return t instanceof ar.Namespace||t instanceof ar.Root}function Qm(t,e){let r=qT(e,t.name);return BT(t)?[[r,t]]:jT(t)&&typeof t.nested<"u"?Object.keys(t.nested).map(i=>Qm(t.nested[i],r)).reduce((i,n)=>i.concat(n),[]):[]}function Ym(t,e){return function(i){return t.toObject(t.decode(i),e)}}function Jm(t){return function(r){if(Array.isArray(r))throw new Error(`Failed to serialize message: expected object with ${t.name} structure, got array instead`);let i=t.fromObject(r);return t.encode(i).finish()}}function UT(t){return(t||[]).reduce((e,r)=>{for(let[i,n]of Object.entries(r))switch(i){case"uninterpreted_option":e.uninterpreted_option.push(r.uninterpreted_option);break;default:e[i]=n}return e},{deprecated:!1,idempotency_level:Km.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function zT(t,e,r,i){let n=t.resolvedRequestType,s=t.resolvedResponseType;return{path:"/"+e+"/"+t.name,requestStream:!!t.requestStream,responseStream:!!t.responseStream,requestSerialize:Jm(n),requestDeserialize:Ym(n,r),responseSerialize:Jm(s),responseDeserialize:Ym(s,r),originalName:DT(t.name),requestType:$u(n,i),responseType:$u(s,i),options:UT(t.parsedOptions)}}function HT(t,e,r,i){let n={};for(let s of t.methodsArray)n[s.name]=zT(s,e,r,i);return n}function $u(t,e){let r=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:r.$type.toObject(r,Xm),fileDescriptorProtos:e}}function WT(t,e){let r=t.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:r.$type.toObject(r,Xm),fileDescriptorProtos:e}}function $T(t,e,r,i){if(t instanceof ar.Service)return HT(t,e,r,i);if(t instanceof ar.Type)return $u(t,i);if(t instanceof ar.Enum)return WT(t,i);throw new Error("Type mismatch in reflection object handling")}function ya(t,e){let r={};t.resolveAll();let n=t.toDescriptor("proto3").file.map(s=>Buffer.from(Vu.FileDescriptorProto.encode(s).finish()));for(let[s,o]of Qm(t,""))r[s]=$T(o,s,e,n);return r}function ey(t,e){e=e||{};let r=ar.Root.fromDescriptor(t);return r.resolveAll(),ya(r,e)}function VT(t,e){return(0,Gu.loadProtosWithOptions)(t,e).then(r=>ya(r,e))}Be.load=VT;function GT(t,e){let r=(0,Gu.loadProtosWithOptionsSync)(t,e);return ya(r,e)}Be.loadSync=GT;function ZT(t,e){e=e||{};let r=ar.Root.fromJSON(t);return r.resolveAll(),ya(r,e)}Be.fromJSON=ZT;function YT(t,e){let r=Vu.FileDescriptorSet.decode(t);return ey(r,e)}Be.loadFileDescriptorSetFromBuffer=YT;function JT(t,e){let r=Vu.FileDescriptorSet.fromObject(t);return ey(r,e)}Be.loadFileDescriptorSetFromObject=JT;(0,Gu.addCommonProtos)()});var xi=S(Ce=>{"use strict";Object.defineProperty(Ce,"__esModule",{value:!0});Ce.registerChannelzSocket=Ce.registerChannelzServer=Ce.registerChannelzSubchannel=Ce.registerChannelzChannel=Ce.ChannelzCallTrackerStub=Ce.ChannelzCallTracker=Ce.ChannelzChildrenTrackerStub=Ce.ChannelzChildrenTracker=Ce.ChannelzTrace=Ce.ChannelzTraceStub=void 0;Ce.unregisterChannelzRef=tw;Ce.getChannelzHandlers=cy;Ce.getChannelzServiceDefinition=uy;Ce.setup=hw;var _a=require("net"),ki=sp(),Ss=bt(),Cs=ne(),KT=Et(),XT=Fo(),QT=$c();function Zu(t){return{channel_id:t.id,name:t.name}}function Qu(t){return{subchannel_id:t.id,name:t.name}}function ew(t){return{server_id:t.id}}function ba(t){return{socket_id:t.id,name:t.name}}var ry=32,ed=100,Yu=class{constructor(){this.events=[],this.creationTimestamp=new Date,this.eventsLogged=0}addTrace(){}getTraceMessage(){return{creation_timestamp:lr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:[]}}};Ce.ChannelzTraceStub=Yu;var Ju=class{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,r,i){let n=new Date;this.events.push({description:r,severity:e,timestamp:n,childChannel:i?.kind==="channel"?i:void 0,childSubchannel:i?.kind==="subchannel"?i:void 0}),this.events.length>=ry*2&&(this.events=this.events.slice(ry)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:lr(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:lr(e.timestamp),channel_ref:e.childChannel?Zu(e.childChannel):null,subchannel_ref:e.childSubchannel?Qu(e.childSubchannel):null}))}}};Ce.ChannelzTrace=Ju;var Sa=class{constructor(){this.channelChildren=new ki.OrderedMap,this.subchannelChildren=new ki.OrderedMap,this.socketChildren=new ki.OrderedMap,this.trackerMap={channel:this.channelChildren,subchannel:this.subchannelChildren,socket:this.socketChildren}}refChild(e){let r=this.trackerMap[e.kind],i=r.find(e.id);i.equals(r.end())?r.setElement(e.id,{ref:e,count:1},i):i.pointer[1].count+=1}unrefChild(e){let r=this.trackerMap[e.kind],i=r.getElementByKey(e.id);i!==void 0&&(i.count-=1,i.count===0&&r.eraseElementByKey(e.id))}getChildLists(){return{channels:this.channelChildren,subchannels:this.subchannelChildren,sockets:this.socketChildren}}};Ce.ChannelzChildrenTracker=Sa;var Ku=class extends Sa{refChild(){}unrefChild(){}};Ce.ChannelzChildrenTrackerStub=Ku;var Ca=class{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}};Ce.ChannelzCallTracker=Ca;var Xu=class extends Ca{addCallStarted(){}addCallSucceeded(){}addCallFailed(){}};Ce.ChannelzCallTrackerStub=Xu;var Tr={channel:new ki.OrderedMap,subchannel:new ki.OrderedMap,server:new ki.OrderedMap,socket:new ki.OrderedMap},Ea=t=>{let e=1;function r(){return e++}let i=Tr[t];return(n,s,o)=>{let a=r(),l={id:a,name:n,kind:t};return o&&i.setElement(a,{ref:l,getInfo:s}),l}};Ce.registerChannelzChannel=Ea("channel");Ce.registerChannelzSubchannel=Ea("subchannel");Ce.registerChannelzServer=Ea("server");Ce.registerChannelzSocket=Ea("socket");function tw(t){Tr[t.kind].eraseElementByKey(t.id)}function rw(t){let e=Number.parseInt(t,16);return[e/256|0,e%256]}function iy(t){if(t==="")return[];let e=t.split(":").map(i=>rw(i));return[].concat(...e)}function iw(t){return(0,_a.isIPv6)(t)&&t.toLowerCase().startsWith("::ffff:")&&(0,_a.isIPv4)(t.substring(7))}function ny(t){return Buffer.from(Uint8Array.from(t.split(".").map(e=>Number.parseInt(e))))}function nw(t){if((0,_a.isIPv4)(t))return ny(t);if(iw(t))return ny(t.substring(7));if((0,_a.isIPv6)(t)){let e,r,i=t.indexOf("::");i===-1?(e=t,r=""):(e=t.substring(0,i),r=t.substring(i+2));let n=Buffer.from(iy(e)),s=Buffer.from(iy(r)),o=Buffer.alloc(16-n.length-s.length,0);return Buffer.concat([n,o,s])}else return null}function oy(t){switch(t){case Ss.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case Ss.ConnectivityState.IDLE:return{state:"IDLE"};case Ss.ConnectivityState.READY:return{state:"READY"};case Ss.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case Ss.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function lr(t){if(!t)return null;let e=t.getTime();return{seconds:e/1e3|0,nanos:e%1e3*1e6}}function ay(t){let e=t.getInfo(),r=[],i=[];return e.children.channels.forEach(n=>{r.push(Zu(n[1].ref))}),e.children.subchannels.forEach(n=>{i.push(Qu(n[1].ref))}),{ref:Zu(t.ref),data:{target:e.target,state:oy(e.state),calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:lr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},channel_ref:r,subchannel_ref:i}}function sw(t,e){let r=parseInt(t.request.channel_id,10),i=Tr.channel.getElementByKey(r);if(i===void 0){e({code:Cs.Status.NOT_FOUND,details:"No channel data found for id "+r});return}e(null,{channel:ay(i)})}function ow(t,e){let r=parseInt(t.request.max_results,10)||ed,i=[],n=parseInt(t.request.start_channel_id,10),s=Tr.channel,o;for(o=s.lowerBound(n);!o.equals(s.end())&&i.length<r;o=o.next())i.push(ay(o.pointer[1]));e(null,{channel:i,end:o.equals(s.end())})}function ly(t){let e=t.getInfo(),r=[];return e.listenerChildren.sockets.forEach(i=>{r.push(ba(i[1].ref))}),{ref:ew(t.ref),data:{calls_started:e.callTracker.callsStarted,calls_succeeded:e.callTracker.callsSucceeded,calls_failed:e.callTracker.callsFailed,last_call_started_timestamp:lr(e.callTracker.lastCallStartedTimestamp),trace:e.trace.getTraceMessage()},listen_socket:r}}function aw(t,e){let r=parseInt(t.request.server_id,10),n=Tr.server.getElementByKey(r);if(n===void 0){e({code:Cs.Status.NOT_FOUND,details:"No server data found for id "+r});return}e(null,{server:ly(n)})}function lw(t,e){let r=parseInt(t.request.max_results,10)||ed,i=parseInt(t.request.start_server_id,10),n=Tr.server,s=[],o;for(o=n.lowerBound(i);!o.equals(n.end())&&s.length<r;o=o.next())s.push(ly(o.pointer[1]));e(null,{server:s,end:o.equals(n.end())})}function cw(t,e){let r=parseInt(t.request.subchannel_id,10),i=Tr.subchannel.getElementByKey(r);if(i===void 0){e({code:Cs.Status.NOT_FOUND,details:"No subchannel data found for id "+r});return}let n=i.getInfo(),s=[];n.children.sockets.forEach(a=>{s.push(ba(a[1].ref))});let o={ref:Qu(i.ref),data:{target:n.target,state:oy(n.state),calls_started:n.callTracker.callsStarted,calls_succeeded:n.callTracker.callsSucceeded,calls_failed:n.callTracker.callsFailed,last_call_started_timestamp:lr(n.callTracker.lastCallStartedTimestamp),trace:n.trace.getTraceMessage()},socket_ref:s};e(null,{subchannel:o})}function sy(t){var e;return(0,KT.isTcpSubchannelAddress)(t)?{address:"tcpip_address",tcpip_address:{ip_address:(e=nw(t.host))!==null&&e!==void 0?e:void 0,port:t.port}}:{address:"uds_address",uds_address:{filename:t.path}}}function uw(t,e){var r,i,n,s,o;let a=parseInt(t.request.socket_id,10),l=Tr.socket.getElementByKey(a);if(l===void 0){e({code:Cs.Status.NOT_FOUND,details:"No socket data found for id "+a});return}let c=l.getInfo(),u=c.security?{model:"tls",tls:{cipher_suite:c.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:(r=c.security.cipherSuiteStandardName)!==null&&r!==void 0?r:void 0,other_name:(i=c.security.cipherSuiteOtherName)!==null&&i!==void 0?i:void 0,local_certificate:(n=c.security.localCertificate)!==null&&n!==void 0?n:void 0,remote_certificate:(s=c.security.remoteCertificate)!==null&&s!==void 0?s:void 0}}:null,f={ref:ba(l.ref),local:c.localAddress?sy(c.localAddress):null,remote:c.remoteAddress?sy(c.remoteAddress):null,remote_name:(o=c.remoteName)!==null&&o!==void 0?o:void 0,security:u,data:{keep_alives_sent:c.keepAlivesSent,streams_started:c.streamsStarted,streams_succeeded:c.streamsSucceeded,streams_failed:c.streamsFailed,last_local_stream_created_timestamp:lr(c.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:lr(c.lastRemoteStreamCreatedTimestamp),messages_received:c.messagesReceived,messages_sent:c.messagesSent,last_message_received_timestamp:lr(c.lastMessageReceivedTimestamp),last_message_sent_timestamp:lr(c.lastMessageSentTimestamp),local_flow_control_window:c.localFlowControlWindow?{value:c.localFlowControlWindow}:null,remote_flow_control_window:c.remoteFlowControlWindow?{value:c.remoteFlowControlWindow}:null}};e(null,{socket:f})}function dw(t,e){let r=parseInt(t.request.server_id,10),i=Tr.server.getElementByKey(r);if(i===void 0){e({code:Cs.Status.NOT_FOUND,details:"No server data found for id "+r});return}let n=parseInt(t.request.start_socket_id,10),s=parseInt(t.request.max_results,10)||ed,a=i.getInfo().sessionChildren.sockets,l=[],c;for(c=a.lowerBound(n);!c.equals(a.end())&&l.length<s;c=c.next())l.push(ba(c.pointer[1].ref));e(null,{socket_ref:l,end:c.equals(a.end())})}function cy(){return{GetChannel:sw,GetTopChannels:ow,GetServer:aw,GetServers:lw,GetSubchannel:cw,GetSocket:uw,GetServerSockets:dw}}var va=null;function uy(){if(va)return va;let t=ty().loadSync,e=t("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:[`${__dirname}/../../proto`]});return va=(0,QT.loadPackageDefinition)(e).grpc.channelz.v1.Channelz.service,va}function hw(){(0,XT.registerAdminService)(uy,cy)}});var dy=S(wa=>{"use strict";Object.defineProperty(wa,"__esModule",{value:!0});wa.Subchannel=void 0;var ge=bt(),fw=Jn(),td=_e(),Ta=ne(),pw=st(),gw=Et(),cr=xi(),mw="subchannel",yw=~(1<<31),rd=class{constructor(e,r,i,n,s){var o;this.channelTarget=e,this.subchannelAddress=r,this.options=i,this.connector=s,this.connectivityState=ge.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0;let a={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new fw.BackoffTimeout(()=>{this.handleBackoffTimer()},a),this.backoffTimeout.unref(),this.subchannelAddressString=(0,gw.subchannelAddressToString)(r),this.keepaliveTime=(o=i["grpc.keepalive_time_ms"])!==null&&o!==void 0?o:-1,i["grpc.enable_channelz"]===0?(this.channelzEnabled=!1,this.channelzTrace=new cr.ChannelzTraceStub,this.callTracker=new cr.ChannelzCallTrackerStub,this.childrenTracker=new cr.ChannelzChildrenTrackerStub,this.streamTracker=new cr.ChannelzCallTrackerStub):(this.channelzTrace=new cr.ChannelzTrace,this.callTracker=new cr.ChannelzCallTracker,this.childrenTracker=new cr.ChannelzChildrenTracker,this.streamTracker=new cr.ChannelzCallTracker),this.channelzRef=(0,cr.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(i,void 0,2)),this.secureConnector=n._createSecureConnector(e,i)}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){td.trace(Ta.LogVerbosity.DEBUG,mw,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){td.trace(Ta.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([ge.ConnectivityState.TRANSIENT_FAILURE],ge.ConnectivityState.CONNECTING):this.transitionToState([ge.ConnectivityState.TRANSIENT_FAILURE],ge.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let r=Math.min(this.keepaliveTime,yw);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":r})}this.connector.connect(this.subchannelAddress,this.secureConnector,e).then(r=>{this.transitionToState([ge.ConnectivityState.CONNECTING],ge.ConnectivityState.READY)?(this.transport=r,this.channelzEnabled&&this.childrenTracker.refChild(r.getChannelzRef()),r.addDisconnectListener(i=>{this.transitionToState([ge.ConnectivityState.READY],ge.ConnectivityState.IDLE),i&&this.keepaliveTime>0&&(this.keepaliveTime*=2,td.log(Ta.LogVerbosity.ERROR,`Connection to ${(0,pw.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):r.shutdown()},r=>{this.transitionToState([ge.ConnectivityState.CONNECTING],ge.ConnectivityState.TRANSIENT_FAILURE,`${r}`)})}transitionToState(e,r,i){var n,s;if(e.indexOf(this.connectivityState)===-1)return!1;i?this.trace(ge.ConnectivityState[this.connectivityState]+" -> "+ge.ConnectivityState[r]+' with error "'+i+'"'):this.trace(ge.ConnectivityState[this.connectivityState]+" -> "+ge.ConnectivityState[r]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+ge.ConnectivityState[r]);let o=this.connectivityState;switch(this.connectivityState=r,r){case ge.ConnectivityState.READY:this.stopBackoff();break;case ge.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case ge.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(n=this.transport)===null||n===void 0||n.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case ge.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),(s=this.transport)===null||s===void 0||s.shutdown(),this.transport=null;break;default:throw new Error(`Invalid state: unknown ConnectivityState ${r}`)}for(let a of this.stateListeners)a(this,o,r,this.keepaliveTime,i);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,this.refcount===0&&(this.channelzTrace.addTrace("CT_INFO","Shutting down"),(0,cr.unregisterChannelzRef)(this.channelzRef),this.secureConnector.destroy(),process.nextTick(()=>{this.transitionToState([ge.ConnectivityState.CONNECTING,ge.ConnectivityState.READY],ge.ConnectivityState.IDLE)}))}unrefIfOneRef(){return this.refcount===1?(this.unref(),!0):!1}createCall(e,r,i,n){if(!this.transport)throw new Error("Cannot create call, subchannel not READY");let s;return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),s={onCallEnd:o=>{o.code===Ta.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):s={},this.transport.createCall(e,r,i,n,s)}startConnecting(){process.nextTick(()=>{this.transitionToState([ge.ConnectivityState.IDLE],ge.ConnectivityState.CONNECTING)||this.connectivityState===ge.ConnectivityState.TRANSIENT_FAILURE&&(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([ge.ConnectivityState.TRANSIENT_FAILURE],ge.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}isHealthy(){return!0}addHealthStateWatcher(e){}removeHealthStateWatcher(e){}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}getCallCredentials(){return this.secureConnector.getCallCredentials()}};wa.Subchannel=rd});var hy=S(Ra=>{"use strict";var id;Object.defineProperty(Ra,"__esModule",{value:!0});Ra.GRPC_NODE_USE_ALTERNATIVE_RESOLVER=void 0;Ra.GRPC_NODE_USE_ALTERNATIVE_RESOLVER=((id=process.env.GRPC_NODE_USE_ALTERNATIVE_RESOLVER)!==null&&id!==void 0?id:"false")==="true"});var ld=S(Oi=>{"use strict";Object.defineProperty(Oi,"__esModule",{value:!0});Oi.DEFAULT_PORT=void 0;Oi.setup=Tw;var fy=Kt(),nd=require("dns"),vw=hc(),sd=ne(),od=Ke(),_w=_e(),Sw=ne(),Zr=st(),py=require("net"),Cw=Jn(),gy=hy(),bw="dns_resolver";function ur(t){_w.trace(Sw.LogVerbosity.DEBUG,bw,t)}Oi.DEFAULT_PORT=443;var Ew=3e4,ad=class{constructor(e,r,i){var n,s,o;this.target=e,this.listener=r,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,this.alternativeResolver=new nd.promises.Resolver,ur("Resolver constructed for target "+(0,Zr.uriToString)(e)),e.authority&&this.alternativeResolver.setServers([e.authority]);let a=(0,Zr.splitHostPort)(e.path);a===null?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,py.isIPv4)(a.host)||(0,py.isIPv6)(a.host)?(this.ipResult=[{addresses:[{host:a.host,port:(n=a.port)!==null&&n!==void 0?n:Oi.DEFAULT_PORT}]}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=a.host,this.port=(s=a.port)!==null&&s!==void 0?s:Oi.DEFAULT_PORT),this.percentage=Math.random()*100,i["grpc.service_config_disable_resolution"]===1&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:sd.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,Zr.uriToString)(this.target)}`,metadata:new od.Metadata};let l={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoff=new Cw.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},l),this.backoff.unref(),this.minTimeBetweenResolutionsMs=(o=i["grpc.dns_min_time_between_resolutions_ms"])!==null&&o!==void 0?o:Ew,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(this.ipResult!==null){this.returnedIpResult||(ur("Returning IP address for target "+(0,Zr.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(this.dnsHostname===null)ur("Failed to parse DNS address "+(0,Zr.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:sd.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,Zr.uriToString)(this.target)}`,metadata:new od.Metadata})}),this.stopNextResolutionTimer();else{if(this.pendingLookupPromise!==null)return;ur("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=this.lookup(e),this.pendingLookupPromise.then(r=>{if(this.pendingLookupPromise===null)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop(),this.latestLookupResult=r.map(n=>({addresses:[n]}));let i="["+r.map(n=>n.host+":"+n.port).join(",")+"]";if(ur("Resolved addresses for target "+(0,Zr.uriToString)(this.target)+": "+i),this.latestLookupResult.length===0){this.listener.onError(this.defaultResolutionError);return}this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},r=>{this.pendingLookupPromise!==null&&(ur("Resolution error for target "+(0,Zr.uriToString)(this.target)+": "+r.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&this.pendingTxtPromise===null&&(this.pendingTxtPromise=this.resolveTxt(e),this.pendingTxtPromise.then(r=>{if(this.pendingTxtPromise!==null){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,vw.extractAndSelectServiceConfig)(r,this.percentage)}catch(i){this.latestServiceConfigError={code:sd.Status.UNAVAILABLE,details:`Parsing service config failed with error ${i.message}`,metadata:new od.Metadata}}this.latestLookupResult!==null&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},r=>{}))}}async lookup(e){if(gy.GRPC_NODE_USE_ALTERNATIVE_RESOLVER){ur("Using alternative DNS resolver.");let i=await Promise.allSettled([this.alternativeResolver.resolve4(e),this.alternativeResolver.resolve6(e)]);if(i.every(n=>n.status==="rejected"))throw new Error(i[0].reason);return i.reduce((n,s)=>s.status==="fulfilled"?[...n,...s.value]:n,[]).map(n=>({host:n,port:+this.port}))}return(await nd.promises.lookup(e,{all:!0})).map(i=>({host:i.address,port:+this.port}))}async resolveTxt(e){return gy.GRPC_NODE_USE_ALTERNATIVE_RESOLVER?(ur("Using alternative DNS resolver."),this.alternativeResolver.resolveTxt(e)):nd.promises.resolveTxt(e)}startNextResolutionTimer(){var e,r;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs),(r=(e=this.nextResolutionTimer).unref)===null||r===void 0||r.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){this.pendingLookupPromise===null&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){this.pendingLookupPromise===null&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?ur('resolution update delayed by "min time between resolutions" rate limit'):ur("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}};function Tw(){(0,fy.registerResolver)("dns",ad),(0,fy.registerDefaultScheme)("dns")}});var cd=S(Ts=>{"use strict";Object.defineProperty(Ts,"__esModule",{value:!0});Ts.parseCIDR=vy;Ts.mapProxyName=Nw;Ts.getProxiedConnection=Dw;var bs=_e(),yn=ne(),yy=require("net"),ww=require("http"),Rw=_e(),my=Et(),Es=st(),kw=require("url"),xw=ld(),Ow="proxy";function vn(t){Rw.trace(yn.LogVerbosity.DEBUG,Ow,t)}function Aw(){let t="",e="";if(process.env.grpc_proxy)e="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)e="https_proxy",t=process.env.https_proxy;else if(process.env.http_proxy)e="http_proxy",t=process.env.http_proxy;else return{};let r;try{r=new kw.URL(t)}catch{return(0,bs.log)(yn.LogVerbosity.ERROR,`cannot parse value of "${e}" env var`),{}}if(r.protocol!=="http:")return(0,bs.log)(yn.LogVerbosity.ERROR,`"${r.protocol}" scheme not supported in proxy URI`),{};let i=null;r.username&&(r.password?((0,bs.log)(yn.LogVerbosity.INFO,"userinfo found in proxy URI"),i=decodeURIComponent(`${r.username}:${r.password}`)):i=r.username);let n=r.hostname,s=r.port;s===""&&(s="80");let o={address:`${n}:${s}`};return i&&(o.creds=i),vn("Proxy server "+o.address+" set by environment variable "+e),o}function Pw(){let t=process.env.no_grpc_proxy,e="no_grpc_proxy";return t||(t=process.env.no_proxy,e="no_proxy"),t?(vn("No proxy server list set by environment variable "+e),t.split(",")):[]}function vy(t){let e=t.split("/");if(e.length!==2)return null;let r=parseInt(e[1],10);return!(0,yy.isIPv4)(e[0])||Number.isNaN(r)||r<0||r>32?null:{ip:_y(e[0]),prefixLength:r}}function _y(t){return t.split(".").reduce((e,r)=>(e<<8)+parseInt(r,10),0)}function Mw(t,e){let r=t.ip,i=-1<<32-t.prefixLength;return(_y(e)&i)===(r&i)}function Iw(t){for(let e of Pw()){let r=vy(e);if((0,yy.isIPv4)(t)&&r&&Mw(r,t))return!0;if(t.endsWith(e))return!0}return!1}function Nw(t,e){var r;let i={target:t,extraOptions:{}};if(((r=e["grpc.enable_http_proxy"])!==null&&r!==void 0?r:1)===0||t.scheme==="unix")return i;let n=Aw();if(!n.address)return i;let s=(0,Es.splitHostPort)(t.path);if(!s)return i;let o=s.host;if(Iw(o))return vn("Not using proxy for target in no_proxy list: "+(0,Es.uriToString)(t)),i;let a={"grpc.http_connect_target":(0,Es.uriToString)(t)};return n.creds&&(a["grpc.http_connect_creds"]=n.creds),{target:{scheme:"dns",path:n.address},extraOptions:a}}function Dw(t,e){var r;if(!("grpc.http_connect_target"in e))return Promise.resolve(null);let i=e["grpc.http_connect_target"],n=(0,Es.parseUri)(i);if(n===null)return Promise.resolve(null);let s=(0,Es.splitHostPort)(n.path);if(s===null)return Promise.resolve(null);let o=`${s.host}:${(r=s.port)!==null&&r!==void 0?r:xw.DEFAULT_PORT}`,a={method:"CONNECT",path:o},l={Host:o};(0,my.isTcpSubchannelAddress)(t)?(a.host=t.host,a.port=t.port):a.socketPath=t.path,"grpc.http_connect_creds"in e&&(l["Proxy-Authorization"]="Basic "+Buffer.from(e["grpc.http_connect_creds"]).toString("base64")),a.headers=l;let c=(0,my.subchannelAddressToString)(t);return vn("Using proxy "+c+" to connect to "+a.path),new Promise((u,f)=>{let m=ww.request(a);m.once("connect",(_,T,C)=>{m.removeAllListeners(),T.removeAllListeners(),_.statusCode===200?(vn("Successfully connected to "+a.path+" through proxy "+c),C.length>0&&T.unshift(C),vn("Successfully established a plaintext connection to "+a.path+" through proxy "+c),u(T)):((0,bs.log)(yn.LogVerbosity.ERROR,"Failed to connect to "+a.path+" through proxy "+c+" with status "+_.statusCode),f())}),m.once("error",_=>{m.removeAllListeners(),(0,bs.log)(yn.LogVerbosity.ERROR,"Failed to connect to proxy "+c+" with error "+_.message),f()}),m.end()})}});var dd=S(ka=>{"use strict";Object.defineProperty(ka,"__esModule",{value:!0});ka.StreamDecoder=void 0;var dr;(function(t){t[t.NO_DATA=0]="NO_DATA",t[t.READING_SIZE=1]="READING_SIZE",t[t.READING_MESSAGE=2]="READING_MESSAGE"})(dr||(dr={}));var ud=class{constructor(e){this.maxReadMessageLength=e,this.readState=dr.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let r=0,i,n=[];for(;r<e.length;)switch(this.readState){case dr.NO_DATA:this.readCompressFlag=e.slice(r,r+1),r+=1,this.readState=dr.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case dr.READING_SIZE:if(i=Math.min(e.length-r,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,r,r+i),this.readSizeRemaining-=i,r+=i,this.readSizeRemaining===0){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),this.maxReadMessageLength!==-1&&this.readMessageSize>this.maxReadMessageLength)throw new Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=dr.READING_MESSAGE;else{let s=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=dr.NO_DATA,n.push(s)}}break;case dr.READING_MESSAGE:if(i=Math.min(e.length-r,this.readMessageRemaining),this.readPartialMessage.push(e.slice(r,r+i)),this.readMessageRemaining-=i,r+=i,this.readMessageRemaining===0){let s=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),o=Buffer.concat(s,this.readMessageSize+5);this.readState=dr.NO_DATA,n.push(o)}break;default:throw new Error("Unexpected read state")}return n}};ka.StreamDecoder=ud});var Sy=S(xa=>{"use strict";Object.defineProperty(xa,"__esModule",{value:!0});xa.Http2SubchannelCall=void 0;var wr=require("http2"),Lw=require("os"),me=ne(),Rr=Ke(),Fw=dd(),qw=_e(),Bw=ne(),jw="subchannel_call";function Uw(t){for(let[e,r]of Object.entries(Lw.constants.errno))if(r===t)return e;return"Unknown system error "+t}function hd(t){let e=`Received HTTP status code ${t}`,r;switch(t){case 400:r=me.Status.INTERNAL;break;case 401:r=me.Status.UNAUTHENTICATED;break;case 403:r=me.Status.PERMISSION_DENIED;break;case 404:r=me.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:r=me.Status.UNAVAILABLE;break;default:r=me.Status.UNKNOWN}return{code:r,details:e,metadata:new Rr.Metadata}}var fd=class{constructor(e,r,i,n,s){var o;this.http2Stream=e,this.callEventTracker=r,this.listener=i,this.transport=n,this.callId=s,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.finalStatus=null,this.internalError=null,this.serverEndedCall=!1,this.connectionDropped=!1;let a=(o=n.getOptions()["grpc.max_receive_message_length"])!==null&&o!==void 0?o:me.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new Fw.StreamDecoder(a),e.on("response",(l,c)=>{let u="";for(let f of Object.keys(l))u+="		"+f+": "+l[f]+`
`;if(this.trace(`Received server headers:
`+u),this.httpStatusCode=l[":status"],c&wr.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(l);else{let f;try{f=Rr.Metadata.fromHttp2Headers(l)}catch(m){this.endCall({code:me.Status.UNKNOWN,details:m.message,metadata:new Rr.Metadata});return}this.listener.onReceiveMetadata(f)}}),e.on("trailers",l=>{this.handleTrailers(l)}),e.on("data",l=>{if(this.statusOutput)return;this.trace("receive HTTP/2 data frame of length "+l.length);let c;try{c=this.decoder.write(l)}catch(u){if(this.httpStatusCode!==void 0&&this.httpStatusCode!==200){let f=hd(this.httpStatusCode);this.cancelWithStatus(f.code,f.details)}else this.cancelWithStatus(me.Status.RESOURCE_EXHAUSTED,u.message);return}for(let u of c)this.trace("parsed message of length "+u.length),this.callEventTracker.addMessageReceived(),this.tryPush(u)}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{this.serverEndedCall=!0,process.nextTick(()=>{var l;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),((l=this.finalStatus)===null||l===void 0?void 0:l.code)===me.Status.OK)return;let c,u="";switch(e.rstCode){case wr.constants.NGHTTP2_NO_ERROR:if(this.finalStatus!==null)return;if(this.httpStatusCode&&this.httpStatusCode!==200){let f=hd(this.httpStatusCode);c=f.code,u=f.details}else c=me.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode} (Call ended without gRPC status)`;break;case wr.constants.NGHTTP2_REFUSED_STREAM:c=me.Status.UNAVAILABLE,u="Stream refused by server";break;case wr.constants.NGHTTP2_CANCEL:this.connectionDropped?(c=me.Status.UNAVAILABLE,u="Connection dropped"):(c=me.Status.CANCELLED,u="Call cancelled");break;case wr.constants.NGHTTP2_ENHANCE_YOUR_CALM:c=me.Status.RESOURCE_EXHAUSTED,u="Bandwidth exhausted or memory limit exceeded";break;case wr.constants.NGHTTP2_INADEQUATE_SECURITY:c=me.Status.PERMISSION_DENIED,u="Protocol not secure enough";break;case wr.constants.NGHTTP2_INTERNAL_ERROR:c=me.Status.INTERNAL,this.internalError===null?u=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:this.internalError.code==="ECONNRESET"||this.internalError.code==="ETIMEDOUT"?(c=me.Status.UNAVAILABLE,u=this.internalError.message):u=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:c=me.Status.INTERNAL,u=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:c,details:u,metadata:new Rr.Metadata,rstCode:e.rstCode})})}),e.on("error",l=>{l.code!=="ERR_HTTP2_STREAM_ERROR"&&(this.trace("Node error event: message="+l.message+" code="+l.code+" errno="+Uw(l.errno)+" syscall="+l.syscall),this.internalError=l),this.callEventTracker.onStreamEnd(!1)})}getDeadlineInfo(){return[`remote_addr=${this.getPeer()}`]}onDisconnect(){this.connectionDropped=!0,setImmediate(()=>{this.endCall({code:me.Status.UNAVAILABLE,details:"Connection dropped",metadata:new Rr.Metadata})})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){qw.trace(Bw.LogVerbosity.DEBUG,jw,"["+this.callId+"] "+e)}endCall(e){(this.finalStatus===null||this.finalStatus.code===me.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){this.finalStatus!==null&&(this.finalStatus.code!==me.Status.OK||this.readsClosed&&this.unpushedReadMessages.length===0&&!this.isReadFilterPending&&!this.isPushPending)&&this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,!this.statusOutput&&(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){this.serverEndedCall=!0,this.callEventTracker.onStreamEnd(!0);let r="";for(let o of Object.keys(e))r+="		"+o+": "+e[o]+`
`;this.trace(`Received server trailers:
`+r);let i;try{i=Rr.Metadata.fromHttp2Headers(e)}catch{i=new Rr.Metadata}let n=i.getMap(),s;if(typeof n["grpc-status"]=="string"){let o=Number(n["grpc-status"]);this.trace("received status code "+o+" from server"),i.remove("grpc-status");let a="";if(typeof n["grpc-message"]=="string"){try{a=decodeURI(n["grpc-message"])}catch{a=n["grpc-message"]}i.remove("grpc-message"),this.trace('received status details string "'+a+'" from server')}s={code:o,details:a,metadata:i}}else this.httpStatusCode?(s=hd(this.httpStatusCode),s.metadata=i):s={code:me.Status.UNKNOWN,details:"No status information received",metadata:i};this.endCall(s)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed)if(this.serverEndedCall)this.http2Stream.end();else{let r;((e=this.finalStatus)===null||e===void 0?void 0:e.code)===me.Status.OK?r=wr.constants.NGHTTP2_NO_ERROR:r=wr.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+r),this.http2Stream.close(r)}}cancelWithStatus(e,r){this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),this.endCall({code:e,details:r,metadata:new Rr.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(this.finalStatus!==null&&this.finalStatus.code!==me.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,r){this.trace("write() called with message of length "+r.length);let i=n=>{process.nextTick(()=>{var s;let o=me.Status.UNAVAILABLE;n?.code==="ERR_STREAM_WRITE_AFTER_END"&&(o=me.Status.INTERNAL),n&&this.cancelWithStatus(o,`Write error: ${n.message}`),(s=e.callback)===null||s===void 0||s.call(e)})};this.trace("sending data chunk of length "+r.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(r,i)}catch(n){this.endCall({code:me.Status.UNAVAILABLE,details:`Write failed with error ${n.message}`,metadata:new Rr.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}};xa.Http2SubchannelCall=fd});var gd=S(pd=>{"use strict";Object.defineProperty(pd,"__esModule",{value:!0});pd.getNextCallNumber=Hw;var zw=0;function Hw(){return zw++}});var Cy=S(Ma=>{"use strict";Object.defineProperty(Ma,"__esModule",{value:!0});Ma.Http2SubchannelConnector=void 0;var Pa=require("http2"),Oa=xi(),ws=ne(),Ww=cd(),_n=_e(),$w=Kt(),Aa=Et(),md=st(),Vw=require("net"),Gw=Sy(),Zw=gd(),yd="transport",Yw="transport_flowctrl",Jw=Vl().version,{HTTP2_HEADER_AUTHORITY:Kw,HTTP2_HEADER_CONTENT_TYPE:Xw,HTTP2_HEADER_METHOD:Qw,HTTP2_HEADER_PATH:e1,HTTP2_HEADER_TE:t1,HTTP2_HEADER_USER_AGENT:r1}=Pa.constants,i1=2e4,n1=Buffer.from("too_many_pings","ascii"),vd=class{constructor(e,r,i,n){this.session=e,this.options=i,this.remoteName=n,this.keepaliveTimer=null,this.pendingSendKeepalivePing=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,Aa.subchannelAddressToString)(r),i["grpc.enable_channelz"]===0?(this.channelzEnabled=!1,this.streamTracker=new Oa.ChannelzCallTrackerStub):this.streamTracker=new Oa.ChannelzCallTracker,this.channelzRef=(0,Oa.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[i["grpc.primary_user_agent"],`grpc-node-js/${Jw}`,i["grpc.secondary_user_agent"]].filter(s=>s).join(" "),"grpc.keepalive_time_ms"in i?this.keepaliveTimeMs=i["grpc.keepalive_time_ms"]:this.keepaliveTimeMs=-1,"grpc.keepalive_timeout_ms"in i?this.keepaliveTimeoutMs=i["grpc.keepalive_timeout_ms"]:this.keepaliveTimeoutMs=i1,"grpc.keepalive_permit_without_calls"in i?this.keepaliveWithoutCalls=i["grpc.keepalive_permit_without_calls"]===1:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.handleDisconnect()}),e.once("goaway",(s,o,a)=>{let l=!1;s===Pa.constants.NGHTTP2_ENHANCE_YOUR_CALM&&a&&a.equals(n1)&&(l=!0),this.trace("connection closed by GOAWAY with code "+s+" and data "+a?.toString()),this.reportDisconnectToOwner(l)}),e.once("error",s=>{this.trace("connection closed with error "+s.message),this.handleDisconnect()}),e.socket.once("close",s=>{this.trace("connection closed. hadError="+s),this.handleDisconnect()}),_n.isTracerEnabled(yd)&&(e.on("remoteSettings",s=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))}),e.on("localSettings",s=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(s))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,r,i;let n=this.session.socket,s=n.remoteAddress?(0,Aa.stringToSubchannelAddress)(n.remoteAddress,n.remotePort):null,o=n.localAddress?(0,Aa.stringToSubchannelAddress)(n.localAddress,n.localPort):null,a;if(this.session.encrypted){let c=n,u=c.getCipher(),f=c.getCertificate(),m=c.getPeerCertificate();a={cipherSuiteStandardName:(e=u.standardName)!==null&&e!==void 0?e:null,cipherSuiteOtherName:u.standardName?null:u.name,localCertificate:f&&"raw"in f?f.raw:null,remoteCertificate:m&&"raw"in m?m.raw:null}}else a=null;return{remoteAddress:s,localAddress:o,security:a,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:(r=this.session.state.localWindowSize)!==null&&r!==void 0?r:null,remoteFlowControlWindow:(i=this.session.state.remoteWindowSize)!==null&&i!==void 0?i:null}}trace(e){_n.trace(ws.LogVerbosity.DEBUG,yd,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){_n.trace(ws.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){_n.trace(ws.LogVerbosity.DEBUG,Yw,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){_n.trace(ws.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(r=>r(e)))}handleDisconnect(){this.clearKeepaliveTimeout(),this.reportDisconnectToOwner(!1);for(let e of this.activeCalls)e.onDisconnect();setImmediate(()=>{this.session.destroy()})}addDisconnectListener(e){this.disconnectListeners.push(e)}canSendPing(){return!this.session.destroyed&&this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,r;if(!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}if(this.keepaliveTimer){console.error("keepaliveTimeout is not null");return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimer=setTimeout(()=>{this.keepaliveTimer=null,this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),(r=(e=this.keepaliveTimer).unref)===null||r===void 0||r.call(e);let i="";try{this.session.ping((s,o,a)=>{this.clearKeepaliveTimeout(),s?(this.keepaliveTrace("Ping failed with error "+s.message),this.handleDisconnect()):(this.keepaliveTrace("Received ping response"),this.maybeStartKeepalivePingTimer())})||(i="Ping returned false")}catch(n){i=(n instanceof Error?n.message:"")||"Unknown error"}i&&(this.keepaliveTrace("Ping send failed: "+i),this.handleDisconnect())}maybeStartKeepalivePingTimer(){var e,r;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimer||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimer=setTimeout(()=>{this.keepaliveTimer=null,this.maybeSendPing()},this.keepaliveTimeMs),(r=(e=this.keepaliveTimer).unref)===null||r===void 0||r.call(e)))}clearKeepaliveTimeout(){this.keepaliveTimer&&(clearTimeout(this.keepaliveTimer),this.keepaliveTimer=null)}removeActiveCall(e){this.activeCalls.delete(e),this.activeCalls.size===0&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),this.activeCalls.size===1&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,r,i,n,s){let o=e.toHttp2Headers();o[Kw]=r,o[r1]=this.userAgent,o[Xw]="application/grpc",o[Qw]="POST",o[e1]=i,o[t1]="trailers";let a;try{a=this.session.request(o)}catch(u){throw this.handleDisconnect(),u}this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed);let l,c;return this.channelzEnabled?(this.streamTracker.addCallStarted(),l={addMessageSent:()=>{var u;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var f;(f=s.onCallEnd)===null||f===void 0||f.call(s,u),this.removeActiveCall(c)},onStreamEnd:u=>{var f;u?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),(f=s.onStreamEnd)===null||f===void 0||f.call(s,u)}}):l={addMessageSent:()=>{var u;(u=s.addMessageSent)===null||u===void 0||u.call(s)},addMessageReceived:()=>{var u;(u=s.addMessageReceived)===null||u===void 0||u.call(s)},onCallEnd:u=>{var f;(f=s.onCallEnd)===null||f===void 0||f.call(s,u),this.removeActiveCall(c)},onStreamEnd:u=>{var f;(f=s.onStreamEnd)===null||f===void 0||f.call(s,u)}},c=new Gw.Http2SubchannelCall(a,l,n,this,(0,Zw.getNextCallNumber)()),this.addActiveCall(c),c}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,Oa.unregisterChannelzRef)(this.channelzRef)}},_d=class{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){_n.trace(ws.LogVerbosity.DEBUG,yd,(0,md.uriToString)(this.channelTarget)+" "+e)}createSession(e,r,i){return this.isShutdown?Promise.reject():e.socket.closed?Promise.reject("Connection closed before starting HTTP/2 handshake"):new Promise((n,s)=>{var o;let a=null,l=this.channelTarget;if("grpc.http_connect_target"in i){let k=(0,md.parseUri)(i["grpc.http_connect_target"]);k&&(l=k,a=(0,md.uriToString)(k))}let c=e.secure?"https":"http",u=(0,$w.getDefaultAuthority)(l),f=()=>{var k;(k=this.session)===null||k===void 0||k.destroy(),this.session=null,setImmediate(()=>{C||(C=!0,s(`${T.trim()} (${new Date().toISOString()})`))})},m=k=>{var M;(M=this.session)===null||M===void 0||M.destroy(),T=k.message,this.trace("connection failed with error "+T),C||(C=!0,s(`${T} (${new Date().toISOString()})`))},_=Pa.connect(`${c}://${u}`,{createConnection:(k,M)=>e.socket,settings:{initialWindowSize:(o=i["grpc-node.flow_control_window"])!==null&&o!==void 0?o:Pa.getDefaultSettings().initialWindowSize}});this.session=_;let T="Failed to connect",C=!1;_.unref(),_.once("remoteSettings",()=>{_.removeAllListeners(),e.socket.removeListener("close",f),e.socket.removeListener("error",m),n(new vd(_,r,i,a)),this.session=null}),_.once("close",f),_.once("error",m),e.socket.once("close",f),e.socket.once("error",m)})}tcpConnect(e,r){return(0,Ww.getProxiedConnection)(e,r).then(i=>i||new Promise((n,s)=>{let o=()=>{s(new Error("Socket closed"))},a=c=>{s(c)},l=Vw.connect(e,()=>{l.removeListener("close",o),l.removeListener("error",a),n(l)});l.once("close",o),l.once("error",a)}))}async connect(e,r,i){if(this.isShutdown)return Promise.reject();let n=null,s=null,o=(0,Aa.subchannelAddressToString)(e);try{return this.trace(o+" Waiting for secureConnector to be ready"),await r.waitForReady(),this.trace(o+" secureConnector is ready"),n=await this.tcpConnect(e,i),this.trace(o+" Established TCP connection"),s=await r.connect(n),this.trace(o+" Established secure connection"),this.createSession(s,e,i)}catch(a){throw n?.destroy(),s?.socket.destroy(),a}}shutdown(){var e;this.isShutdown=!0,(e=this.session)===null||e===void 0||e.close(),this.session=null}};Ma.Http2SubchannelConnector=_d});var by=S(ks=>{"use strict";Object.defineProperty(ks,"__esModule",{value:!0});ks.SubchannelPool=void 0;ks.getSubchannelPool=h1;var s1=tp(),o1=dy(),a1=Et(),l1=st(),c1=Cy(),u1=1e4,Rs=class{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let r in this.pool){let n=this.pool[r].filter(s=>!s.subchannel.unrefIfOneRef());n.length>0&&(e=!1),this.pool[r]=n}e&&this.cleanupTimer!==null&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,r;this.cleanupTimer===null&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},u1),(r=(e=this.cleanupTimer).unref)===null||r===void 0||r.call(e))}getOrCreateSubchannel(e,r,i,n){this.ensureCleanupTask();let s=(0,l1.uriToString)(e);if(s in this.pool){let a=this.pool[s];for(let l of a)if((0,a1.subchannelAddressEqual)(r,l.subchannelAddress)&&(0,s1.channelOptionsEqual)(i,l.channelArguments)&&n._equals(l.channelCredentials))return l.subchannel}let o=new o1.Subchannel(e,r,i,n,new c1.Http2SubchannelConnector(e));return s in this.pool||(this.pool[s]=[]),this.pool[s].push({subchannelAddress:r,channelArguments:i,channelCredentials:n,subchannel:o}),o.ref(),o}};ks.SubchannelPool=Rs;var d1=new Rs;function h1(t){return t?d1:new Rs}});var Cd=S(Sn=>{"use strict";Object.defineProperty(Sn,"__esModule",{value:!0});Sn.FilterStackFactory=Sn.FilterStack=void 0;var Ia=class{constructor(e){this.filters=e}sendMetadata(e){let r=e;for(let i=0;i<this.filters.length;i++)r=this.filters[i].sendMetadata(r);return r}receiveMetadata(e){let r=e;for(let i=this.filters.length-1;i>=0;i--)r=this.filters[i].receiveMetadata(r);return r}sendMessage(e){let r=e;for(let i=0;i<this.filters.length;i++)r=this.filters[i].sendMessage(r);return r}receiveMessage(e){let r=e;for(let i=this.filters.length-1;i>=0;i--)r=this.filters[i].receiveMessage(r);return r}receiveTrailers(e){let r=e;for(let i=this.filters.length-1;i>=0;i--)r=this.filters[i].receiveTrailers(r);return r}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}};Sn.FilterStack=Ia;var Sd=class t{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new t([...this.factories])}createFilter(){return new Ia(this.factories.map(e=>e.createFilter()))}};Sn.FilterStackFactory=Sd});var bd=S(Na=>{"use strict";Object.defineProperty(Na,"__esModule",{value:!0});Na.CompressionAlgorithms=void 0;var Ey;(function(t){t[t.identity=0]="identity",t[t.deflate=1]="deflate",t[t.gzip=2]="gzip"})(Ey||(Na.CompressionAlgorithms=Ey={}))});var Td=S(Da=>{"use strict";Object.defineProperty(Da,"__esModule",{value:!0});Da.BaseFilter=void 0;var Ed=class{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}};Da.BaseFilter=Ed});var Ry=S(En=>{"use strict";Object.defineProperty(En,"__esModule",{value:!0});En.CompressionFilterFactory=En.CompressionFilter=void 0;var La=require("zlib"),wy=bd(),Cn=ne(),f1=Td(),p1=_e(),g1=t=>typeof t=="number"&&typeof wy.CompressionAlgorithms[t]=="string",bn=class{async writeMessage(e,r){let i=e;r&&(i=await this.compressMessage(i));let n=Buffer.allocUnsafe(i.length+5);return n.writeUInt8(r?1:0,0),n.writeUInt32BE(i.length,1),i.copy(n,5),n}async readMessage(e){let r=e.readUInt8(0)===1,i=e.slice(5);return r&&(i=await this.decompressMessage(i)),i}},Ai=class extends bn{async compressMessage(e){return e}async writeMessage(e,r){let i=Buffer.allocUnsafe(e.length+5);return i.writeUInt8(0,0),i.writeUInt32BE(e.length,1),e.copy(i,5),i}decompressMessage(e){return Promise.reject(new Error('Received compressed message but "grpc-encoding" header was identity'))}},wd=class extends bn{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((r,i)=>{La.deflate(e,(n,s)=>{n?i(n):r(s)})})}decompressMessage(e){return new Promise((r,i)=>{let n=0,s=[],o=La.createInflate();o.on("data",a=>{s.push(a),n+=a.byteLength,this.maxRecvMessageLength!==-1&&n>this.maxRecvMessageLength&&(o.destroy(),i({code:Cn.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{r(Buffer.concat(s))}),o.write(e),o.end()})}},Rd=class extends bn{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((r,i)=>{La.gzip(e,(n,s)=>{n?i(n):r(s)})})}decompressMessage(e){return new Promise((r,i)=>{let n=0,s=[],o=La.createGunzip();o.on("data",a=>{s.push(a),n+=a.byteLength,this.maxRecvMessageLength!==-1&&n>this.maxRecvMessageLength&&(o.destroy(),i({code:Cn.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{r(Buffer.concat(s))}),o.write(e),o.end()})}},kd=class extends bn{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(new Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(new Error(`Compression method not supported: ${this.compressionName}`))}};function Ty(t,e){switch(t){case"identity":return new Ai;case"deflate":return new wd(e);case"gzip":return new Rd(e);default:return new kd(t)}}var Fa=class extends f1.BaseFilter{constructor(e,r){var i,n,s;super(),this.sharedFilterConfig=r,this.sendCompression=new Ai,this.receiveCompression=new Ai,this.currentCompressionAlgorithm="identity";let o=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=(i=e["grpc.max_receive_message_length"])!==null&&i!==void 0?i:Cn.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.maxSendMessageLength=(n=e["grpc.max_send_message_length"])!==null&&n!==void 0?n:Cn.DEFAULT_MAX_SEND_MESSAGE_LENGTH,o!==void 0)if(g1(o)){let a=wy.CompressionAlgorithms[o],l=(s=r.serverSupportedEncodingHeader)===null||s===void 0?void 0:s.split(",");(!l||l.includes(a))&&(this.currentCompressionAlgorithm=a,this.sendCompression=Ty(this.currentCompressionAlgorithm,-1))}else p1.log(Cn.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${o}`)}async sendMetadata(e){let r=await e;return r.set("grpc-accept-encoding","identity,deflate,gzip"),r.set("accept-encoding","identity"),this.currentCompressionAlgorithm==="identity"?r.remove("grpc-encoding"):r.set("grpc-encoding",this.currentCompressionAlgorithm),r}receiveMetadata(e){let r=e.get("grpc-encoding");if(r.length>0){let n=r[0];typeof n=="string"&&(this.receiveCompression=Ty(n,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let i=e.get("grpc-accept-encoding")[0];return i&&(this.sharedFilterConfig.serverSupportedEncodingHeader=i,i.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new Ai,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var r;let i=await e;if(this.maxSendMessageLength!==-1&&i.message.length>this.maxSendMessageLength)throw{code:Cn.Status.RESOURCE_EXHAUSTED,details:`Attempted to send message with a size larger than ${this.maxSendMessageLength}`};let n;return this.sendCompression instanceof Ai?n=!1:n=(((r=i.flags)!==null&&r!==void 0?r:0)&2)===0,{message:await this.sendCompression.writeMessage(i.message,n),flags:i.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}};En.CompressionFilter=Fa;var xd=class{constructor(e,r){this.options=r,this.sharedFilterConfig={}}createFilter(){return new Fa(this.options,this.sharedFilterConfig)}};En.CompressionFilterFactory=xd});var xs=S(Pi=>{"use strict";Object.defineProperty(Pi,"__esModule",{value:!0});Pi.minDeadline=m1;Pi.getDeadlineTimeoutString=v1;Pi.getRelativeTimeout=S1;Pi.deadlineToString=C1;Pi.formatDateDifference=b1;function m1(...t){let e=1/0;for(let r of t){let i=r instanceof Date?r.getTime():r;i<e&&(e=i)}return e}var y1=[["m",1],["S",1e3],["M",60*1e3],["H",60*60*1e3]];function v1(t){let e=new Date().getTime();t instanceof Date&&(t=t.getTime());let r=Math.max(t-e,0);for(let[i,n]of y1){let s=r/n;if(s<1e8)return String(Math.ceil(s))+i}throw new Error("Deadline is too far in the future")}var _1=2147483647;function S1(t){let e=t instanceof Date?t.getTime():t,r=new Date().getTime(),i=e-r;return i<0?0:i>_1?1/0:i}function C1(t){if(t instanceof Date)return t.toISOString();{let e=new Date(t);return Number.isNaN(e.getTime())?""+t:e.toISOString()}}function b1(t,e){return((e.getTime()-t.getTime())/1e3).toFixed(3)+"s"}});var qa=S(Od=>{"use strict";Object.defineProperty(Od,"__esModule",{value:!0});Od.restrictControlPlaneStatusCode=T1;var hr=ne(),E1=[hr.Status.OK,hr.Status.INVALID_ARGUMENT,hr.Status.NOT_FOUND,hr.Status.ALREADY_EXISTS,hr.Status.FAILED_PRECONDITION,hr.Status.ABORTED,hr.Status.OUT_OF_RANGE,hr.Status.DATA_LOSS];function T1(t,e){return E1.includes(t)?{code:hr.Status.INTERNAL,details:`Invalid status from control plane: ${t} ${hr.Status[t]} ${e}`}:{code:t,details:e}}});var Oy=S(Ua=>{"use strict";Object.defineProperty(Ua,"__esModule",{value:!0});Ua.LoadBalancingCall=void 0;var ky=bt(),Ba=ne(),xy=xs(),ja=Ke(),Os=Fr(),w1=st(),R1=_e(),Ad=qa(),k1=require("http2"),x1="load_balancing_call",Pd=class{constructor(e,r,i,n,s,o,a){var l,c;this.channel=e,this.callConfig=r,this.methodName=i,this.host=n,this.credentials=s,this.deadline=o,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null,this.childStartTime=null;let u=this.methodName.split("/"),f="";u.length>=2&&(f=u[1]);let m=(c=(l=(0,w1.splitHostPort)(this.host))===null||l===void 0?void 0:l.host)!==null&&c!==void 0?c:"localhost";this.serviceUrl=`https://${m}/${f}`,this.startTime=new Date}getDeadlineInfo(){var e,r;let i=[];return this.childStartTime?(this.childStartTime>this.startTime&&(!((e=this.metadata)===null||e===void 0)&&e.getOptions().waitForReady&&i.push("wait_for_ready"),i.push(`LB pick: ${(0,xy.formatDateDifference)(this.startTime,this.childStartTime)}`)),i.push(...this.child.getDeadlineInfo()),i):(!((r=this.metadata)===null||r===void 0)&&r.getOptions().waitForReady&&i.push("wait_for_ready"),i.push("Waiting for LB pick"),i)}trace(e){R1.trace(Ba.LogVerbosity.DEBUG,x1,"["+this.callNumber+"] "+e)}outputStatus(e,r){var i,n;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'" start time='+this.startTime.toISOString());let s=Object.assign(Object.assign({},e),{progress:r});(i=this.listener)===null||i===void 0||i.onReceiveStatus(s),(n=this.onCallEnded)===null||n===void 0||n.call(this,s.code)}}doPick(){var e,r;if(this.ended)return;if(!this.metadata)throw new Error("doPick called before start");this.trace("Pick called");let i=this.metadata.clone(),n=this.channel.doPick(i,this.callConfig.pickInformation),s=n.subchannel?"("+n.subchannel.getChannelzRef().id+") "+n.subchannel.getAddress():""+n.subchannel;switch(this.trace("Pick result: "+Os.PickResultType[n.pickResultType]+" subchannel: "+s+" status: "+((e=n.status)===null||e===void 0?void 0:e.code)+" "+((r=n.status)===null||r===void 0?void 0:r.details)),n.pickResultType){case Os.PickResultType.COMPLETE:this.credentials.compose(n.subchannel.getCallCredentials()).generateMetadata({method_name:this.methodName,service_url:this.serviceUrl}).then(c=>{var u;if(this.ended){this.trace("Credentials metadata generation finished after call ended");return}if(i.merge(c),i.get("authorization").length>1&&this.outputStatus({code:Ba.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new ja.Metadata},"PROCESSED"),n.subchannel.getConnectivityState()!==ky.ConnectivityState.READY){this.trace("Picked subchannel "+s+" has state "+ky.ConnectivityState[n.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&i.set("grpc-timeout",(0,xy.getDeadlineTimeoutString)(this.deadline));try{this.child=n.subchannel.getRealSubchannel().createCall(i,this.host,this.methodName,{onReceiveMetadata:f=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(f)},onReceiveMessage:f=>{this.trace("Received message"),this.listener.onReceiveMessage(f)},onReceiveStatus:f=>{this.trace("Received status"),f.rstCode===k1.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(f,"REFUSED"):this.outputStatus(f,"PROCESSED")}}),this.childStartTime=new Date}catch(f){this.trace("Failed to start call on picked subchannel "+s+" with error "+f.message),this.outputStatus({code:Ba.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+f.message,metadata:new ja.Metadata},"NOT_STARTED");return}(u=n.onCallStarted)===null||u===void 0||u.call(n),this.onCallEnded=n.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},c=>{let{code:u,details:f}=(0,Ad.restrictControlPlaneStatusCode)(typeof c.code=="number"?c.code:Ba.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${c.message}`);this.outputStatus({code:u,details:f,metadata:new ja.Metadata},"PROCESSED")});break;case Os.PickResultType.DROP:let{code:a,details:l}=(0,Ad.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:a,details:l,metadata:n.status.metadata},"DROP")});break;case Os.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:c,details:u}=(0,Ad.restrictControlPlaneStatusCode)(n.status.code,n.status.details);setImmediate(()=>{this.outputStatus({code:c,details:u,metadata:n.status.metadata},"PROCESSED")})}break;case Os.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,r){var i;this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,r),this.outputStatus({code:e,details:r,metadata:new ja.Metadata},"PROCESSED")}getPeer(){var e,r;return(r=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:this.channel.getTarget()}start(e,r){this.trace("start called"),this.listener=r,this.metadata=e,this.doPick()}sendMessageWithContext(e,r){this.trace("write() called with message of length "+r.length),this.child?this.child.sendMessageWithContext(e,r):this.pendingMessage={context:e,message:r}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw new Error("Method not implemented.")}getCallNumber(){return this.callNumber}};Ua.LoadBalancingCall=Pd});var Py=S(za=>{"use strict";Object.defineProperty(za,"__esModule",{value:!0});za.ResolvingCall=void 0;var O1=So(),Mi=ne(),Ii=xs(),Ay=Ke(),A1=_e(),P1=qa(),M1="resolving_call",Md=class{constructor(e,r,i,n,s){this.channel=e,this.method=r,this.filterStackFactory=n,this.callNumber=s,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadlineStartTime=null,this.configReceivedTime=null,this.childStartTime=null,this.credentials=O1.CallCredentials.createEmpty(),this.deadline=i.deadline,this.host=i.host,i.parentCall&&(i.flags&Mi.Propagate.CANCELLATION&&i.parentCall.on("cancelled",()=>{this.cancelWithStatus(Mi.Status.CANCELLED,"Cancelled by parent call")}),i.flags&Mi.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+i.parentCall.getDeadline()),this.deadline=(0,Ii.minDeadline)(this.deadline,i.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){A1.trace(Mi.LogVerbosity.DEBUG,M1,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.deadlineStartTime=new Date,this.trace("Deadline: "+(0,Ii.deadlineToString)(this.deadline));let e=(0,Ii.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let r=()=>{if(!this.deadlineStartTime){this.cancelWithStatus(Mi.Status.DEADLINE_EXCEEDED,"Deadline exceeded");return}let i=[],n=new Date;i.push(`Deadline exceeded after ${(0,Ii.formatDateDifference)(this.deadlineStartTime,n)}`),this.configReceivedTime?(this.configReceivedTime>this.deadlineStartTime&&i.push(`name resolution: ${(0,Ii.formatDateDifference)(this.deadlineStartTime,this.configReceivedTime)}`),this.childStartTime?this.childStartTime>this.configReceivedTime&&i.push(`metadata filters: ${(0,Ii.formatDateDifference)(this.configReceivedTime,this.childStartTime)}`):i.push("waiting for metadata filters")):i.push("waiting for name resolution"),this.child&&i.push(...this.child.getDeadlineInfo()),this.cancelWithStatus(Mi.Status.DEADLINE_EXCEEDED,i.join(","))};e<=0?process.nextTick(r):this.deadlineTimer=setTimeout(r,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let r=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+r.code+' details="'+r.details+'"'),this.statusWatchers.forEach(i=>i(r)),process.nextTick(()=>{var i;(i=this.listener)===null||i===void 0||i.onReceiveStatus(r)})}}sendMessageOnChild(e,r){if(!this.child)throw new Error("sendMessageonChild called with child not populated");let i=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:r,flags:e.flags})).then(n=>{this.writeFilterPending=!1,i.sendMessageWithContext(e,n.message),this.pendingHalfClose&&i.halfClose()},n=>{this.cancelWithStatus(n.code,n.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw new Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if(e.type==="NONE"){this.channel.queueCallForConfig(this);return}else if(e.type==="ERROR"){this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error);return}this.configReceivedTime=new Date;let r=e.config;if(r.status!==Mi.Status.OK){let{code:i,details:n}=(0,P1.restrictControlPlaneStatusCode)(r.status,"Failed to route call to method "+this.method);this.outputStatus({code:i,details:n,metadata:new Ay.Metadata});return}if(r.methodConfig.timeout){let i=new Date;i.setSeconds(i.getSeconds()+r.methodConfig.timeout.seconds),i.setMilliseconds(i.getMilliseconds()+r.methodConfig.timeout.nanos/1e6),this.deadline=(0,Ii.minDeadline)(this.deadline,i),this.runDeadlineTimer()}this.filterStackFactory.push(r.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(i=>{this.child=this.channel.createRetryingCall(r,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.childStartTime=new Date,this.child.start(i,{onReceiveMetadata:n=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(n))},onReceiveMessage:n=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(n).then(s=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(s),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},s=>{this.cancelWithStatus(s.code,s.details)})},onReceiveStatus:n=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=n:this.outputStatus(n)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},i=>{this.outputStatus(i)})}reportResolverError(e){var r;!((r=this.metadata)===null||r===void 0)&&r.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,r){var i;this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),(i=this.child)===null||i===void 0||i.cancelWithStatus(e,r),this.outputStatus({code:e,details:r,metadata:new Ay.Metadata})}getPeer(){var e,r;return(r=(e=this.child)===null||e===void 0?void 0:e.getPeer())!==null&&r!==void 0?r:this.channel.getTarget()}start(e,r){this.trace("start called"),this.metadata=e.clone(),this.listener=r,this.getConfig()}sendMessageWithContext(e,r){this.trace("write() called with message of length "+r.length),this.child?this.sendMessageOnChild(e,r):this.pendingMessage={context:e,message:r}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=e}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}};za.ResolvingCall=Md});var My=S(Yr=>{"use strict";Object.defineProperty(Yr,"__esModule",{value:!0});Yr.RetryingCall=Yr.MessageBufferTracker=Yr.RetryThrottler=void 0;var Ha=ne(),I1=xs(),N1=Ke(),D1=_e(),L1="retrying_call",Nd=class{constructor(e,r,i){this.maxTokens=e,this.tokenRatio=r,i?this.tokens=i.tokens*(e/i.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.min(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.max(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}};Yr.RetryThrottler=Nd;var Dd=class{constructor(e,r){this.totalLimit=e,this.limitPerCall=r,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,r){var i;let n=(i=this.allocatedPerCall.get(r))!==null&&i!==void 0?i:0;return this.limitPerCall-n<e||this.totalLimit-this.totalAllocated<e?!1:(this.allocatedPerCall.set(r,n+e),this.totalAllocated+=e,!0)}free(e,r){var i;if(this.totalAllocated<e)throw new Error(`Invalid buffer allocation state: call ${r} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let n=(i=this.allocatedPerCall.get(r))!==null&&i!==void 0?i:0;if(n<e)throw new Error(`Invalid buffer allocation state: call ${r} freed ${e} > allocated for call ${n}`);this.allocatedPerCall.set(r,n-e)}freeAll(e){var r;let i=(r=this.allocatedPerCall.get(e))!==null&&r!==void 0?r:0;if(this.totalAllocated<i)throw new Error(`Invalid buffer allocation state: call ${e} allocated ${i} > total allocated ${this.totalAllocated}`);this.totalAllocated-=i,this.allocatedPerCall.delete(e)}};Yr.MessageBufferTracker=Dd;var Id="grpc-previous-rpc-attempts",F1=5,Ld=class{constructor(e,r,i,n,s,o,a,l,c){var u;this.channel=e,this.callConfig=r,this.methodName=i,this.host=n,this.credentials=s,this.deadline=o,this.callNumber=a,this.bufferTracker=l,this.retryThrottler=c,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0;let f=(u=e.getOptions()["grpc-node.retry_max_attempts_limit"])!==null&&u!==void 0?u:F1;if(e.getOptions()["grpc.enable_retries"]===0)this.state="NO_RETRY",this.maxAttempts=1;else if(r.methodConfig.retryPolicy){this.state="RETRY";let m=r.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(m.initialBackoff.substring(0,m.initialBackoff.length-1)),this.maxAttempts=Math.min(m.maxAttempts,f)}else r.methodConfig.hedgingPolicy?(this.state="HEDGING",this.maxAttempts=Math.min(r.methodConfig.hedgingPolicy.maxAttempts,f)):(this.state="TRANSPARENT_ONLY",this.maxAttempts=1);this.startTime=new Date}getDeadlineInfo(){if(this.underlyingCalls.length===0)return[];let e=[],r=this.underlyingCalls[this.underlyingCalls.length-1];return this.underlyingCalls.length>1&&e.push(`previous attempts: ${this.underlyingCalls.length-1}`),r.startTime>this.startTime&&e.push(`time to current attempt start: ${(0,I1.formatDateDifference)(this.startTime,r.startTime)}`),e.push(...r.call.getDeadlineInfo()),e}getCallNumber(){return this.callNumber}trace(e){D1.trace(Ha.LogVerbosity.DEBUG,L1,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'" start time='+this.startTime.toISOString()),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var r;(r=this.listener)===null||r===void 0||r.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,r){this.trace("cancelWithStatus code: "+e+' details: "'+r+'"'),this.reportStatus({code:e,details:r,metadata:new N1.Metadata});for(let{call:i}of this.underlyingCalls)i.cancelWithStatus(e,r)}getPeer(){return this.committedCallIndex!==null?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var r;return(r=this.writeBuffer[e-this.writeBufferOffset])!==null&&r!==void 0?r:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if(this.state!=="COMMITTED")return;let e;this.underlyingCalls[this.committedCallIndex].state==="COMPLETED"?e=this.getNextBufferIndex():e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let r=this.writeBufferOffset;r<e;r++){let i=this.getBufferEntry(r);i.allocated&&this.bufferTracker.free(i.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){var r,i;if(this.state!=="COMMITTED"){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",(i=(r=this.callConfig).onCommitted)===null||i===void 0||i.call(r),this.committedCallIndex=e;for(let n=0;n<this.underlyingCalls.length;n++)n!==e&&this.underlyingCalls[n].state!=="COMPLETED"&&(this.underlyingCalls[n].state="COMPLETED",this.underlyingCalls[n].call.cancelWithStatus(Ha.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if(this.state==="COMMITTED")return;let e=-1,r=-1;for(let[i,n]of this.underlyingCalls.entries())n.state==="ACTIVE"&&n.nextMessageToSend>e&&(e=n.nextMessageToSend,r=i);r===-1?this.state="TRANSPARENT_ONLY":this.commitCall(r)}isStatusCodeInList(e,r){return e.some(i=>{var n;return i===r||i.toString().toLowerCase()===((n=Ha.Status[r])===null||n===void 0?void 0:n.toLowerCase())})}getNextRetryBackoffMs(){var e;let r=(e=this.callConfig)===null||e===void 0?void 0:e.methodConfig.retryPolicy;if(!r)return 0;let i=Math.random()*this.nextRetryBackoffSec*1e3,n=Number(r.maxBackoff.substring(0,r.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*r.backoffMultiplier,n),i}maybeRetryCall(e,r){if(this.state!=="RETRY"){r(!1);return}if(this.attempts>=this.maxAttempts){r(!1);return}let i;if(e===null)i=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",r(!1);return}else i=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var n,s;if(this.state!=="RETRY"){r(!1);return}!((s=(n=this.retryThrottler)===null||n===void 0?void 0:n.canRetryCall())!==null&&s!==void 0)||s?(r(!0),this.attempts+=1,this.startNewAttempt()):(this.trace("Retry attempt denied by throttling policy"),r(!1))},i)}countActiveCalls(){let e=0;for(let r of this.underlyingCalls)r?.state==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,r,i){var n,s,o;switch(this.state){case"COMMITTED":case"NO_RETRY":case"TRANSPARENT_ONLY":this.commitCall(r),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList((n=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)!==null&&n!==void 0?n:[],e.code)){(s=this.retryThrottler)===null||s===void 0||s.addCallFailed();let a;if(i===null)a=0;else if(i<0){this.state="TRANSPARENT_ONLY",this.commitCall(r),this.reportStatus(e);return}else a=i;setTimeout(()=>{this.maybeStartHedgingAttempt(),this.countActiveCalls()===0&&(this.commitCall(r),this.reportStatus(e))},a)}else this.commitCall(r),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?((o=this.retryThrottler)===null||o===void 0||o.addCallFailed(),this.maybeRetryCall(i,a=>{a||(this.commitCall(r),this.reportStatus(e))})):(this.commitCall(r),this.reportStatus(e));break}}getPushback(e){let r=e.get("grpc-retry-pushback-ms");if(r.length===0)return null;try{return parseInt(r[0])}catch{return-1}}handleChildStatus(e,r){var i;if(this.underlyingCalls[r].state==="COMPLETED")return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[r].call.getCallNumber()+"] in state "+this.underlyingCalls[r].state),this.underlyingCalls[r].state="COMPLETED",e.code===Ha.Status.OK){(i=this.retryThrottler)===null||i===void 0||i.addCallSucceeded(),this.commitCall(r),this.reportStatus(e);return}if(this.state==="NO_RETRY"){this.commitCall(r),this.reportStatus(e);return}if(this.state==="COMMITTED"){this.reportStatus(e);return}let n=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,r,n):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(r),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,r,n);break}}maybeStartHedgingAttempt(){this.state==="HEDGING"&&this.callConfig.methodConfig.hedgingPolicy&&(this.attempts>=this.maxAttempts||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()))}maybeStartHedgingTimer(){var e,r,i;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),this.state!=="HEDGING"||!this.callConfig.methodConfig.hedgingPolicy)return;let n=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=this.maxAttempts)return;let s=(e=n.hedgingDelay)!==null&&e!==void 0?e:"0s",o=Number(s.substring(0,s.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},o*1e3),(i=(r=this.hedgingTimer).unref)===null||i===void 0||i.call(r)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let r=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0,startTime:new Date});let i=this.attempts-1,n=this.initialMetadata.clone();i>0&&n.set(Id,`${i}`);let s=!1;e.start(n,{onReceiveMetadata:o=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(r),s=!0,i>0&&o.set(Id,`${i}`),this.underlyingCalls[r].state==="ACTIVE"&&this.listener.onReceiveMetadata(o)},onReceiveMessage:o=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(r),this.underlyingCalls[r].state==="ACTIVE"&&this.listener.onReceiveMessage(o)},onReceiveStatus:o=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!s&&i>0&&o.metadata.set(Id,`${i}`),this.handleChildStatus(o,r)}}),this.sendNextChildMessage(r),this.readStarted&&e.startRead()}start(e,r){this.trace("start called"),this.listener=r,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var r,i;let n=this.underlyingCalls[e],s=n.nextMessageToSend;(i=(r=this.getBufferEntry(s)).callback)===null||i===void 0||i.call(r),this.clearSentMessages(),n.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let r=this.underlyingCalls[e];if(r.state!=="COMPLETED"&&this.getBufferEntry(r.nextMessageToSend)){let i=this.getBufferEntry(r.nextMessageToSend);switch(i.entryType){case"MESSAGE":r.call.sendMessageWithContext({callback:n=>{this.handleChildWriteCompleted(e)}},i.message.message);break;case"HALF_CLOSE":r.nextMessageToSend+=1,r.call.halfClose();break;case"FREED":break}}}sendMessageWithContext(e,r){var i;this.trace("write() called with message of length "+r.length);let n={message:r,flags:e.flags},s=this.getNextBufferIndex(),o={entryType:"MESSAGE",message:n,allocated:this.bufferTracker.allocate(r.length,this.callNumber)};if(this.writeBuffer.push(o),o.allocated){(i=e.callback)===null||i===void 0||i.call(e);for(let[a,l]of this.underlyingCalls.entries())l.state==="ACTIVE"&&l.nextMessageToSend===s&&l.call.sendMessageWithContext({callback:c=>{this.handleChildWriteCompleted(a)}},r)}else{if(this.commitCallWithMostMessages(),this.committedCallIndex===null)return;let a=this.underlyingCalls[this.committedCallIndex];o.callback=e.callback,a.state==="ACTIVE"&&a.nextMessageToSend===s&&a.call.sendMessageWithContext({callback:l=>{this.handleChildWriteCompleted(this.committedCallIndex)}},r)}}startRead(){this.trace("startRead called"),this.readStarted=!0;for(let e of this.underlyingCalls)e?.state==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1});for(let r of this.underlyingCalls)r?.state==="ACTIVE"&&r.nextMessageToSend===e&&(r.nextMessageToSend+=1,r.call.halfClose())}setCredentials(e){throw new Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}};Yr.RetryingCall=Ld});var $a=S(Wa=>{"use strict";Object.defineProperty(Wa,"__esModule",{value:!0});Wa.BaseSubchannelWrapper=void 0;var Fd=class{constructor(e){this.child=e,this.healthy=!0,this.healthListeners=new Set,e.addHealthStateWatcher(r=>{this.healthy&&this.updateHealthListeners()})}updateHealthListeners(){for(let e of this.healthListeners)e(this.isHealthy())}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}isHealthy(){return this.healthy&&this.child.isHealthy()}addHealthStateWatcher(e){this.healthListeners.add(e)}removeHealthStateWatcher(e){this.healthListeners.delete(e)}setHealthy(e){e!==this.healthy&&(this.healthy=e,this.child.isHealthy()&&this.updateHealthListeners())}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}getCallCredentials(){return this.child.getCallCredentials()}};Wa.BaseSubchannelWrapper=Fd});var $d=S(Ni=>{"use strict";Object.defineProperty(Ni,"__esModule",{value:!0});Ni.InternalChannel=Ni.SUBCHANNEL_ARGS_EXCLUDE_KEY_PREFIX=void 0;var q1=Gn(),B1=ep(),j1=by(),jd=Fr(),U1=Ke(),Jr=ne(),z1=Cd(),H1=Ry(),Iy=Kt(),Va=_e(),W1=cd(),Ga=st(),Ot=bt(),As=xi(),$1=Oy(),V1=xs(),G1=Py(),qd=gd(),Z1=qa(),Bd=My(),Y1=$a(),J1=2147483647,K1=1e3,X1=30*60*1e3,Za=new Map,Q1=1<<24,eR=1<<20,Ud=class extends Y1.BaseSubchannelWrapper{constructor(e,r){super(e),this.channel=r,this.refCount=0,this.subchannelStateListener=(i,n,s,o)=>{r.throttleKeepalive(o)}}ref(){this.refCount===0&&(this.child.addConnectivityStateListener(this.subchannelStateListener),this.channel.addWrappedSubchannel(this)),this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}},zd=class{pick(e){return{pickResultType:jd.PickResultType.DROP,status:{code:Jr.Status.UNAVAILABLE,details:"Channel closed before call started",metadata:new U1.Metadata},subchannel:null,onCallStarted:null,onCallEnded:null}}};Ni.SUBCHANNEL_ARGS_EXCLUDE_KEY_PREFIX="grpc.internal.no_subchannel";var Hd=class{constructor(e){this.target=e,this.trace=new As.ChannelzTrace,this.callTracker=new As.ChannelzCallTracker,this.childrenTracker=new As.ChannelzChildrenTracker,this.state=Ot.ConnectivityState.IDLE}getChannelzInfoCallback(){return()=>({target:this.target,state:this.state,trace:this.trace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()})}},Wd=class{constructor(e,r,i){var n,s,o,a,l,c;if(this.credentials=r,this.options=i,this.connectivityState=Ot.ConnectivityState.IDLE,this.currentPicker=new jd.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.callRefTimer=null,this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.randomChannelId=Math.floor(Math.random()*Number.MAX_SAFE_INTEGER),typeof e!="string")throw new TypeError("Channel target must be a string");if(!(r instanceof q1.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.channelzInfoTracker=new Hd(e);let u=(0,Ga.parseUri)(e);if(u===null)throw new Error(`Could not parse target name "${e}"`);let f=(0,Iy.mapUriDefaultScheme)(u);if(f===null)throw new Error(`Could not find a default scheme for target name "${e}"`);this.options["grpc.enable_channelz"]===0&&(this.channelzEnabled=!1),this.channelzRef=(0,As.registerChannelzChannel)(e,this.channelzInfoTracker.getChannelzInfoCallback(),this.channelzEnabled),this.channelzEnabled&&this.channelzInfoTracker.trace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,Iy.getDefaultAuthority)(f);let m=(0,W1.mapProxyName)(f,i);this.target=m.target,this.options=Object.assign({},this.options,m.extraOptions),this.subchannelPool=(0,j1.getSubchannelPool)(((n=this.options["grpc.use_local_subchannel_pool"])!==null&&n!==void 0?n:0)===0),this.retryBufferTracker=new Bd.MessageBufferTracker((s=this.options["grpc.retry_buffer_size"])!==null&&s!==void 0?s:Q1,(o=this.options["grpc.per_rpc_retry_buffer_size"])!==null&&o!==void 0?o:eR),this.keepaliveTime=(a=this.options["grpc.keepalive_time_ms"])!==null&&a!==void 0?a:-1,this.idleTimeoutMs=Math.max((l=this.options["grpc.client_idle_timeout_ms"])!==null&&l!==void 0?l:X1,K1);let _={createSubchannel:(C,k)=>{let M={};for(let[j,re]of Object.entries(k))j.startsWith(Ni.SUBCHANNEL_ARGS_EXCLUDE_KEY_PREFIX)||(M[j]=re);let P=this.subchannelPool.getOrCreateSubchannel(this.target,C,M,this.credentials);return P.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzInfoTracker.trace.addTrace("CT_INFO","Created subchannel or used existing subchannel",P.getChannelzRef()),new Ud(P,this)},updateState:(C,k)=>{this.currentPicker=k;let M=this.pickQueue.slice();this.pickQueue=[],M.length>0&&this.callRefTimerUnref();for(let P of M)P.doPick();this.updateState(C)},requestReresolution:()=>{throw new Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:C=>{this.channelzEnabled&&this.channelzInfoTracker.childrenTracker.refChild(C)},removeChannelzChild:C=>{this.channelzEnabled&&this.channelzInfoTracker.childrenTracker.unrefChild(C)}};this.resolvingLoadBalancer=new B1.ResolvingLoadBalancer(this.target,_,this.options,(C,k)=>{var M;C.retryThrottling?Za.set(this.getTarget(),new Bd.RetryThrottler(C.retryThrottling.maxTokens,C.retryThrottling.tokenRatio,Za.get(this.getTarget()))):Za.delete(this.getTarget()),this.channelzEnabled&&this.channelzInfoTracker.trace.addTrace("CT_INFO","Address resolution succeeded"),(M=this.configSelector)===null||M===void 0||M.unref(),this.configSelector=k,this.currentResolutionError=null,process.nextTick(()=>{let P=this.configSelectionQueue;this.configSelectionQueue=[],P.length>0&&this.callRefTimerUnref();for(let X of P)X.getConfig()})},C=>{this.channelzEnabled&&this.channelzInfoTracker.trace.addTrace("CT_WARNING","Address resolution failed with code "+C.code+' and details "'+C.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),this.configSelector===null&&(this.currentResolutionError=Object.assign(Object.assign({},(0,Z1.restrictControlPlaneStatusCode)(C.code,C.details)),{metadata:C.metadata}));let k=this.configSelectionQueue;this.configSelectionQueue=[],k.length>0&&this.callRefTimerUnref();for(let M of k)M.reportResolverError(C)}),this.filterStackFactory=new z1.FilterStackFactory([new H1.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(i,void 0,2));let T=new Error;(0,Va.isTracerEnabled)("channel_stacktrace")&&(0,Va.trace)(Jr.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+`) Channel constructed 
`+((c=T.stack)===null||c===void 0?void 0:c.substring(T.stack.indexOf(`
`)+1))),this.lastActivityTimestamp=new Date}trace(e,r){(0,Va.trace)(r??Jr.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,Ga.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,r,i,n;this.callRefTimer||(this.callRefTimer=setInterval(()=>{},J1)),!((r=(e=this.callRefTimer).hasRef)===null||r===void 0)&&r.call(e)||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(n=(i=this.callRefTimer).ref)===null||n===void 0||n.call(i))}callRefTimerUnref(){var e,r,i;(!(!((e=this.callRefTimer)===null||e===void 0)&&e.hasRef)||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),(i=(r=this.callRefTimer)===null||r===void 0?void 0:r.unref)===null||i===void 0||i.call(r))}removeConnectivityStateWatcher(e){let r=this.connectivityStateWatchers.findIndex(i=>i===e);r>=0&&this.connectivityStateWatchers.splice(r,1)}updateState(e){(0,Va.trace)(Jr.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,Ga.uriToString)(this.target)+" "+Ot.ConnectivityState[this.connectivityState]+" -> "+Ot.ConnectivityState[e]),this.channelzEnabled&&this.channelzInfoTracker.trace.addTrace("CT_INFO","Connectivity state change to "+Ot.ConnectivityState[e]),this.connectivityState=e,this.channelzInfoTracker.state=e;let r=this.connectivityStateWatchers.slice();for(let i of r)e!==i.currentState&&(i.timer&&clearTimeout(i.timer),this.removeConnectivityStateWatcher(i),i.callback());e!==Ot.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime){this.keepaliveTime=e;for(let r of this.wrappedSubchannels)r.throttleKeepalive(e)}}addWrappedSubchannel(e){this.wrappedSubchannels.add(e)}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,r){return this.currentPicker.pick({metadata:e,extraPickInfo:r})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,r){return this.connectivityState!==Ot.ConnectivityState.SHUTDOWN&&this.resolvingLoadBalancer.exitIdle(),this.configSelector?{type:"SUCCESS",config:this.configSelector.invoke(e,r,this.randomChannelId)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(Ot.ConnectivityState.IDLE),this.currentPicker=new jd.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null),this.callRefTimer&&(clearInterval(this.callRefTimer),this.callRefTimer=null)}startIdleTimeout(e){var r,i;this.idleTimer=setTimeout(()=>{if(this.callCount>0){this.startIdleTimeout(this.idleTimeoutMs);return}let s=new Date().valueOf()-this.lastActivityTimestamp.valueOf();s>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-s)},e),(i=(r=this.idleTimer).unref)===null||i===void 0||i.call(r)}maybeStartIdleTimer(){this.connectivityState!==Ot.ConnectivityState.SHUTDOWN&&!this.idleTimer&&this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.channelzInfoTracker.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===Jr.Status.OK?this.channelzInfoTracker.callTracker.addCallSucceeded():this.channelzInfoTracker.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,r,i,n,s){let o=(0,qd.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+o+'] method="'+r+'"'),new $1.LoadBalancingCall(this,e,r,i,n,s,o)}createRetryingCall(e,r,i,n,s){let o=(0,qd.getNextCallNumber)();return this.trace("createRetryingCall ["+o+'] method="'+r+'"'),new Bd.RetryingCall(this,e,r,i,n,s,o,this.retryBufferTracker,Za.get(this.getTarget()))}createResolvingCall(e,r,i,n,s){let o=(0,qd.getNextCallNumber)();this.trace("createResolvingCall ["+o+'] method="'+e+'", deadline='+(0,V1.deadlineToString)(r));let a={deadline:r,flags:s??Jr.Propagate.DEFAULTS,host:i??this.defaultAuthority,parentCall:n},l=new G1.ResolvingCall(this,e,a,this.filterStackFactory.clone(),o);return this.onCallStart(),l.addStatusWatcher(c=>{this.onCallEnd(c)}),l}close(){var e;this.resolvingLoadBalancer.destroy(),this.updateState(Ot.ConnectivityState.SHUTDOWN),this.currentPicker=new zd;for(let r of this.configSelectionQueue)r.cancelWithStatus(Jr.Status.UNAVAILABLE,"Channel closed before call started");this.configSelectionQueue=[];for(let r of this.pickQueue)r.cancelWithStatus(Jr.Status.UNAVAILABLE,"Channel closed before call started");this.pickQueue=[],this.callRefTimer&&clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,As.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels(),(e=this.configSelector)===null||e===void 0||e.unref(),this.configSelector=null}getTarget(){return(0,Ga.uriToString)(this.target)}getConnectivityState(e){let r=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),r}watchConnectivityState(e,r,i){if(this.connectivityState===Ot.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");let n=null;if(r!==1/0){let o=r instanceof Date?r:new Date(r),a=new Date;if(r===-1/0||o<=a){process.nextTick(i,new Error("Deadline passed without connectivity state change"));return}n=setTimeout(()=>{this.removeConnectivityStateWatcher(s),i(new Error("Deadline passed without connectivity state change"))},o.getTime()-a.getTime())}let s={currentState:e,callback:i,timer:n};this.connectivityStateWatchers.push(s)}getChannelzRef(){return this.channelzRef}createCall(e,r,i,n,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof r=="number"||r instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===Ot.ConnectivityState.SHUTDOWN)throw new Error("Channel has been shut down");return this.createResolvingCall(e,r,i,n,s)}getOptions(){return this.options}};Ni.InternalChannel=Wd});var Hc=S(Ya=>{"use strict";Object.defineProperty(Ya,"__esModule",{value:!0});Ya.ChannelImplementation=void 0;var tR=Gn(),rR=$d(),Vd=class{constructor(e,r,i){if(typeof e!="string")throw new TypeError("Channel target must be a string");if(!(r instanceof tR.ChannelCredentials))throw new TypeError("Channel credentials must be a ChannelCredentials object");if(i&&typeof i!="object")throw new TypeError("Channel options must be an object");this.internalChannel=new rR.InternalChannel(e,r,i)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,r,i){this.internalChannel.watchConnectivityState(e,r,i)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,r,i,n,s){if(typeof e!="string")throw new TypeError("Channel#createCall: method must be a string");if(!(typeof r=="number"||r instanceof Date))throw new TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,r,i,n,s)}};Ya.ChannelImplementation=Vd});var Dy=S($t=>{"use strict";Object.defineProperty($t,"__esModule",{value:!0});$t.ServerDuplexStreamImpl=$t.ServerWritableStreamImpl=$t.ServerReadableStreamImpl=$t.ServerUnaryCallImpl=void 0;$t.serverErrorToStatus=Qd;var iR=require("events"),Kd=require("stream"),Xd=ne(),Ny=Ke();function Qd(t,e){var r;let i={code:Xd.Status.UNKNOWN,details:"message"in t?t.message:"Unknown Error",metadata:(r=e??t.metadata)!==null&&r!==void 0?r:null};return"code"in t&&typeof t.code=="number"&&Number.isInteger(t.code)&&(i.code=t.code,"details"in t&&typeof t.details=="string"&&(i.details=t.details)),i}var Gd=class extends iR.EventEmitter{constructor(e,r,i,n){super(),this.path=e,this.call=r,this.metadata=i,this.request=n,this.cancelled=!1}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}getHost(){return this.call.getHost()}};$t.ServerUnaryCallImpl=Gd;var Zd=class extends Kd.Readable{constructor(e,r,i){super({objectMode:!0}),this.path=e,this.call=r,this.metadata=i,this.cancelled=!1}_read(e){this.call.startRead()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}getHost(){return this.call.getHost()}};$t.ServerReadableStreamImpl=Zd;var Yd=class extends Kd.Writable{constructor(e,r,i,n){super({objectMode:!0}),this.path=e,this.call=r,this.metadata=i,this.request=n,this.pendingStatus={code:Xd.Status.OK,details:"OK"},this.cancelled=!1,this.trailingMetadata=new Ny.Metadata,this.on("error",s=>{this.pendingStatus=Qd(s),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}getHost(){return this.call.getHost()}_write(e,r,i){this.call.sendMessage(e,i)}_final(e){var r;e(null),this.call.sendStatus(Object.assign(Object.assign({},this.pendingStatus),{metadata:(r=this.pendingStatus.metadata)!==null&&r!==void 0?r:this.trailingMetadata}))}end(e){return e&&(this.trailingMetadata=e),super.end()}};$t.ServerWritableStreamImpl=Yd;var Jd=class extends Kd.Duplex{constructor(e,r,i){super({objectMode:!0}),this.path=e,this.call=r,this.metadata=i,this.pendingStatus={code:Xd.Status.OK,details:"OK"},this.cancelled=!1,this.trailingMetadata=new Ny.Metadata,this.on("error",n=>{this.pendingStatus=Qd(n),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.path}getHost(){return this.call.getHost()}_read(e){this.call.startRead()}_write(e,r,i){this.call.sendMessage(e,i)}_final(e){var r;e(null),this.call.sendStatus(Object.assign(Object.assign({},this.pendingStatus),{metadata:(r=this.pendingStatus.metadata)!==null&&r!==void 0?r:this.trailingMetadata}))}end(e){return e&&(this.trailingMetadata=e),super.end()}};$t.ServerDuplexStreamImpl=Jd});var Ja=S(Tn=>{"use strict";Object.defineProperty(Tn,"__esModule",{value:!0});Tn.ServerCredentials=void 0;Tn.createCertificateProviderServerCredentials=nR;Tn.createServerCredentialsWithInterceptors=sR;var eh=nc(),Di=class{constructor(e,r){this.serverConstructorOptions=e,this.watchers=new Set,this.latestContextOptions=null,this.latestContextOptions=r??null}_addWatcher(e){this.watchers.add(e)}_removeWatcher(e){this.watchers.delete(e)}getWatcherCount(){return this.watchers.size}updateSecureContextOptions(e){this.latestContextOptions=e;for(let r of this.watchers)r(this.latestContextOptions)}_isSecure(){return this.serverConstructorOptions!==null}_getSecureContextOptions(){return this.latestContextOptions}_getConstructorOptions(){return this.serverConstructorOptions}_getInterceptors(){return[]}static createInsecure(){return new th}static createSsl(e,r,i=!1){var n;if(e!==null&&!Buffer.isBuffer(e))throw new TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(r))throw new TypeError("keyCertPairs must be an array");if(typeof i!="boolean")throw new TypeError("checkClientCertificate must be a boolean");let s=[],o=[];for(let a=0;a<r.length;a++){let l=r[a];if(l===null||typeof l!="object")throw new TypeError(`keyCertPair[${a}] must be an object`);if(!Buffer.isBuffer(l.private_key))throw new TypeError(`keyCertPair[${a}].private_key must be a Buffer`);if(!Buffer.isBuffer(l.cert_chain))throw new TypeError(`keyCertPair[${a}].cert_chain must be a Buffer`);s.push(l.cert_chain),o.push(l.private_key)}return new rh({requestCert:i,ciphers:eh.CIPHER_SUITES},{ca:(n=e??(0,eh.getDefaultRootsData)())!==null&&n!==void 0?n:void 0,cert:s,key:o})}};Tn.ServerCredentials=Di;var th=class t extends Di{constructor(){super(null)}_getSettings(){return null}_equals(e){return e instanceof t}},rh=class t extends Di{constructor(e,r){super(e,r),this.options=Object.assign(Object.assign({},e),r)}_equals(e){if(this===e)return!0;if(!(e instanceof t))return!1;if(Buffer.isBuffer(this.options.ca)&&Buffer.isBuffer(e.options.ca)){if(!this.options.ca.equals(e.options.ca))return!1}else if(this.options.ca!==e.options.ca)return!1;if(Array.isArray(this.options.cert)&&Array.isArray(e.options.cert)){if(this.options.cert.length!==e.options.cert.length)return!1;for(let r=0;r<this.options.cert.length;r++){let i=this.options.cert[r],n=e.options.cert[r];if(Buffer.isBuffer(i)&&Buffer.isBuffer(n)){if(!i.equals(n))return!1}else if(i!==n)return!1}}else if(this.options.cert!==e.options.cert)return!1;if(Array.isArray(this.options.key)&&Array.isArray(e.options.key)){if(this.options.key.length!==e.options.key.length)return!1;for(let r=0;r<this.options.key.length;r++){let i=this.options.key[r],n=e.options.key[r];if(Buffer.isBuffer(i)&&Buffer.isBuffer(n)){if(!i.equals(n))return!1}else if(i!==n)return!1}}else if(this.options.key!==e.options.key)return!1;return this.options.requestCert===e.options.requestCert}},ih=class t extends Di{constructor(e,r,i){super({requestCert:r!==null,rejectUnauthorized:i,ciphers:eh.CIPHER_SUITES}),this.identityCertificateProvider=e,this.caCertificateProvider=r,this.requireClientCertificate=i,this.latestCaUpdate=null,this.latestIdentityUpdate=null,this.caCertificateUpdateListener=this.handleCaCertificateUpdate.bind(this),this.identityCertificateUpdateListener=this.handleIdentityCertitificateUpdate.bind(this)}_addWatcher(e){var r;this.getWatcherCount()===0&&((r=this.caCertificateProvider)===null||r===void 0||r.addCaCertificateListener(this.caCertificateUpdateListener),this.identityCertificateProvider.addIdentityCertificateListener(this.identityCertificateUpdateListener)),super._addWatcher(e)}_removeWatcher(e){var r;super._removeWatcher(e),this.getWatcherCount()===0&&((r=this.caCertificateProvider)===null||r===void 0||r.removeCaCertificateListener(this.caCertificateUpdateListener),this.identityCertificateProvider.removeIdentityCertificateListener(this.identityCertificateUpdateListener))}_equals(e){return this===e?!0:e instanceof t?this.caCertificateProvider===e.caCertificateProvider&&this.identityCertificateProvider===e.identityCertificateProvider&&this.requireClientCertificate===e.requireClientCertificate:!1}calculateSecureContextOptions(){var e;return this.latestIdentityUpdate===null||this.caCertificateProvider!==null&&this.latestCaUpdate===null?null:{ca:(e=this.latestCaUpdate)===null||e===void 0?void 0:e.caCertificate,cert:[this.latestIdentityUpdate.certificate],key:[this.latestIdentityUpdate.privateKey]}}finalizeUpdate(){let e=this.calculateSecureContextOptions();this.updateSecureContextOptions(e)}handleCaCertificateUpdate(e){this.latestCaUpdate=e,this.finalizeUpdate()}handleIdentityCertitificateUpdate(e){this.latestIdentityUpdate=e,this.finalizeUpdate()}};function nR(t,e,r){return new ih(t,e,r)}var nh=class t extends Di{constructor(e,r){super({}),this.childCredentials=e,this.interceptors=r}_isSecure(){return this.childCredentials._isSecure()}_equals(e){if(!(e instanceof t)||!this.childCredentials._equals(e.childCredentials)||this.interceptors.length!==e.interceptors.length)return!1;for(let r=0;r<this.interceptors.length;r++)if(this.interceptors[r]!==e.interceptors[r])return!1;return!0}_getInterceptors(){return this.interceptors}_addWatcher(e){this.childCredentials._addWatcher(e)}_removeWatcher(e){this.childCredentials._removeWatcher(e)}_getConstructorOptions(){return this.childCredentials._getConstructorOptions()}_getSecureContextOptions(){return this.childCredentials._getSecureContextOptions()}};function sR(t,e){return new nh(t,e)}});var hh=S(At=>{"use strict";Object.defineProperty(At,"__esModule",{value:!0});At.BaseServerInterceptingCall=At.ServerInterceptingCall=At.ResponderBuilder=At.ServerListenerBuilder=void 0;At.isInterceptingServerListener=aR;At.getServerInterceptingCall=hR;var oh=Ke(),lt=ne(),wn=require("http2"),Ly=mo(),Fy=require("zlib"),oR=dd(),Uy=_e(),zy="server_call";function Li(t){Uy.trace(lt.LogVerbosity.DEBUG,zy,t)}var ah=class{constructor(){this.metadata=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveHalfClose(e){return this.halfClose=e,this}withOnCancel(e){return this.cancel=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveHalfClose:this.halfClose,onCancel:this.cancel}}};At.ServerListenerBuilder=ah;function aR(t){return t.onReceiveMetadata!==void 0&&t.onReceiveMetadata.length===1}var lh=class{constructor(e,r){this.listener=e,this.nextListener=r,this.cancelled=!1,this.processingMetadata=!1,this.hasPendingMessage=!1,this.pendingMessage=null,this.processingMessage=!1,this.hasPendingHalfClose=!1}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingHalfClose(){this.hasPendingHalfClose&&(this.nextListener.onReceiveHalfClose(),this.hasPendingHalfClose=!1)}onReceiveMetadata(e){this.cancelled||(this.processingMetadata=!0,this.listener.onReceiveMetadata(e,r=>{this.processingMetadata=!1,!this.cancelled&&(this.nextListener.onReceiveMetadata(r),this.processPendingMessage(),this.processPendingHalfClose())}))}onReceiveMessage(e){this.cancelled||(this.processingMessage=!0,this.listener.onReceiveMessage(e,r=>{this.processingMessage=!1,!this.cancelled&&(this.processingMetadata?(this.pendingMessage=r,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(r),this.processPendingHalfClose()))}))}onReceiveHalfClose(){this.cancelled||this.listener.onReceiveHalfClose(()=>{this.cancelled||(this.processingMetadata||this.processingMessage?this.hasPendingHalfClose=!0:this.nextListener.onReceiveHalfClose())})}onCancel(){this.cancelled=!0,this.listener.onCancel(),this.nextListener.onCancel()}},ch=class{constructor(){this.start=void 0,this.metadata=void 0,this.message=void 0,this.status=void 0}withStart(e){return this.start=e,this}withSendMetadata(e){return this.metadata=e,this}withSendMessage(e){return this.message=e,this}withSendStatus(e){return this.status=e,this}build(){return{start:this.start,sendMetadata:this.metadata,sendMessage:this.message,sendStatus:this.status}}};At.ResponderBuilder=ch;var Ka={onReceiveMetadata:(t,e)=>{e(t)},onReceiveMessage:(t,e)=>{e(t)},onReceiveHalfClose:t=>{t()},onCancel:()=>{}},Xa={start:t=>{t()},sendMetadata:(t,e)=>{e(t)},sendMessage:(t,e)=>{e(t)},sendStatus:(t,e)=>{e(t)}},uh=class{constructor(e,r){var i,n,s,o;this.nextCall=e,this.processingMetadata=!1,this.sentMetadata=!1,this.processingMessage=!1,this.pendingMessage=null,this.pendingMessageCallback=null,this.pendingStatus=null,this.responder={start:(i=r?.start)!==null&&i!==void 0?i:Xa.start,sendMetadata:(n=r?.sendMetadata)!==null&&n!==void 0?n:Xa.sendMetadata,sendMessage:(s=r?.sendMessage)!==null&&s!==void 0?s:Xa.sendMessage,sendStatus:(o=r?.sendStatus)!==null&&o!==void 0?o:Xa.sendStatus}}processPendingMessage(){this.pendingMessageCallback&&(this.nextCall.sendMessage(this.pendingMessage,this.pendingMessageCallback),this.pendingMessage=null,this.pendingMessageCallback=null)}processPendingStatus(){this.pendingStatus&&(this.nextCall.sendStatus(this.pendingStatus),this.pendingStatus=null)}start(e){this.responder.start(r=>{var i,n,s,o;let a={onReceiveMetadata:(i=r?.onReceiveMetadata)!==null&&i!==void 0?i:Ka.onReceiveMetadata,onReceiveMessage:(n=r?.onReceiveMessage)!==null&&n!==void 0?n:Ka.onReceiveMessage,onReceiveHalfClose:(s=r?.onReceiveHalfClose)!==null&&s!==void 0?s:Ka.onReceiveHalfClose,onCancel:(o=r?.onCancel)!==null&&o!==void 0?o:Ka.onCancel},l=new lh(a,e);this.nextCall.start(l)})}sendMetadata(e){this.processingMetadata=!0,this.sentMetadata=!0,this.responder.sendMetadata(e,r=>{this.processingMetadata=!1,this.nextCall.sendMetadata(r),this.processPendingMessage(),this.processPendingStatus()})}sendMessage(e,r){this.processingMessage=!0,this.sentMetadata||this.sendMetadata(new oh.Metadata),this.responder.sendMessage(e,i=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=i,this.pendingMessageCallback=r):this.nextCall.sendMessage(i,r)})}sendStatus(e){this.responder.sendStatus(e,r=>{this.processingMetadata||this.processingMessage?this.pendingStatus=r:this.nextCall.sendStatus(r)})}startRead(){this.nextCall.startRead()}getPeer(){return this.nextCall.getPeer()}getDeadline(){return this.nextCall.getDeadline()}getHost(){return this.nextCall.getHost()}};At.ServerInterceptingCall=uh;var Hy="grpc-accept-encoding",dh="grpc-encoding",qy="grpc-message",By="grpc-status",sh="grpc-timeout",lR=/(\d{1,8})\s*([HMSmun])/,cR={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},uR={[Hy]:"identity,deflate,gzip",[dh]:"identity"},jy={[wn.constants.HTTP2_HEADER_STATUS]:wn.constants.HTTP_STATUS_OK,[wn.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},dR={waitForTrailers:!0},Qa=class{constructor(e,r,i,n,s){var o;this.stream=e,this.callEventTracker=i,this.handler=n,this.listener=null,this.deadlineTimer=null,this.deadline=1/0,this.maxSendMessageSize=lt.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=lt.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.cancelled=!1,this.metadataSent=!1,this.wantTrailers=!1,this.cancelNotified=!1,this.incomingEncoding="identity",this.readQueue=[],this.isReadPending=!1,this.receivedHalfClose=!1,this.streamEnded=!1,this.stream.once("error",u=>{}),this.stream.once("close",()=>{var u;Li("Request to method "+((u=this.handler)===null||u===void 0?void 0:u.path)+" stream closed with rstCode "+this.stream.rstCode),this.callEventTracker&&!this.streamEnded&&(this.streamEnded=!0,this.callEventTracker.onStreamEnd(!1),this.callEventTracker.onCallEnd({code:lt.Status.CANCELLED,details:"Stream closed before sending status",metadata:null})),this.notifyOnCancel()}),this.stream.on("data",u=>{this.handleDataFrame(u)}),this.stream.pause(),this.stream.on("end",()=>{this.handleEndEvent()}),"grpc.max_send_message_length"in s&&(this.maxSendMessageSize=s["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in s&&(this.maxReceiveMessageSize=s["grpc.max_receive_message_length"]),this.host=(o=r[":authority"])!==null&&o!==void 0?o:r.host,this.decoder=new oR.StreamDecoder(this.maxReceiveMessageSize);let a=oh.Metadata.fromHttp2Headers(r);Uy.isTracerEnabled(zy)&&Li("Request to "+this.handler.path+" received headers "+JSON.stringify(a.toJSON()));let l=a.get(sh);l.length>0&&this.handleTimeoutHeader(l[0]);let c=a.get(dh);c.length>0&&(this.incomingEncoding=c[0]),a.remove(sh),a.remove(dh),a.remove(Hy),a.remove(wn.constants.HTTP2_HEADER_ACCEPT_ENCODING),a.remove(wn.constants.HTTP2_HEADER_TE),a.remove(wn.constants.HTTP2_HEADER_CONTENT_TYPE),this.metadata=a}handleTimeoutHeader(e){let r=e.toString().match(lR);if(r===null){let s={code:lt.Status.INTERNAL,details:`Invalid ${sh} value "${e}"`,metadata:null};process.nextTick(()=>{this.sendStatus(s)});return}let i=+r[1]*cR[r[2]]|0,n=new Date;this.deadline=n.setMilliseconds(n.getMilliseconds()+i),this.deadlineTimer=setTimeout(()=>{let s={code:lt.Status.DEADLINE_EXCEEDED,details:"Deadline exceeded",metadata:null};this.sendStatus(s)},i)}checkCancelled(){return!this.cancelled&&(this.stream.destroyed||this.stream.closed)&&(this.notifyOnCancel(),this.cancelled=!0),this.cancelled}notifyOnCancel(){this.cancelNotified||(this.cancelNotified=!0,this.cancelled=!0,process.nextTick(()=>{var e;(e=this.listener)===null||e===void 0||e.onCancel()}),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.resume())}maybeSendMetadata(){this.metadataSent||this.sendMetadata(new oh.Metadata)}serializeMessage(e){let r=this.handler.serialize(e),i=r.byteLength,n=Buffer.allocUnsafe(i+5);return n.writeUInt8(0,0),n.writeUInt32BE(i,1),r.copy(n,5),n}decompressMessage(e,r){let i=e.subarray(5);if(r==="identity")return i;if(r==="deflate"||r==="gzip"){let n;return r==="deflate"?n=Fy.createInflate():n=Fy.createGunzip(),new Promise((s,o)=>{let a=0,l=[];n.on("data",c=>{l.push(c),a+=c.byteLength,this.maxReceiveMessageSize!==-1&&a>this.maxReceiveMessageSize&&(n.destroy(),o({code:lt.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),n.on("end",()=>{s(Buffer.concat(l))}),n.write(i),n.end()})}else return Promise.reject({code:lt.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${r}"`})}async decompressAndMaybePush(e){if(e.type!=="COMPRESSED")throw new Error(`Invalid queue entry type: ${e.type}`);let i=e.compressedMessage.readUInt8(0)===1?this.incomingEncoding:"identity",n;try{n=await this.decompressMessage(e.compressedMessage,i)}catch(s){this.sendStatus(s);return}try{e.parsedMessage=this.handler.deserialize(n)}catch(s){this.sendStatus({code:lt.Status.INTERNAL,details:`Error deserializing request: ${s.message}`});return}e.type="READABLE",this.maybePushNextMessage()}maybePushNextMessage(){if(this.listener&&this.isReadPending&&this.readQueue.length>0&&this.readQueue[0].type!=="COMPRESSED"){this.isReadPending=!1;let e=this.readQueue.shift();e.type==="READABLE"?this.listener.onReceiveMessage(e.parsedMessage):this.listener.onReceiveHalfClose()}}handleDataFrame(e){var r;if(this.checkCancelled())return;Li("Request to "+this.handler.path+" received data frame of size "+e.length);let i;try{i=this.decoder.write(e)}catch(n){this.sendStatus({code:lt.Status.RESOURCE_EXHAUSTED,details:n.message});return}for(let n of i){this.stream.pause();let s={type:"COMPRESSED",compressedMessage:n,parsedMessage:null};this.readQueue.push(s),this.decompressAndMaybePush(s),(r=this.callEventTracker)===null||r===void 0||r.addMessageReceived()}}handleEndEvent(){this.readQueue.push({type:"HALF_CLOSE",compressedMessage:null,parsedMessage:null}),this.receivedHalfClose=!0,this.maybePushNextMessage()}start(e){Li("Request to "+this.handler.path+" start called"),!this.checkCancelled()&&(this.listener=e,e.onReceiveMetadata(this.metadata))}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let r=e?e.toHttp2Headers():null,i=Object.assign(Object.assign(Object.assign({},jy),uR),r);this.stream.respond(i,dR)}sendMessage(e,r){if(this.checkCancelled())return;let i;try{i=this.serializeMessage(e)}catch(n){this.sendStatus({code:lt.Status.INTERNAL,details:`Error serializing response: ${(0,Ly.getErrorMessage)(n)}`,metadata:null});return}if(this.maxSendMessageSize!==-1&&i.length-5>this.maxSendMessageSize){this.sendStatus({code:lt.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${i.length} vs. ${this.maxSendMessageSize})`,metadata:null});return}this.maybeSendMetadata(),Li("Request to "+this.handler.path+" sent data frame of size "+i.length),this.stream.write(i,n=>{var s;if(n){this.sendStatus({code:lt.Status.INTERNAL,details:`Error writing message: ${(0,Ly.getErrorMessage)(n)}`,metadata:null});return}(s=this.callEventTracker)===null||s===void 0||s.addMessageSent(),r()})}sendStatus(e){var r,i;if(!this.checkCancelled())if(Li("Request to method "+((r=this.handler)===null||r===void 0?void 0:r.path)+" ended with status code: "+lt.Status[e.code]+" details: "+e.details),this.metadataSent)this.wantTrailers?this.notifyOnCancel():(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var n;this.callEventTracker&&!this.streamEnded&&(this.streamEnded=!0,this.callEventTracker.onStreamEnd(!0),this.callEventTracker.onCallEnd(e));let s=Object.assign({[By]:e.code,[qy]:encodeURI(e.details)},(n=e.metadata)===null||n===void 0?void 0:n.toHttp2Headers());this.stream.sendTrailers(s),this.notifyOnCancel()}),this.stream.end());else{this.callEventTracker&&!this.streamEnded&&(this.streamEnded=!0,this.callEventTracker.onStreamEnd(!0),this.callEventTracker.onCallEnd(e));let n=Object.assign(Object.assign({[By]:e.code,[qy]:encodeURI(e.details)},jy),(i=e.metadata)===null||i===void 0?void 0:i.toHttp2Headers());this.stream.respond(n,{endStream:!0}),this.notifyOnCancel()}}startRead(){Li("Request to "+this.handler.path+" startRead called"),!this.checkCancelled()&&(this.isReadPending=!0,this.readQueue.length===0?this.receivedHalfClose||this.stream.resume():this.maybePushNextMessage())}getPeer(){var e;let r=(e=this.stream.session)===null||e===void 0?void 0:e.socket;return r?.remoteAddress?r.remotePort?`${r.remoteAddress}:${r.remotePort}`:r.remoteAddress:"unknown"}getDeadline(){return this.deadline}getHost(){return this.host}};At.BaseServerInterceptingCall=Qa;function hR(t,e,r,i,n,s){let o={path:n.path,requestStream:n.type==="clientStream"||n.type==="bidi",responseStream:n.type==="serverStream"||n.type==="bidi",requestDeserialize:n.deserialize,responseSerialize:n.serialize},a=new Qa(e,r,i,n,s);return t.reduce((l,c)=>c(o,l),a)}});var Jy=S(Xr=>{"use strict";var fR=Xr&&Xr.__runInitializers||function(t,e,r){for(var i=arguments.length>2,n=0;n<e.length;n++)r=i?e[n].call(t,r):e[n].call(t);return i?r:void 0},pR=Xr&&Xr.__esDecorate||function(t,e,r,i,n,s){function o(M){if(M!==void 0&&typeof M!="function")throw new TypeError("Function expected");return M}for(var a=i.kind,l=a==="getter"?"get":a==="setter"?"set":"value",c=!e&&t?i.static?t:t.prototype:null,u=e||(c?Object.getOwnPropertyDescriptor(c,i.name):{}),f,m=!1,_=r.length-1;_>=0;_--){var T={};for(var C in i)T[C]=C==="access"?{}:i[C];for(var C in i.access)T.access[C]=i.access[C];T.addInitializer=function(M){if(m)throw new TypeError("Cannot add initializers after decoration has completed");s.push(o(M||null))};var k=(0,r[_])(a==="accessor"?{get:u.get,set:u.set}:u[l],T);if(a==="accessor"){if(k===void 0)continue;if(k===null||typeof k!="object")throw new TypeError("Object expected");(f=o(k.get))&&(u.get=f),(f=o(k.set))&&(u.set=f),(f=o(k.init))&&n.unshift(f)}else(f=o(k))&&(a==="field"?n.unshift(f):u[l]=f)}c&&Object.defineProperty(c,i.name,u),m=!0};Object.defineProperty(Xr,"__esModule",{value:!0});Xr.Server=void 0;var ct=require("http2"),gR=require("util"),Ne=ne(),xn=Dy(),fh=Ja(),Wy=Kt(),kn=_e(),Kr=Et(),Vt=st(),je=xi(),$y=hh(),Rn=~(1<<31),ph=~(1<<31),mR=2e4,Vy=~(1<<31),{HTTP2_HEADER_PATH:Gy}=ct.constants,yR="server",Zy=Buffer.from("max_age");function Yy(t){kn.trace(Ne.LogVerbosity.DEBUG,"server_call",t)}function vR(){}function _R(t){return function(e,r){return gR.deprecate(e,t)}}function gh(t){return{code:Ne.Status.UNIMPLEMENTED,details:`The server does not implement the method ${t}`}}function SR(t,e){let r=gh(e);switch(t){case"unary":return(i,n)=>{n(r,null)};case"clientStream":return(i,n)=>{n(r,null)};case"serverStream":return i=>{i.emit("error",r)};case"bidi":return i=>{i.emit("error",r)};default:throw new Error(`Invalid handlerType ${t}`)}}var CR=(()=>{var t;let e=[],r;return t=class{constructor(n){var s,o,a,l,c,u;this.boundPorts=(fR(this,e),new Map),this.http2Servers=new Map,this.sessionIdleTimeouts=new Map,this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.options=n??{},this.options["grpc.enable_channelz"]===0?(this.channelzEnabled=!1,this.channelzTrace=new je.ChannelzTraceStub,this.callTracker=new je.ChannelzCallTrackerStub,this.listenerChildrenTracker=new je.ChannelzChildrenTrackerStub,this.sessionChildrenTracker=new je.ChannelzChildrenTrackerStub):(this.channelzTrace=new je.ChannelzTrace,this.callTracker=new je.ChannelzCallTracker,this.listenerChildrenTracker=new je.ChannelzChildrenTracker,this.sessionChildrenTracker=new je.ChannelzChildrenTracker),this.channelzRef=(0,je.registerChannelzServer)("server",()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=(s=this.options["grpc.max_connection_age_ms"])!==null&&s!==void 0?s:Rn,this.maxConnectionAgeGraceMs=(o=this.options["grpc.max_connection_age_grace_ms"])!==null&&o!==void 0?o:Rn,this.keepaliveTimeMs=(a=this.options["grpc.keepalive_time_ms"])!==null&&a!==void 0?a:ph,this.keepaliveTimeoutMs=(l=this.options["grpc.keepalive_timeout_ms"])!==null&&l!==void 0?l:mR,this.sessionIdleTimeout=(c=this.options["grpc.max_connection_idle_ms"])!==null&&c!==void 0?c:Vy,this.commonServerOptions={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER},"grpc-node.max_session_memory"in this.options?this.commonServerOptions.maxSessionMemory=this.options["grpc-node.max_session_memory"]:this.commonServerOptions.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(this.commonServerOptions.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]}),this.interceptors=(u=this.options.interceptors)!==null&&u!==void 0?u:[],this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfo(n){var s,o,a;let l=this.sessions.get(n),c=n.socket,u=c.remoteAddress?(0,Kr.stringToSubchannelAddress)(c.remoteAddress,c.remotePort):null,f=c.localAddress?(0,Kr.stringToSubchannelAddress)(c.localAddress,c.localPort):null,m;if(n.encrypted){let T=c,C=T.getCipher(),k=T.getCertificate(),M=T.getPeerCertificate();m={cipherSuiteStandardName:(s=C.standardName)!==null&&s!==void 0?s:null,cipherSuiteOtherName:C.standardName?null:C.name,localCertificate:k&&"raw"in k?k.raw:null,remoteCertificate:M&&"raw"in M?M.raw:null}}else m=null;return{remoteAddress:u,localAddress:f,security:m,remoteName:null,streamsStarted:l.streamTracker.callsStarted,streamsSucceeded:l.streamTracker.callsSucceeded,streamsFailed:l.streamTracker.callsFailed,messagesSent:l.messagesSent,messagesReceived:l.messagesReceived,keepAlivesSent:l.keepAlivesSent,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:l.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:l.lastMessageSentTimestamp,lastMessageReceivedTimestamp:l.lastMessageReceivedTimestamp,localFlowControlWindow:(o=n.state.localWindowSize)!==null&&o!==void 0?o:null,remoteFlowControlWindow:(a=n.state.remoteWindowSize)!==null&&a!==void 0?a:null}}trace(n){kn.trace(Ne.LogVerbosity.DEBUG,yR,"("+this.channelzRef.id+") "+n)}keepaliveTrace(n){kn.trace(Ne.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+n)}addProtoService(){throw new Error("Not implemented. Use addService() instead")}addService(n,s){if(n===null||typeof n!="object"||s===null||typeof s!="object")throw new Error("addService() requires two objects as arguments");let o=Object.keys(n);if(o.length===0)throw new Error("Cannot add an empty service to a server");o.forEach(a=>{let l=n[a],c;l.requestStream?l.responseStream?c="bidi":c="clientStream":l.responseStream?c="serverStream":c="unary";let u=s[a],f;if(u===void 0&&typeof l.originalName=="string"&&(u=s[l.originalName]),u!==void 0?f=u.bind(s):f=SR(c,a),this.register(l.path,f,l.responseSerialize,l.requestDeserialize,c)===!1)throw new Error(`Method handler for ${l.path} already provided.`)})}removeService(n){if(n===null||typeof n!="object")throw new Error("removeService() requires object as argument");Object.keys(n).forEach(o=>{let a=n[o];this.unregister(a.path)})}bind(n,s){throw new Error("Not implemented. Use bindAsync() instead")}experimentalRegisterListenerToChannelz(n){return(0,je.registerChannelzSocket)((0,Kr.subchannelAddressToString)(n),()=>({localAddress:n,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled)}experimentalUnregisterListenerFromChannelz(n){(0,je.unregisterChannelzRef)(n)}createHttp2Server(n){let s;if(n._isSecure()){let o=n._getConstructorOptions(),a=n._getSecureContextOptions(),l=Object.assign(Object.assign(Object.assign(Object.assign({},this.commonServerOptions),o),a),{enableTrace:this.options["grpc-node.tls_enable_trace"]===1}),c=a!==null;this.trace("Initial credentials valid: "+c),s=ct.createSecureServer(l),s.prependListener("connection",f=>{c||(this.trace("Dropped connection from "+JSON.stringify(f.address())+" due to unloaded credentials"),f.destroy())}),s.on("secureConnection",f=>{f.on("error",m=>{this.trace("An incoming TLS connection closed with error: "+m.message)})});let u=f=>{if(f){let m=s;try{m.setSecureContext(f)}catch(_){kn.log(Ne.LogVerbosity.ERROR,"Failed to set secure context with error "+_.message),f=null}}c=f!==null,this.trace("Post-update credentials valid: "+c)};n._addWatcher(u),s.on("close",()=>{n._removeWatcher(u)})}else s=ct.createServer(this.commonServerOptions);return s.setTimeout(0,vR),this._setupHandlers(s,n._getInterceptors()),s}bindOneAddress(n,s){this.trace("Attempting to bind "+(0,Kr.subchannelAddressToString)(n));let o=this.createHttp2Server(s.credentials);return new Promise((a,l)=>{let c=u=>{this.trace("Failed to bind "+(0,Kr.subchannelAddressToString)(n)+" with error "+u.message),a({port:"port"in n?n.port:1,error:u.message})};o.once("error",c),o.listen(n,()=>{let u=o.address(),f;typeof u=="string"?f={path:u}:f={host:u.address,port:u.port};let m=this.experimentalRegisterListenerToChannelz(f);this.listenerChildrenTracker.refChild(m),this.http2Servers.set(o,{channelzRef:m,sessions:new Set,ownsChannelzRef:!0}),s.listeningServers.add(o),this.trace("Successfully bound "+(0,Kr.subchannelAddressToString)(f)),a({port:"port"in f?f.port:1}),o.removeListener("error",c)})})}async bindManyPorts(n,s){if(n.length===0)return{count:0,port:0,errors:[]};if((0,Kr.isTcpSubchannelAddress)(n[0])&&n[0].port===0){let o=await this.bindOneAddress(n[0],s);if(o.error){let a=await this.bindManyPorts(n.slice(1),s);return Object.assign(Object.assign({},a),{errors:[o.error,...a.errors]})}else{let a=n.slice(1).map(u=>(0,Kr.isTcpSubchannelAddress)(u)?{host:u.host,port:o.port}:u),l=await Promise.all(a.map(u=>this.bindOneAddress(u,s))),c=[o,...l];return{count:c.filter(u=>u.error===void 0).length,port:o.port,errors:c.filter(u=>u.error).map(u=>u.error)}}}else{let o=await Promise.all(n.map(a=>this.bindOneAddress(a,s)));return{count:o.filter(a=>a.error===void 0).length,port:o[0].port,errors:o.filter(a=>a.error).map(a=>a.error)}}}async bindAddressList(n,s){let o=await this.bindManyPorts(n,s);if(o.count>0)return o.count<n.length&&kn.log(Ne.LogVerbosity.INFO,`WARNING Only ${o.count} addresses added out of total ${n.length} resolved`),o.port;{let a=`No address added out of total ${n.length} resolved`;throw kn.log(Ne.LogVerbosity.ERROR,a),new Error(`${a} errors: [${o.errors.join(",")}]`)}}resolvePort(n){return new Promise((s,o)=>{let a={onSuccessfulResolution:(c,u,f)=>{a.onSuccessfulResolution=()=>{};let m=[].concat(...c.map(_=>_.addresses));if(m.length===0){o(new Error(`No addresses resolved for port ${n}`));return}s(m)},onError:c=>{o(new Error(c.details))}};(0,Wy.createResolver)(n,a,this.options).updateResolution()})}async bindPort(n,s){let o=await this.resolvePort(n);if(s.cancelled)throw this.completeUnbind(s),new Error("bindAsync operation cancelled by unbind call");let a=await this.bindAddressList(o,s);if(s.cancelled)throw this.completeUnbind(s),new Error("bindAsync operation cancelled by unbind call");return a}normalizePort(n){let s=(0,Vt.parseUri)(n);if(s===null)throw new Error(`Could not parse port "${n}"`);let o=(0,Wy.mapUriDefaultScheme)(s);if(o===null)throw new Error(`Could not get a default scheme for port "${n}"`);return o}bindAsync(n,s,o){if(this.shutdown)throw new Error("bindAsync called after shutdown");if(typeof n!="string")throw new TypeError("port must be a string");if(s===null||!(s instanceof fh.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");if(typeof o!="function")throw new TypeError("callback must be a function");this.trace("bindAsync port="+n);let a=this.normalizePort(n),l=(m,_)=>{process.nextTick(()=>o(m,_))},c=this.boundPorts.get((0,Vt.uriToString)(a));if(c){if(!s._equals(c.credentials)){l(new Error(`${n} already bound with incompatible credentials`),0);return}c.cancelled=!1,c.completionPromise?c.completionPromise.then(m=>o(null,m),m=>o(m,0)):l(null,c.portNumber);return}c={mapKey:(0,Vt.uriToString)(a),originalUri:a,completionPromise:null,cancelled:!1,portNumber:0,credentials:s,listeningServers:new Set};let u=(0,Vt.splitHostPort)(a.path),f=this.bindPort(a,c);c.completionPromise=f,u?.port===0?f.then(m=>{let _={scheme:a.scheme,authority:a.authority,path:(0,Vt.combineHostPort)({host:u.host,port:m})};c.mapKey=(0,Vt.uriToString)(_),c.completionPromise=null,c.portNumber=m,this.boundPorts.set(c.mapKey,c),o(null,m)},m=>{o(m,0)}):(this.boundPorts.set(c.mapKey,c),f.then(m=>{c.completionPromise=null,c.portNumber=m,o(null,m)},m=>{o(m,0)}))}registerInjectorToChannelz(){return(0,je.registerChannelzSocket)("injector",()=>({localAddress:null,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled)}experimentalCreateConnectionInjectorWithChannelzRef(n,s,o=!1){if(n===null||!(n instanceof fh.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");this.channelzEnabled&&this.listenerChildrenTracker.refChild(s);let a=this.createHttp2Server(n),l=new Set;return this.http2Servers.set(a,{channelzRef:s,sessions:l,ownsChannelzRef:o}),{injectConnection:c=>{a.emit("connection",c)},drain:c=>{var u,f;for(let m of l)this.closeSession(m);(f=(u=setTimeout(()=>{for(let m of l)m.destroy(ct.constants.NGHTTP2_CANCEL)},c)).unref)===null||f===void 0||f.call(u)},destroy:()=>{this.closeServer(a);for(let c of l)this.closeSession(c)}}}createConnectionInjector(n){if(n===null||!(n instanceof fh.ServerCredentials))throw new TypeError("creds must be a ServerCredentials object");let s=this.registerInjectorToChannelz();return this.experimentalCreateConnectionInjectorWithChannelzRef(n,s,!0)}closeServer(n,s){this.trace("Closing server with address "+JSON.stringify(n.address()));let o=this.http2Servers.get(n);n.close(()=>{o&&o.ownsChannelzRef&&(this.listenerChildrenTracker.unrefChild(o.channelzRef),(0,je.unregisterChannelzRef)(o.channelzRef)),this.http2Servers.delete(n),s?.()})}closeSession(n,s){var o;this.trace("Closing session initiated by "+((o=n.socket)===null||o===void 0?void 0:o.remoteAddress));let a=this.sessions.get(n),l=()=>{a&&(this.sessionChildrenTracker.unrefChild(a.ref),(0,je.unregisterChannelzRef)(a.ref)),s?.()};n.closed?queueMicrotask(l):n.close(l)}completeUnbind(n){for(let s of n.listeningServers){let o=this.http2Servers.get(s);if(this.closeServer(s,()=>{n.listeningServers.delete(s)}),o)for(let a of o.sessions)this.closeSession(a)}this.boundPorts.delete(n.mapKey)}unbind(n){this.trace("unbind port="+n);let s=this.normalizePort(n),o=(0,Vt.splitHostPort)(s.path);if(o?.port===0)throw new Error("Cannot unbind port 0");let a=this.boundPorts.get((0,Vt.uriToString)(s));a&&(this.trace("unbinding "+a.mapKey+" originally bound as "+(0,Vt.uriToString)(a.originalUri)),a.completionPromise?a.cancelled=!0:this.completeUnbind(a))}drain(n,s){var o,a;this.trace("drain port="+n+" graceTimeMs="+s);let l=this.normalizePort(n),c=(0,Vt.splitHostPort)(l.path);if(c?.port===0)throw new Error("Cannot drain port 0");let u=this.boundPorts.get((0,Vt.uriToString)(l));if(!u)return;let f=new Set;for(let m of u.listeningServers){let _=this.http2Servers.get(m);if(_)for(let T of _.sessions)f.add(T),this.closeSession(T,()=>{f.delete(T)})}(a=(o=setTimeout(()=>{for(let m of f)m.destroy(ct.constants.NGHTTP2_CANCEL)},s)).unref)===null||a===void 0||a.call(o)}forceShutdown(){for(let n of this.boundPorts.values())n.cancelled=!0;this.boundPorts.clear();for(let n of this.http2Servers.keys())this.closeServer(n);this.sessions.forEach((n,s)=>{this.closeSession(s),s.destroy(ct.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),(0,je.unregisterChannelzRef)(this.channelzRef),this.shutdown=!0}register(n,s,o,a,l){return this.handlers.has(n)?!1:(this.handlers.set(n,{func:s,serialize:o,deserialize:a,type:l,path:n}),!0)}unregister(n){return this.handlers.delete(n)}start(){if(this.http2Servers.size===0||[...this.http2Servers.keys()].every(n=>!n.listening))throw new Error("server must be bound in order to start");if(this.started===!0)throw new Error("server is already started");this.started=!0}tryShutdown(n){var s;let o=c=>{(0,je.unregisterChannelzRef)(this.channelzRef),n(c)},a=0;function l(){a--,a===0&&o()}this.shutdown=!0;for(let[c,u]of this.http2Servers.entries()){a++;let f=u.channelzRef.name;this.trace("Waiting for server "+f+" to close"),this.closeServer(c,()=>{this.trace("Server "+f+" finished closing"),l()});for(let m of u.sessions.keys()){a++;let _=(s=m.socket)===null||s===void 0?void 0:s.remoteAddress;this.trace("Waiting for session "+_+" to close"),this.closeSession(m,()=>{this.trace("Session "+_+" finished closing"),l()})}}a===0&&o()}addHttp2Port(){throw new Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(n,s){let o=s[ct.constants.HTTP2_HEADER_CONTENT_TYPE];return typeof o!="string"||!o.startsWith("application/grpc")?(n.respond({[ct.constants.HTTP2_HEADER_STATUS]:ct.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1):!0}_retrieveHandler(n){Yy("Received call to method "+n+" at address "+this.serverAddressString);let s=this.handlers.get(n);return s===void 0?(Yy("No handler registered for method "+n+". Sending UNIMPLEMENTED status."),null):s}_respondWithError(n,s,o=null){var a,l;let c=Object.assign({"grpc-status":(a=n.code)!==null&&a!==void 0?a:Ne.Status.INTERNAL,"grpc-message":n.details,[ct.constants.HTTP2_HEADER_STATUS]:ct.constants.HTTP_STATUS_OK,[ct.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},(l=n.metadata)===null||l===void 0?void 0:l.toHttp2Headers());s.respond(c,{endStream:!0}),this.callTracker.addCallFailed(),o?.streamTracker.addCallFailed()}_channelzHandler(n,s,o){this.onStreamOpened(s);let a=this.sessions.get(s.session);if(this.callTracker.addCallStarted(),a?.streamTracker.addCallStarted(),!this._verifyContentType(s,o)){this.callTracker.addCallFailed(),a?.streamTracker.addCallFailed();return}let l=o[Gy],c=this._retrieveHandler(l);if(!c){this._respondWithError(gh(l),s,a);return}let u={addMessageSent:()=>{a&&(a.messagesSent+=1,a.lastMessageSentTimestamp=new Date)},addMessageReceived:()=>{a&&(a.messagesReceived+=1,a.lastMessageReceivedTimestamp=new Date)},onCallEnd:m=>{m.code===Ne.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()},onStreamEnd:m=>{a&&(m?a.streamTracker.addCallSucceeded():a.streamTracker.addCallFailed())}},f=(0,$y.getServerInterceptingCall)([...n,...this.interceptors],s,o,u,c,this.options);this._runHandlerForCall(f,c)||(this.callTracker.addCallFailed(),a?.streamTracker.addCallFailed(),f.sendStatus({code:Ne.Status.INTERNAL,details:`Unknown handler type: ${c.type}`}))}_streamHandler(n,s,o){if(this.onStreamOpened(s),this._verifyContentType(s,o)!==!0)return;let a=o[Gy],l=this._retrieveHandler(a);if(!l){this._respondWithError(gh(a),s,null);return}let c=(0,$y.getServerInterceptingCall)([...n,...this.interceptors],s,o,null,l,this.options);this._runHandlerForCall(c,l)||c.sendStatus({code:Ne.Status.INTERNAL,details:`Unknown handler type: ${l.type}`})}_runHandlerForCall(n,s){let{type:o}=s;if(o==="unary")bR(n,s);else if(o==="clientStream")ER(n,s);else if(o==="serverStream")TR(n,s);else if(o==="bidi")wR(n,s);else return!1;return!0}_setupHandlers(n,s){if(n===null)return;let o=n.address(),a="null";o&&(typeof o=="string"?a=o:a=o.address+":"+o.port),this.serverAddressString=a;let l=this.channelzEnabled?this._channelzHandler:this._streamHandler,c=this.channelzEnabled?this._channelzSessionHandler(n):this._sessionHandler(n);n.on("stream",l.bind(this,s)),n.on("session",c)}_sessionHandler(n){return s=>{var o,a;(o=this.http2Servers.get(n))===null||o===void 0||o.sessions.add(s);let l=null,c=null,u=null,f=!1,m=this.enableIdleTimeout(s);if(this.maxConnectionAgeMs!==Rn){let M=this.maxConnectionAgeMs/10,P=Math.random()*M*2-M;l=setTimeout(()=>{var X,j;f=!0,this.trace("Connection dropped by max connection age: "+((X=s.socket)===null||X===void 0?void 0:X.remoteAddress));try{s.goaway(ct.constants.NGHTTP2_NO_ERROR,~(1<<31),Zy)}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==Rn&&(c=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs),(j=c.unref)===null||j===void 0||j.call(c))},this.maxConnectionAgeMs+P),(a=l.unref)===null||a===void 0||a.call(l)}let _=()=>{u&&(clearTimeout(u),u=null)},T=()=>!s.destroyed&&this.keepaliveTimeMs<ph&&this.keepaliveTimeMs>0,C,k=()=>{var M;T()&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),u=setTimeout(()=>{_(),C()},this.keepaliveTimeMs),(M=u.unref)===null||M===void 0||M.call(u))};C=()=>{var M;if(!T())return;this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms");let P="";try{s.ping((j,re,J)=>{_(),j?(this.keepaliveTrace("Ping failed with error: "+j.message),f=!0,s.close()):(this.keepaliveTrace("Received ping response"),k())})||(P="Ping returned false")}catch(X){P=(X instanceof Error?X.message:"")||"Unknown error"}if(P){this.keepaliveTrace("Ping send failed: "+P),this.trace("Connection dropped due to ping send error: "+P),f=!0,s.close();return}u=setTimeout(()=>{_(),this.keepaliveTrace("Ping timeout passed without response"),this.trace("Connection dropped by keepalive timeout"),f=!0,s.close()},this.keepaliveTimeoutMs),(M=u.unref)===null||M===void 0||M.call(u)},k(),s.on("close",()=>{var M,P;f||this.trace(`Connection dropped by client ${(M=s.socket)===null||M===void 0?void 0:M.remoteAddress}`),l&&clearTimeout(l),c&&clearTimeout(c),_(),m!==null&&(clearTimeout(m.timeout),this.sessionIdleTimeouts.delete(s)),(P=this.http2Servers.get(n))===null||P===void 0||P.sessions.delete(s)})}}_channelzSessionHandler(n){return s=>{var o,a,l,c;let u=(0,je.registerChannelzSocket)((a=(o=s.socket)===null||o===void 0?void 0:o.remoteAddress)!==null&&a!==void 0?a:"unknown",this.getChannelzSessionInfo.bind(this,s),this.channelzEnabled),f={ref:u,streamTracker:new je.ChannelzCallTracker,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};(l=this.http2Servers.get(n))===null||l===void 0||l.sessions.add(s),this.sessions.set(s,f);let m=`${s.socket.remoteAddress}:${s.socket.remotePort}`;this.channelzTrace.addTrace("CT_INFO","Connection established by client "+m),this.trace("Connection established by client "+m),this.sessionChildrenTracker.refChild(u);let _=null,T=null,C=null,k=!1,M=this.enableIdleTimeout(s);if(this.maxConnectionAgeMs!==Rn){let J=this.maxConnectionAgeMs/10,oe=Math.random()*J*2-J;_=setTimeout(()=>{var be;k=!0,this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+m);try{s.goaway(ct.constants.NGHTTP2_NO_ERROR,~(1<<31),Zy)}catch{s.destroy();return}s.close(),this.maxConnectionAgeGraceMs!==Rn&&(T=setTimeout(()=>{s.destroy()},this.maxConnectionAgeGraceMs),(be=T.unref)===null||be===void 0||be.call(T))},this.maxConnectionAgeMs+oe),(c=_.unref)===null||c===void 0||c.call(_)}let P=()=>{C&&(clearTimeout(C),C=null)},X=()=>!s.destroyed&&this.keepaliveTimeMs<ph&&this.keepaliveTimeMs>0,j,re=()=>{var J;X()&&(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),C=setTimeout(()=>{P(),j()},this.keepaliveTimeMs),(J=C.unref)===null||J===void 0||J.call(C))};j=()=>{var J;if(!X())return;this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms");let oe="";try{s.ping((Ae,fe,b)=>{P(),Ae?(this.keepaliveTrace("Ping failed with error: "+Ae.message),this.channelzTrace.addTrace("CT_INFO","Connection dropped due to error of a ping frame "+Ae.message+" return in "+fe),k=!0,s.close()):(this.keepaliveTrace("Received ping response"),re())})||(oe="Ping returned false")}catch(be){oe=(be instanceof Error?be.message:"")||"Unknown error"}if(oe){this.keepaliveTrace("Ping send failed: "+oe),this.channelzTrace.addTrace("CT_INFO","Connection dropped due to ping send error: "+oe),k=!0,s.close();return}f.keepAlivesSent+=1,C=setTimeout(()=>{P(),this.keepaliveTrace("Ping timeout passed without response"),this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+m),k=!0,s.close()},this.keepaliveTimeoutMs),(J=C.unref)===null||J===void 0||J.call(C)},re(),s.on("close",()=>{var J;k||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+m),this.sessionChildrenTracker.unrefChild(u),(0,je.unregisterChannelzRef)(u),_&&clearTimeout(_),T&&clearTimeout(T),P(),M!==null&&(clearTimeout(M.timeout),this.sessionIdleTimeouts.delete(s)),(J=this.http2Servers.get(n))===null||J===void 0||J.sessions.delete(s),this.sessions.delete(s)})}}enableIdleTimeout(n){var s,o;if(this.sessionIdleTimeout>=Vy)return null;let a={activeStreams:0,lastIdle:Date.now(),onClose:this.onStreamClose.bind(this,n),timeout:setTimeout(this.onIdleTimeout,this.sessionIdleTimeout,this,n)};(o=(s=a.timeout).unref)===null||o===void 0||o.call(s),this.sessionIdleTimeouts.set(n,a);let{socket:l}=n;return this.trace("Enable idle timeout for "+l.remoteAddress+":"+l.remotePort),a}onIdleTimeout(n,s){let{socket:o}=s,a=n.sessionIdleTimeouts.get(s);a!==void 0&&a.activeStreams===0&&(Date.now()-a.lastIdle>=n.sessionIdleTimeout?(n.trace("Session idle timeout triggered for "+o?.remoteAddress+":"+o?.remotePort+" last idle at "+a.lastIdle),n.closeSession(s)):a.timeout.refresh())}onStreamOpened(n){let s=n.session,o=this.sessionIdleTimeouts.get(s);o&&(o.activeStreams+=1,n.once("close",o.onClose))}onStreamClose(n){var s,o;let a=this.sessionIdleTimeouts.get(n);a&&(a.activeStreams-=1,a.activeStreams===0&&(a.lastIdle=Date.now(),a.timeout.refresh(),this.trace("Session onStreamClose"+((s=n.socket)===null||s===void 0?void 0:s.remoteAddress)+":"+((o=n.socket)===null||o===void 0?void 0:o.remotePort)+" at "+a.lastIdle)))}},(()=>{let i=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;r=[_R("Calling start() is no longer necessary. It can be safely omitted.")],pR(t,null,r,{kind:"method",name:"start",static:!1,private:!1,access:{has:n=>"start"in n,get:n=>n.start},metadata:i},null,e),i&&Object.defineProperty(t,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:i})})(),t})();Xr.Server=CR;async function bR(t,e){let r;function i(o,a,l,c){if(o){t.sendStatus((0,xn.serverErrorToStatus)(o,l));return}t.sendMessage(a,()=>{t.sendStatus({code:Ne.Status.OK,details:"OK",metadata:l??null})})}let n,s=null;t.start({onReceiveMetadata(o){n=o,t.startRead()},onReceiveMessage(o){if(s){t.sendStatus({code:Ne.Status.UNIMPLEMENTED,details:`Received a second request message for server streaming method ${e.path}`,metadata:null});return}s=o,t.startRead()},onReceiveHalfClose(){if(!s){t.sendStatus({code:Ne.Status.UNIMPLEMENTED,details:`Received no request message for server streaming method ${e.path}`,metadata:null});return}r=new xn.ServerWritableStreamImpl(e.path,t,n,s);try{e.func(r,i)}catch(o){t.sendStatus({code:Ne.Status.UNKNOWN,details:`Server method handler threw error ${o.message}`,metadata:null})}},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"))}})}function ER(t,e){let r;function i(n,s,o,a){if(n){t.sendStatus((0,xn.serverErrorToStatus)(n,o));return}t.sendMessage(s,()=>{t.sendStatus({code:Ne.Status.OK,details:"OK",metadata:o??null})})}t.start({onReceiveMetadata(n){r=new xn.ServerDuplexStreamImpl(e.path,t,n);try{e.func(r,i)}catch(s){t.sendStatus({code:Ne.Status.UNKNOWN,details:`Server method handler threw error ${s.message}`,metadata:null})}},onReceiveMessage(n){r.push(n)},onReceiveHalfClose(){r.push(null)},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"),r.destroy())}})}function TR(t,e){let r,i,n=null;t.start({onReceiveMetadata(s){i=s,t.startRead()},onReceiveMessage(s){if(n){t.sendStatus({code:Ne.Status.UNIMPLEMENTED,details:`Received a second request message for server streaming method ${e.path}`,metadata:null});return}n=s,t.startRead()},onReceiveHalfClose(){if(!n){t.sendStatus({code:Ne.Status.UNIMPLEMENTED,details:`Received no request message for server streaming method ${e.path}`,metadata:null});return}r=new xn.ServerWritableStreamImpl(e.path,t,i,n);try{e.func(r)}catch(s){t.sendStatus({code:Ne.Status.UNKNOWN,details:`Server method handler threw error ${s.message}`,metadata:null})}},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"),r.destroy())}})}function wR(t,e){let r;t.start({onReceiveMetadata(i){r=new xn.ServerDuplexStreamImpl(e.path,t,i);try{e.func(r)}catch(n){t.sendStatus({code:Ne.Status.UNKNOWN,details:`Server method handler threw error ${n.message}`,metadata:null})}},onReceiveMessage(i){r.push(i)},onReceiveHalfClose(){r.push(null)},onCancel(){r&&(r.cancelled=!0,r.emit("cancelled","cancelled"),r.destroy())}})}});var Ky=S(el=>{"use strict";Object.defineProperty(el,"__esModule",{value:!0});el.StatusBuilder=void 0;var mh=class{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return this.code!==null&&(e.code=this.code),this.details!==null&&(e.details=this.details),this.metadata!==null&&(e.metadata=this.metadata),e}};el.StatusBuilder=mh});var yh=S(On=>{"use strict";Object.defineProperty(On,"__esModule",{value:!0});On.msToDuration=RR;On.durationToMs=kR;On.isDuration=xR;On.parseDuration=AR;function RR(t){return{seconds:t/1e3|0,nanos:t%1e3*1e6|0}}function kR(t){return t.seconds*1e3+t.nanos/1e6|0}function xR(t){return typeof t.seconds=="number"&&typeof t.nanos=="number"}var OR=/^(\d+)(?:\.(\d+))?s$/;function AR(t){let e=t.match(OR);return e?{seconds:Number.parseInt(e[1],10),nanos:e[2]?Number.parseInt(e[2].padEnd(9,"0"),10):0}:null}});var tl=S(fr=>{"use strict";Object.defineProperty(fr,"__esModule",{value:!0});fr.LeafLoadBalancer=fr.PickFirstLoadBalancer=fr.PickFirstLoadBalancingConfig=void 0;fr.shuffled=tv;fr.setup=FR;var vh=Si(),qe=bt(),Fi=Fr(),Xy=Et(),PR=_e(),MR=ne(),Qy=Et(),ev=require("net"),IR="pick_first";function Ps(t){PR.trace(MR.LogVerbosity.DEBUG,IR,t)}var Ms="pick_first",NR=250,An=class t{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return Ms}toJsonObject(){return{[Ms]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&typeof e.shuffleAddressList!="boolean")throw new Error("pick_first config field shuffleAddressList must be a boolean if provided");return new t(e.shuffleAddressList===!0)}};fr.PickFirstLoadBalancingConfig=An;var _h=class{constructor(e){this.subchannel=e}pick(e){return{pickResultType:Fi.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}};function tv(t){let e=t.slice();for(let r=e.length-1;r>1;r--){let i=Math.floor(Math.random()*(r+1)),n=e[r];e[r]=e[i],e[i]=n}return e}function DR(t){if(t.length===0)return[];let e=[],r=[],i=[],n=(0,Qy.isTcpSubchannelAddress)(t[0])&&(0,ev.isIPv6)(t[0].host);for(let a of t)(0,Qy.isTcpSubchannelAddress)(a)&&(0,ev.isIPv6)(a.host)?r.push(a):i.push(a);let s=n?r:i,o=n?i:r;for(let a=0;a<Math.max(s.length,o.length);a++)a<s.length&&e.push(s[a]),a<o.length&&e.push(o[a]);return e}var rv="grpc-node.internal.pick-first.report_health_status",Is=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=qe.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(r,i,n,s,o)=>{this.onSubchannelStateUpdate(r,i,n,o)},this.pickedSubchannelHealthListener=()=>this.calculateAndReportNewState(),this.stickyTransientFailureMode=!1,this.reportHealthStatus=!1,this.lastError=null,this.latestAddressList=null,this.latestOptions={},this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}resetChildrenReportedTF(){this.children.every(e=>e.hasReportedTransientFailure=!1)}calculateAndReportNewState(){var e;if(this.currentPick)if(this.reportHealthStatus&&!this.currentPick.isHealthy()){let r=`Picked subchannel ${this.currentPick.getAddress()} is unhealthy`;this.updateState(qe.ConnectivityState.TRANSIENT_FAILURE,new Fi.UnavailablePicker({details:r}),r)}else this.updateState(qe.ConnectivityState.READY,new _h(this.currentPick),null);else if(((e=this.latestAddressList)===null||e===void 0?void 0:e.length)===0){let r=`No connection established. Last error: ${this.lastError}`;this.updateState(qe.ConnectivityState.TRANSIENT_FAILURE,new Fi.UnavailablePicker({details:r}),r)}else if(this.children.length===0)this.updateState(qe.ConnectivityState.IDLE,new Fi.QueuePicker(this),null);else if(this.stickyTransientFailureMode){let r=`No connection established. Last error: ${this.lastError}`;this.updateState(qe.ConnectivityState.TRANSIENT_FAILURE,new Fi.UnavailablePicker({details:r}),r)}else this.updateState(qe.ConnectivityState.CONNECTING,new Fi.QueuePicker(this),null)}requestReresolution(){this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()){if(this.requestReresolution(),this.resetChildrenReportedTF(),this.stickyTransientFailureMode){this.calculateAndReportNewState();return}this.stickyTransientFailureMode=!0;for(let{subchannel:e}of this.children)e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){this.currentPick!==null&&(this.currentPick.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeHealthStateWatcher(this.pickedSubchannelHealthListener),this.currentPick.unref(),this.currentPick=null)}onSubchannelStateUpdate(e,r,i,n){var s;if(!((s=this.currentPick)===null||s===void 0)&&s.realSubchannelEquals(e)){i!==qe.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState());return}for(let[o,a]of this.children.entries())if(e.realSubchannelEquals(a.subchannel)){i===qe.ConnectivityState.READY&&this.pickSubchannel(a.subchannel),i===qe.ConnectivityState.TRANSIENT_FAILURE&&(a.hasReportedTransientFailure=!0,n&&(this.lastError=n),this.maybeEnterStickyTransientFailureMode(),o===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(o+1)),a.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){clearTimeout(this.connectionDelayTimeout);for(let[r,i]of this.children.entries())if(r>=e){let n=i.subchannel.getConnectivityState();if(n===qe.ConnectivityState.IDLE||n===qe.ConnectivityState.CONNECTING){this.startConnecting(r);return}}this.maybeEnterStickyTransientFailureMode()}startConnecting(e){var r,i;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===qe.ConnectivityState.IDLE&&(Ps("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var n;(n=this.children[e])===null||n===void 0||n.subchannel.startConnecting()})),this.connectionDelayTimeout=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},NR),(i=(r=this.connectionDelayTimeout).unref)===null||i===void 0||i.call(r)}pickSubchannel(e){Ps("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.removeCurrentPick(),this.resetSubchannelList(),e.addConnectivityStateListener(this.subchannelStateListener),e.addHealthStateWatcher(this.pickedSubchannelHealthListener),this.currentPick=e,clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState()}updateState(e,r,i){Ps(qe.ConnectivityState[this.currentState]+" -> "+qe.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,r,i)}resetSubchannelList(){for(let e of this.children)e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[]}connectToAddressList(e,r){Ps("connectToAddressList(["+e.map(n=>(0,Xy.subchannelAddressToString)(n))+"])");let i=e.map(n=>({subchannel:this.channelControlHelper.createSubchannel(n,r),hasReportedTransientFailure:!1}));for(let{subchannel:n}of i)if(n.getConnectivityState()===qe.ConnectivityState.READY){this.pickSubchannel(n);return}for(let{subchannel:n}of i)n.ref(),this.channelControlHelper.addChannelzChild(n.getChannelzRef());this.resetSubchannelList(),this.children=i;for(let{subchannel:n}of this.children)n.addConnectivityStateListener(this.subchannelStateListener);for(let n of this.children)n.subchannel.getConnectivityState()===qe.ConnectivityState.TRANSIENT_FAILURE&&(n.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,r,i){if(!(r instanceof An))return;this.reportHealthStatus=i[rv],r.getShuffleAddressList()&&(e=tv(e));let n=[].concat(...e.map(o=>o.addresses));Ps("updateAddressList(["+n.map(o=>(0,Xy.subchannelAddressToString)(o))+"])"),n.length===0&&(this.lastError="No addresses resolved");let s=DR(n);this.latestAddressList=s,this.latestOptions=i,this.connectToAddressList(s,i)}exitIdle(){this.currentState===qe.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList,this.latestOptions)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return Ms}};fr.PickFirstLoadBalancer=Is;var LR=new An(!1),Sh=class{constructor(e,r,i){this.endpoint=e,this.options=i,this.latestState=qe.ConnectivityState.IDLE;let n=(0,vh.createChildChannelControlHelper)(r,{updateState:(s,o,a)=>{this.latestState=s,this.latestPicker=o,r.updateState(s,o,a)}});this.pickFirstBalancer=new Is(n),this.latestPicker=new Fi.QueuePicker(this.pickFirstBalancer)}startConnecting(){this.pickFirstBalancer.updateAddressList([this.endpoint],LR,Object.assign(Object.assign({},this.options),{[rv]:!0}))}updateEndpoint(e,r){this.options=r,this.endpoint=e,this.latestState!==qe.ConnectivityState.IDLE&&this.startConnecting()}getConnectivityState(){return this.latestState}getPicker(){return this.latestPicker}getEndpoint(){return this.endpoint}exitIdle(){this.pickFirstBalancer.exitIdle()}destroy(){this.pickFirstBalancer.destroy()}};fr.LeafLoadBalancer=Sh;function FR(){(0,vh.registerLoadBalancerType)(Ms,Is,An),(0,vh.registerDefaultLoadBalancerType)(Ms)}});var iv=S(il=>{"use strict";Object.defineProperty(il,"__esModule",{value:!0});il.FileWatcherCertificateProvider=void 0;var qR=require("fs"),BR=_e(),jR=ne(),UR=require("util"),zR="certificate_provider";function rl(t){BR.trace(jR.LogVerbosity.DEBUG,zR,t)}var Ch=(0,UR.promisify)(qR.readFile),bh=class{constructor(e){if(this.config=e,this.refreshTimer=null,this.fileResultPromise=null,this.latestCaUpdate=void 0,this.caListeners=new Set,this.latestIdentityUpdate=void 0,this.identityListeners=new Set,this.lastUpdateTime=null,e.certificateFile===void 0!=(e.privateKeyFile===void 0))throw new Error("certificateFile and privateKeyFile must be set or unset together");if(e.certificateFile===void 0&&e.caCertificateFile===void 0)throw new Error("At least one of certificateFile and caCertificateFile must be set");rl("File watcher constructed with config "+JSON.stringify(e))}updateCertificates(){this.fileResultPromise||(this.fileResultPromise=Promise.allSettled([this.config.certificateFile?Ch(this.config.certificateFile):Promise.reject(),this.config.privateKeyFile?Ch(this.config.privateKeyFile):Promise.reject(),this.config.caCertificateFile?Ch(this.config.caCertificateFile):Promise.reject()]),this.fileResultPromise.then(([e,r,i])=>{if(this.refreshTimer){rl("File watcher read certificates certificate "+e.status+", privateKey "+r.status+", CA certificate "+i.status),this.lastUpdateTime=new Date,this.fileResultPromise=null,e.status==="fulfilled"&&r.status==="fulfilled"?this.latestIdentityUpdate={certificate:e.value,privateKey:r.value}:this.latestIdentityUpdate=null,i.status==="fulfilled"?this.latestCaUpdate={caCertificate:i.value}:this.latestCaUpdate=null;for(let n of this.identityListeners)n(this.latestIdentityUpdate);for(let n of this.caListeners)n(this.latestCaUpdate)}}),rl("File watcher initiated certificate update"))}maybeStartWatchingFiles(){if(!this.refreshTimer){let e=this.lastUpdateTime?new Date().getTime()-this.lastUpdateTime.getTime():1/0;e>this.config.refreshIntervalMs&&this.updateCertificates(),e>this.config.refreshIntervalMs*2&&(this.latestCaUpdate=void 0,this.latestIdentityUpdate=void 0),this.refreshTimer=setInterval(()=>this.updateCertificates(),this.config.refreshIntervalMs),rl("File watcher started watching")}}maybeStopWatchingFiles(){this.caListeners.size===0&&this.identityListeners.size===0&&(this.fileResultPromise=null,this.refreshTimer&&(clearInterval(this.refreshTimer),this.refreshTimer=null))}addCaCertificateListener(e){this.caListeners.add(e),this.maybeStartWatchingFiles(),this.latestCaUpdate!==void 0&&process.nextTick(e,this.latestCaUpdate)}removeCaCertificateListener(e){this.caListeners.delete(e),this.maybeStopWatchingFiles()}addIdentityCertificateListener(e){this.identityListeners.add(e),this.maybeStartWatchingFiles(),this.latestIdentityUpdate!==void 0&&process.nextTick(e,this.latestIdentityUpdate)}removeIdentityCertificateListener(e){this.identityListeners.delete(e),this.maybeStopWatchingFiles()}};il.FileWatcherCertificateProvider=bh});var Th=S(U=>{"use strict";Object.defineProperty(U,"__esModule",{value:!0});U.SUBCHANNEL_ARGS_EXCLUDE_KEY_PREFIX=U.createCertificateProviderChannelCredentials=U.FileWatcherCertificateProvider=U.createCertificateProviderServerCredentials=U.createServerCredentialsWithInterceptors=U.BaseSubchannelWrapper=U.registerAdminService=U.FilterStackFactory=U.BaseFilter=U.PickResultType=U.QueuePicker=U.UnavailablePicker=U.ChildLoadBalancerHandler=U.EndpointMap=U.endpointHasAddress=U.endpointToString=U.subchannelAddressToString=U.LeafLoadBalancer=U.isLoadBalancerNameRegistered=U.parseLoadBalancingConfig=U.selectLbConfigFromList=U.registerLoadBalancerType=U.createChildChannelControlHelper=U.BackoffTimeout=U.parseDuration=U.durationToMs=U.splitHostPort=U.uriToString=U.createResolver=U.registerResolver=U.log=U.trace=void 0;var nv=_e();Object.defineProperty(U,"trace",{enumerable:!0,get:function(){return nv.trace}});Object.defineProperty(U,"log",{enumerable:!0,get:function(){return nv.log}});var sv=Kt();Object.defineProperty(U,"registerResolver",{enumerable:!0,get:function(){return sv.registerResolver}});Object.defineProperty(U,"createResolver",{enumerable:!0,get:function(){return sv.createResolver}});var ov=st();Object.defineProperty(U,"uriToString",{enumerable:!0,get:function(){return ov.uriToString}});Object.defineProperty(U,"splitHostPort",{enumerable:!0,get:function(){return ov.splitHostPort}});var av=yh();Object.defineProperty(U,"durationToMs",{enumerable:!0,get:function(){return av.durationToMs}});Object.defineProperty(U,"parseDuration",{enumerable:!0,get:function(){return av.parseDuration}});var HR=Jn();Object.defineProperty(U,"BackoffTimeout",{enumerable:!0,get:function(){return HR.BackoffTimeout}});var Ns=Si();Object.defineProperty(U,"createChildChannelControlHelper",{enumerable:!0,get:function(){return Ns.createChildChannelControlHelper}});Object.defineProperty(U,"registerLoadBalancerType",{enumerable:!0,get:function(){return Ns.registerLoadBalancerType}});Object.defineProperty(U,"selectLbConfigFromList",{enumerable:!0,get:function(){return Ns.selectLbConfigFromList}});Object.defineProperty(U,"parseLoadBalancingConfig",{enumerable:!0,get:function(){return Ns.parseLoadBalancingConfig}});Object.defineProperty(U,"isLoadBalancerNameRegistered",{enumerable:!0,get:function(){return Ns.isLoadBalancerNameRegistered}});var WR=tl();Object.defineProperty(U,"LeafLoadBalancer",{enumerable:!0,get:function(){return WR.LeafLoadBalancer}});var nl=Et();Object.defineProperty(U,"subchannelAddressToString",{enumerable:!0,get:function(){return nl.subchannelAddressToString}});Object.defineProperty(U,"endpointToString",{enumerable:!0,get:function(){return nl.endpointToString}});Object.defineProperty(U,"endpointHasAddress",{enumerable:!0,get:function(){return nl.endpointHasAddress}});Object.defineProperty(U,"EndpointMap",{enumerable:!0,get:function(){return nl.EndpointMap}});var $R=Mo();Object.defineProperty(U,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return $R.ChildLoadBalancerHandler}});var Eh=Fr();Object.defineProperty(U,"UnavailablePicker",{enumerable:!0,get:function(){return Eh.UnavailablePicker}});Object.defineProperty(U,"QueuePicker",{enumerable:!0,get:function(){return Eh.QueuePicker}});Object.defineProperty(U,"PickResultType",{enumerable:!0,get:function(){return Eh.PickResultType}});var VR=Td();Object.defineProperty(U,"BaseFilter",{enumerable:!0,get:function(){return VR.BaseFilter}});var GR=Cd();Object.defineProperty(U,"FilterStackFactory",{enumerable:!0,get:function(){return GR.FilterStackFactory}});var ZR=Fo();Object.defineProperty(U,"registerAdminService",{enumerable:!0,get:function(){return ZR.registerAdminService}});var YR=$a();Object.defineProperty(U,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return YR.BaseSubchannelWrapper}});var lv=Ja();Object.defineProperty(U,"createServerCredentialsWithInterceptors",{enumerable:!0,get:function(){return lv.createServerCredentialsWithInterceptors}});Object.defineProperty(U,"createCertificateProviderServerCredentials",{enumerable:!0,get:function(){return lv.createCertificateProviderServerCredentials}});var JR=iv();Object.defineProperty(U,"FileWatcherCertificateProvider",{enumerable:!0,get:function(){return JR.FileWatcherCertificateProvider}});var KR=Gn();Object.defineProperty(U,"createCertificateProviderChannelCredentials",{enumerable:!0,get:function(){return KR.createCertificateProviderChannelCredentials}});var XR=$d();Object.defineProperty(U,"SUBCHANNEL_ARGS_EXCLUDE_KEY_PREFIX",{enumerable:!0,get:function(){return XR.SUBCHANNEL_ARGS_EXCLUDE_KEY_PREFIX}})});var cv=S(Rh=>{"use strict";Object.defineProperty(Rh,"__esModule",{value:!0});Rh.setup=ek;var QR=Kt(),wh=class{constructor(e,r,i){this.listener=r,this.hasReturnedResult=!1,this.endpoints=[];let n;e.authority===""?n="/"+e.path:n=e.path,this.endpoints=[{addresses:[{path:n}]}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.endpoints,null,null,null,{}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return"localhost"}};function ek(){(0,QR.registerResolver)("unix",wh)}});var pv=S(Ah=>{"use strict";Object.defineProperty(Ah,"__esModule",{value:!0});Ah.setup=nk;var uv=require("net"),sl=ne(),kh=Ke(),dv=Kt(),hv=st(),tk=_e(),rk="ip_resolver";function fv(t){tk.trace(sl.LogVerbosity.DEBUG,rk,t)}var xh="ipv4",Oh="ipv6",ik=443,ol=class{constructor(e,r,i){var n;this.listener=r,this.endpoints=[],this.error=null,this.hasReturnedResult=!1,fv("Resolver constructed for target "+(0,hv.uriToString)(e));let s=[];if(!(e.scheme===xh||e.scheme===Oh)){this.error={code:sl.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new kh.Metadata};return}let o=e.path.split(",");for(let a of o){let l=(0,hv.splitHostPort)(a);if(l===null){this.error={code:sl.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new kh.Metadata};return}if(e.scheme===xh&&!(0,uv.isIPv4)(l.host)||e.scheme===Oh&&!(0,uv.isIPv6)(l.host)){this.error={code:sl.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${a}`,metadata:new kh.Metadata};return}s.push({host:l.host,port:(n=l.port)!==null&&n!==void 0?n:ik})}this.endpoints=s.map(a=>({addresses:[a]})),fv("Parsed "+e.scheme+" address list "+s)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.endpoints,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}};function nk(){(0,dv.registerResolver)(xh,ol),(0,dv.registerResolver)(Oh,ol)}});var vv=S(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.RoundRobinLoadBalancer=void 0;Ds.setup=ck;var yv=Si(),it=bt(),Ph=Fr(),sk=_e(),ok=ne(),gv=Et(),ak=tl(),lk="round_robin";function mv(t){sk.trace(ok.LogVerbosity.DEBUG,lk,t)}var al="round_robin",Mh=class t{getLoadBalancerName(){return al}constructor(){}toJsonObject(){return{[al]:{}}}static createFromJson(e){return new t}},Ih=class{constructor(e,r=0){this.children=e,this.nextIndex=r}pick(e){let r=this.children[this.nextIndex].picker;return this.nextIndex=(this.nextIndex+1)%this.children.length,r.pick(e)}peekNextEndpoint(){return this.children[this.nextIndex].endpoint}},ll=class{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=it.ConnectivityState.IDLE,this.currentReadyPicker=null,this.updatesPaused=!1,this.lastError=null,this.childChannelControlHelper=(0,yv.createChildChannelControlHelper)(e,{updateState:(r,i,n)=>{this.currentState===it.ConnectivityState.READY&&r!==it.ConnectivityState.READY&&this.channelControlHelper.requestReresolution(),n&&(this.lastError=n),this.calculateAndUpdateState()}})}countChildrenWithState(e){return this.children.filter(r=>r.getConnectivityState()===e).length}calculateAndUpdateState(){if(!this.updatesPaused){if(this.countChildrenWithState(it.ConnectivityState.READY)>0){let e=this.children.filter(i=>i.getConnectivityState()===it.ConnectivityState.READY),r=0;if(this.currentReadyPicker!==null){let i=this.currentReadyPicker.peekNextEndpoint();r=e.findIndex(n=>(0,gv.endpointEqual)(n.getEndpoint(),i)),r<0&&(r=0)}this.updateState(it.ConnectivityState.READY,new Ih(e.map(i=>({endpoint:i.getEndpoint(),picker:i.getPicker()})),r),null)}else if(this.countChildrenWithState(it.ConnectivityState.CONNECTING)>0)this.updateState(it.ConnectivityState.CONNECTING,new Ph.QueuePicker(this),null);else if(this.countChildrenWithState(it.ConnectivityState.TRANSIENT_FAILURE)>0){let e=`round_robin: No connection established. Last error: ${this.lastError}`;this.updateState(it.ConnectivityState.TRANSIENT_FAILURE,new Ph.UnavailablePicker({details:e}),e)}else this.updateState(it.ConnectivityState.IDLE,new Ph.QueuePicker(this),null);for(let e of this.children)e.getConnectivityState()===it.ConnectivityState.IDLE&&e.exitIdle()}}updateState(e,r,i){mv(it.ConnectivityState[this.currentState]+" -> "+it.ConnectivityState[e]),e===it.ConnectivityState.READY?this.currentReadyPicker=r:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,r,i)}resetSubchannelList(){for(let e of this.children)e.destroy()}updateAddressList(e,r,i){this.resetSubchannelList(),mv("Connect to endpoint list "+e.map(gv.endpointToString)),this.updatesPaused=!0,this.children=e.map(n=>new ak.LeafLoadBalancer(n,this.childChannelControlHelper,i));for(let n of this.children)n.startConnecting();this.updatesPaused=!1,this.calculateAndUpdateState()}exitIdle(){}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return al}};Ds.RoundRobinLoadBalancer=ll;function ck(){(0,yv.registerLoadBalancerType)(al,ll,Mh)}});var Cv=S(Bi=>{"use strict";var Nh;Object.defineProperty(Bi,"__esModule",{value:!0});Bi.OutlierDetectionLoadBalancer=Bi.OutlierDetectionLoadBalancingConfig=void 0;Bi.setup=Sk;var uk=bt(),_v=ne(),qi=yh(),Sv=Th(),dk=Si(),hk=Mo(),fk=Fr(),Dh=Et(),pk=$a(),gk=_e(),mk="outlier_detection";function We(t){gk.trace(_v.LogVerbosity.DEBUG,mk,t)}var Uh="outlier_detection",yk=((Nh=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)!==null&&Nh!==void 0?Nh:"true")==="true",vk={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},_k={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function Pn(t,e,r,i){if(e in t&&t[e]!==void 0&&typeof t[e]!==r){let n=i?`${i}.${e}`:e;throw new Error(`outlier detection config ${n} parse error: expected ${r}, got ${typeof t[e]}`)}}function Lh(t,e,r){let i=r?`${r}.${e}`:e;if(e in t&&t[e]!==void 0){if(!(0,qi.isDuration)(t[e]))throw new Error(`outlier detection config ${i} parse error: expected Duration, got ${typeof t[e]}`);if(!(t[e].seconds>=0&&t[e].seconds<=315576e6&&t[e].nanos>=0&&t[e].nanos<=999999999))throw new Error(`outlier detection config ${i} parse error: values out of range for non-negative Duaration`)}}function cl(t,e,r){let i=r?`${r}.${e}`:e;if(Pn(t,e,"number",r),e in t&&t[e]!==void 0&&!(t[e]>=0&&t[e]<=100))throw new Error(`outlier detection config ${i} parse error: value out of range for percentage (0-100)`)}var Ls=class t{constructor(e,r,i,n,s,o,a){if(this.childPolicy=a,a.getLoadBalancerName()==="pick_first")throw new Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=e??1e4,this.baseEjectionTimeMs=r??3e4,this.maxEjectionTimeMs=i??3e5,this.maxEjectionPercent=n??10,this.successRateEjection=s?Object.assign(Object.assign({},vk),s):null,this.failurePercentageEjection=o?Object.assign(Object.assign({},_k),o):null}getLoadBalancerName(){return Uh}toJsonObject(){var e,r;return{outlier_detection:{interval:(0,qi.msToDuration)(this.intervalMs),base_ejection_time:(0,qi.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,qi.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:(e=this.successRateEjection)!==null&&e!==void 0?e:void 0,failure_percentage_ejection:(r=this.failurePercentageEjection)!==null&&r!==void 0?r:void 0,child_policy:[this.childPolicy.toJsonObject()]}}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}static createFromJson(e){var r;if(Lh(e,"interval"),Lh(e,"base_ejection_time"),Lh(e,"max_ejection_time"),cl(e,"max_ejection_percent"),"success_rate_ejection"in e&&e.success_rate_ejection!==void 0){if(typeof e.success_rate_ejection!="object")throw new Error("outlier detection config success_rate_ejection must be an object");Pn(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),cl(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),Pn(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),Pn(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e&&e.failure_percentage_ejection!==void 0){if(typeof e.failure_percentage_ejection!="object")throw new Error("outlier detection config failure_percentage_ejection must be an object");cl(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),cl(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),Pn(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),Pn(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}if(!("child_policy"in e)||!Array.isArray(e.child_policy))throw new Error("outlier detection config child_policy must be an array");let i=(0,dk.selectLbConfigFromList)(e.child_policy);if(!i)throw new Error("outlier detection config child_policy: no valid recognized policy found");return new t(e.interval?(0,qi.durationToMs)(e.interval):null,e.base_ejection_time?(0,qi.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,qi.durationToMs)(e.max_ejection_time):null,(r=e.max_ejection_percent)!==null&&r!==void 0?r:null,e.success_rate_ejection,e.failure_percentage_ejection,i)}};Bi.OutlierDetectionLoadBalancingConfig=Ls;var qh=class extends pk.BaseSubchannelWrapper{constructor(e,r){super(e),this.mapEntry=r,this.refCount=0}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){this.setHealthy(!1)}uneject(){this.setHealthy(!0)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}};function Fh(){return{success:0,failure:0}}var Bh=class{constructor(){this.activeBucket=Fh(),this.inactiveBucket=Fh()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=Fh()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}},jh=class{constructor(e,r){this.wrappedPicker=e,this.countCalls=r}pick(e){let r=this.wrappedPicker.pick(e);if(r.pickResultType===fk.PickResultType.COMPLETE){let i=r.subchannel,n=i.getMapEntry();if(n){let s=r.onCallEnded;return this.countCalls&&(s=o=>{var a;o===_v.Status.OK?n.counter.addSuccess():n.counter.addFailure(),(a=r.onCallEnded)===null||a===void 0||a.call(r,o)}),Object.assign(Object.assign({},r),{subchannel:i.getWrappedSubchannel(),onCallEnded:s})}else return Object.assign(Object.assign({},r),{subchannel:i.getWrappedSubchannel()})}else return r}},ul=class{constructor(e){this.entryMap=new Dh.EndpointMap,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new hk.ChildLoadBalancerHandler((0,Sv.createChildChannelControlHelper)(e,{createSubchannel:(r,i)=>{let n=e.createSubchannel(r,i),s=this.entryMap.getForSubchannelAddress(r),o=new qh(n,s);return s?.currentEjectionTimestamp!==null&&o.eject(),s?.subchannelWrappers.push(o),o},updateState:(r,i,n)=>{r===uk.ConnectivityState.READY?e.updateState(r,new jh(i,this.isCountingEnabled()),n):e.updateState(r,i,n)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return this.latestConfig!==null&&(this.latestConfig.getSuccessRateEjectionConfig()!==null||this.latestConfig.getFailurePercentageEjectionConfig()!==null)}getCurrentEjectionPercent(){let e=0;for(let r of this.entryMap.values())r.currentEjectionTimestamp!==null&&(e+=1);return e*100/this.entryMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let r=this.latestConfig.getSuccessRateEjectionConfig();if(!r)return;We("Running success rate check");let i=r.request_volume,n=0,s=[];for(let[f,m]of this.entryMap.entries()){let _=m.counter.getLastSuccesses(),T=m.counter.getLastFailures();We("Stats for "+(0,Dh.endpointToString)(f)+": successes="+_+" failures="+T+" targetRequestVolume="+i),_+T>=i&&(n+=1,s.push(_/(_+T)))}if(We("Found "+n+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+s+"]"),n<r.minimum_hosts)return;let o=s.reduce((f,m)=>f+m)/s.length,a=0;for(let f of s){let m=f-o;a+=m*m}let l=a/s.length,c=Math.sqrt(l),u=o-c*(r.stdev_factor/1e3);We("stdev="+c+" ejectionThreshold="+u);for(let[f,m]of this.entryMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let _=m.counter.getLastSuccesses(),T=m.counter.getLastFailures();if(_+T<i)continue;let C=_/(_+T);if(We("Checking candidate "+f+" successRate="+C),C<u){let k=Math.random()*100;We("Candidate "+f+" randomNumber="+k+" enforcement_percentage="+r.enforcement_percentage),k<r.enforcement_percentage&&(We("Ejecting candidate "+f),this.eject(m,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let r=this.latestConfig.getFailurePercentageEjectionConfig();if(!r)return;We("Running failure percentage check. threshold="+r.threshold+" request volume threshold="+r.request_volume);let i=0;for(let n of this.entryMap.values()){let s=n.counter.getLastSuccesses(),o=n.counter.getLastFailures();s+o>=r.request_volume&&(i+=1)}if(!(i<r.minimum_hosts))for(let[n,s]of this.entryMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let o=s.counter.getLastSuccesses(),a=s.counter.getLastFailures();if(We("Candidate successes="+o+" failures="+a),o+a<r.request_volume)continue;if(a*100/(a+o)>r.threshold){let c=Math.random()*100;We("Candidate "+n+" randomNumber="+c+" enforcement_percentage="+r.enforcement_percentage),c<r.enforcement_percentage&&(We("Ejecting candidate "+n),this.eject(s,e))}}}eject(e,r){e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1;for(let i of e.subchannelWrappers)i.eject()}uneject(e){e.currentEjectionTimestamp=null;for(let r of e.subchannelWrappers)r.uneject()}switchAllBuckets(){for(let e of this.entryMap.values())e.counter.switchBuckets()}startTimer(e){var r,i;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),(i=(r=this.ejectionTimer).unref)===null||i===void 0||i.call(r)}runChecks(){let e=new Date;if(We("Ejection timer running"),this.switchAllBuckets(),!!this.latestConfig){this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e);for(let[r,i]of this.entryMap.entries())if(i.currentEjectionTimestamp===null)i.ejectionTimeMultiplier>0&&(i.ejectionTimeMultiplier-=1);else{let n=this.latestConfig.getBaseEjectionTimeMs(),s=this.latestConfig.getMaxEjectionTimeMs(),o=new Date(i.currentEjectionTimestamp.getTime());o.setMilliseconds(o.getMilliseconds()+Math.min(n*i.ejectionTimeMultiplier,Math.max(n,s))),o<new Date&&(We("Unejecting "+r),this.uneject(i))}}}updateAddressList(e,r,i){if(!(r instanceof Ls))return;We("Received update with config: "+JSON.stringify(r.toJsonObject(),void 0,2));for(let s of e)this.entryMap.has(s)||(We("Adding map entry for "+(0,Dh.endpointToString)(s)),this.entryMap.set(s,{counter:new Bh,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));this.entryMap.deleteMissing(e);let n=r.getChildPolicy();if(this.childBalancer.updateAddressList(e,n,i),r.getSuccessRateEjectionConfig()||r.getFailurePercentageEjectionConfig())if(this.timerStartTime){We("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let s=r.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(s)}else We("Starting new timer"),this.timerStartTime=new Date,this.startTimer(r.getIntervalMs()),this.switchAllBuckets();else{We("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer);for(let s of this.entryMap.values())this.uneject(s),s.ejectionTimeMultiplier=0}this.latestConfig=r}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return Uh}};Bi.OutlierDetectionLoadBalancer=ul;function Sk(){yk&&(0,Sv.registerLoadBalancerType)(Uh,ul,Ls)}});var $h=S(F=>{"use strict";Object.defineProperty(F,"__esModule",{value:!0});F.experimental=F.ServerInterceptingCall=F.ResponderBuilder=F.ServerListenerBuilder=F.addAdminServicesToServer=F.getChannelzHandlers=F.getChannelzServiceDefinition=F.InterceptorConfigurationError=F.InterceptingCall=F.RequesterBuilder=F.ListenerBuilder=F.StatusBuilder=F.getClientChannel=F.ServerCredentials=F.Server=F.setLogVerbosity=F.setLogger=F.load=F.loadObject=F.CallCredentials=F.ChannelCredentials=F.waitForClientReady=F.closeClient=F.Channel=F.makeGenericClientConstructor=F.makeClientConstructor=F.loadPackageDefinition=F.Client=F.compressionAlgorithms=F.propagate=F.connectivityState=F.status=F.logVerbosity=F.Metadata=F.credentials=void 0;var dl=So();Object.defineProperty(F,"CallCredentials",{enumerable:!0,get:function(){return dl.CallCredentials}});var Ck=Hc();Object.defineProperty(F,"Channel",{enumerable:!0,get:function(){return Ck.ChannelImplementation}});var bk=bd();Object.defineProperty(F,"compressionAlgorithms",{enumerable:!0,get:function(){return bk.CompressionAlgorithms}});var Ek=bt();Object.defineProperty(F,"connectivityState",{enumerable:!0,get:function(){return Ek.ConnectivityState}});var hl=Gn();Object.defineProperty(F,"ChannelCredentials",{enumerable:!0,get:function(){return hl.ChannelCredentials}});var bv=zc();Object.defineProperty(F,"Client",{enumerable:!0,get:function(){return bv.Client}});var zh=ne();Object.defineProperty(F,"logVerbosity",{enumerable:!0,get:function(){return zh.LogVerbosity}});Object.defineProperty(F,"status",{enumerable:!0,get:function(){return zh.Status}});Object.defineProperty(F,"propagate",{enumerable:!0,get:function(){return zh.Propagate}});var Ev=_e(),Hh=$c();Object.defineProperty(F,"loadPackageDefinition",{enumerable:!0,get:function(){return Hh.loadPackageDefinition}});Object.defineProperty(F,"makeClientConstructor",{enumerable:!0,get:function(){return Hh.makeClientConstructor}});Object.defineProperty(F,"makeGenericClientConstructor",{enumerable:!0,get:function(){return Hh.makeClientConstructor}});var Tk=Ke();Object.defineProperty(F,"Metadata",{enumerable:!0,get:function(){return Tk.Metadata}});var wk=Jy();Object.defineProperty(F,"Server",{enumerable:!0,get:function(){return wk.Server}});var Rk=Ja();Object.defineProperty(F,"ServerCredentials",{enumerable:!0,get:function(){return Rk.ServerCredentials}});var kk=Ky();Object.defineProperty(F,"StatusBuilder",{enumerable:!0,get:function(){return kk.StatusBuilder}});F.credentials={combineChannelCredentials:(t,...e)=>e.reduce((r,i)=>r.compose(i),t),combineCallCredentials:(t,...e)=>e.reduce((r,i)=>r.compose(i),t),createInsecure:hl.ChannelCredentials.createInsecure,createSsl:hl.ChannelCredentials.createSsl,createFromSecureContext:hl.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:dl.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:dl.CallCredentials.createFromGoogleCredential,createEmpty:dl.CallCredentials.createEmpty};var xk=t=>t.close();F.closeClient=xk;var Ok=(t,e,r)=>t.waitForReady(e,r);F.waitForClientReady=Ok;var Ak=(t,e)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};F.loadObject=Ak;var Pk=(t,e,r)=>{throw new Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")};F.load=Pk;var Mk=t=>{Ev.setLogger(t)};F.setLogger=Mk;var Ik=t=>{Ev.setLoggerVerbosity(t)};F.setLogVerbosity=Ik;var Nk=t=>bv.Client.prototype.getChannel.call(t);F.getClientChannel=Nk;var fl=Bc();Object.defineProperty(F,"ListenerBuilder",{enumerable:!0,get:function(){return fl.ListenerBuilder}});Object.defineProperty(F,"RequesterBuilder",{enumerable:!0,get:function(){return fl.RequesterBuilder}});Object.defineProperty(F,"InterceptingCall",{enumerable:!0,get:function(){return fl.InterceptingCall}});Object.defineProperty(F,"InterceptorConfigurationError",{enumerable:!0,get:function(){return fl.InterceptorConfigurationError}});var Tv=xi();Object.defineProperty(F,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return Tv.getChannelzServiceDefinition}});Object.defineProperty(F,"getChannelzHandlers",{enumerable:!0,get:function(){return Tv.getChannelzHandlers}});var Dk=Fo();Object.defineProperty(F,"addAdminServicesToServer",{enumerable:!0,get:function(){return Dk.addAdminServicesToServer}});var Wh=hh();Object.defineProperty(F,"ServerListenerBuilder",{enumerable:!0,get:function(){return Wh.ServerListenerBuilder}});Object.defineProperty(F,"ResponderBuilder",{enumerable:!0,get:function(){return Wh.ResponderBuilder}});Object.defineProperty(F,"ServerInterceptingCall",{enumerable:!0,get:function(){return Wh.ServerInterceptingCall}});var Lk=Th();F.experimental=Lk;var Fk=ld(),qk=cv(),Bk=pv(),jk=tl(),Uk=vv(),zk=Cv(),Hk=xi();Fk.setup(),qk.setup(),Bk.setup(),jk.setup(),Uk.setup(),zk.setup(),Hk.setup()});var rf=S(Ze=>{var Jh=typeof Object.defineProperties=="function"?Object.defineProperty:function(t,e,r){t!=Array.prototype&&t!=Object.prototype&&(t[e]=r.value)},ji=typeof window<"u"&&window===Ze?Ze:typeof global<"u"&&global!=null?global:Ze;function Wk(t,e){if(e){var r=ji;t=t.split(".");for(var i=0;i<t.length-1;i++){var n=t[i];n in r||(r[n]={}),r=r[n]}t=t[t.length-1],i=r[t],e=e(i),e!=i&&e!=null&&Jh(r,t,{configurable:!0,writable:!0,value:e})}}function $k(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}}function Av(){Av=function(){},ji.Symbol||(ji.Symbol=Vk)}function Pv(t,e){this.a=t,Jh(this,"description",{configurable:!0,writable:!0,value:e})}Pv.prototype.toString=function(){return this.a};var Vk=function(){function t(r){if(this instanceof t)throw new TypeError("Symbol is not a constructor");return new Pv("jscomp_symbol_"+(r||"")+"_"+e++,r)}var e=0;return t}();function Kh(){Av();var t=ji.Symbol.iterator;t||(t=ji.Symbol.iterator=ji.Symbol("Symbol.iterator")),typeof Array.prototype[t]!="function"&&Jh(Array.prototype,t,{configurable:!0,writable:!0,value:function(){return Gk($k(this))}}),Kh=function(){}}function Gk(t){return Kh(),t={next:t},t[ji.Symbol.iterator]=function(){return this},t}function Zk(t,e){Kh(),t instanceof String&&(t+="");var r=0,i={next:function(){if(r<t.length){var n=r++;return{value:e(n,t[n]),done:!1}}return i.next=function(){return{done:!0,value:void 0}},i.next()}};return i[Symbol.iterator]=function(){return i},i}Wk("Array.prototype.entries",function(t){return t||function(){return Zk(this,function(e,r){return[e,r]})}});var Yk=Ze||self;function B(t,e,r){t=t.split("."),r=r||Yk,t[0]in r||typeof r.execScript>"u"||r.execScript("var "+t[0]);for(var i;t.length&&(i=t.shift());)t.length||e===void 0?r[i]&&r[i]!==Object.prototype[i]?r=r[i]:r=r[i]={}:r[i]=e}function kr(t){var e=typeof t;if(e=="object")if(t){if(t instanceof Array)return"array";if(t instanceof Object)return e;var r=Object.prototype.toString.call(t);if(r=="[object Window]")return"object";if(r=="[object Array]"||typeof t.length=="number"&&typeof t.splice<"u"&&typeof t.propertyIsEnumerable<"u"&&!t.propertyIsEnumerable("splice"))return"array";if(r=="[object Function]"||typeof t.call<"u"&&typeof t.propertyIsEnumerable<"u"&&!t.propertyIsEnumerable("call"))return"function"}else return"null";else if(e=="function"&&typeof t.call>"u")return"object";return e}function wv(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function Jk(t,e,r){B(t,e,r)}function Kk(t,e){function r(){}r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}var Rv="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Xk(t,e){for(var r,i,n=1;n<arguments.length;n++){i=arguments[n];for(r in i)t[r]=i[r];for(var s=0;s<Rv.length;s++)r=Rv[s],Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])}}var Qk=Array.prototype.forEach?function(t,e){Array.prototype.forEach.call(t,e,void 0)}:function(t,e){for(var r=t.length,i=typeof t=="string"?t.split(""):t,n=0;n<r;n++)n in i&&e.call(void 0,i[n],n,t)},Us=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(t,e){for(var r=t.length,i=Array(r),n=typeof t=="string"?t.split(""):t,s=0;s<r;s++)s in n&&(i[s]=e.call(void 0,n[s],s,t));return i};function ex(t,e,r){return 2>=arguments.length?Array.prototype.slice.call(t,e):Array.prototype.slice.call(t,e,r)}function gl(t,e,r,i){var n="Assertion failed";if(r){n+=": "+r;var s=i}else t&&(n+=": "+t,s=e);throw Error(n,s||[])}function v(t,e,r){for(var i=[],n=2;n<arguments.length;++n)i[n-2]=arguments[n];return t||gl("",null,e,i),t}function tx(t,e,r){for(var i=[],n=2;n<arguments.length;++n)i[n-2]=arguments[n];typeof t!="string"&&gl("Expected string but got %s: %s.",[kr(t),t],e,i)}function rx(t,e,r){for(var i=[],n=2;n<arguments.length;++n)i[n-2]=arguments[n];Array.isArray(t)||gl("Expected array but got %s: %s.",[kr(t),t],e,i)}function Ue(t,e){for(var r=[],i=1;i<arguments.length;++i)r[i-1]=arguments[i];throw Error("Failure"+(t?": "+t:""),r)}function Zt(t,e,r,i){for(var n=[],s=3;s<arguments.length;++s)n[s-3]=arguments[s];t instanceof e||gl("Expected instanceof %s but got %s.",[kv(e),kv(t)],r,n)}function kv(t){return t instanceof Function?t.displayName||t.name||"unknown type name":t instanceof Object?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):t===null?"null":typeof t}function Y(t,e){if(this.c=t,this.b=e,this.a={},this.arrClean=!0,0<this.c.length){for(t=0;t<this.c.length;t++){e=this.c[t];var r=e[0];this.a[r.toString()]=new Mv(r,e[1])}this.arrClean=!0}}B("jspb.Map",Y,void 0);Y.prototype.g=function(){if(this.arrClean){if(this.b){var t=this.a,e;for(e in t)if(Object.prototype.hasOwnProperty.call(t,e)){var r=t[e].a;r&&r.g()}}}else{for(this.c.length=0,t=Qr(this),t.sort(),e=0;e<t.length;e++){var i=this.a[t[e]];(r=i.a)&&r.g(),this.c.push([i.key,i.value])}this.arrClean=!0}return this.c};Y.prototype.toArray=Y.prototype.g;Y.prototype.Mc=function(t,e){for(var r=this.g(),i=[],n=0;n<r.length;n++){var s=this.a[r[n][0].toString()];In(this,s);var o=s.a;o?(v(e),i.push([s.key,e(t,o)])):i.push([s.key,s.value])}return i};Y.prototype.toObject=Y.prototype.Mc;Y.fromObject=function(t,e,r){e=new Y([],e);for(var i=0;i<t.length;i++){var n=t[i][0],s=r(t[i][1]);e.set(n,s)}return e};function zs(t){this.a=0,this.b=t}zs.prototype.next=function(){return this.a<this.b.length?{done:!1,value:this.b[this.a++]}:{done:!0,value:void 0}};typeof Symbol<"u"&&(zs.prototype[Symbol.iterator]=function(){return this});Y.prototype.Jb=function(){return Qr(this).length};Y.prototype.getLength=Y.prototype.Jb;Y.prototype.clear=function(){this.a={},this.arrClean=!1};Y.prototype.clear=Y.prototype.clear;Y.prototype.Cb=function(t){t=t.toString();var e=this.a.hasOwnProperty(t);return delete this.a[t],this.arrClean=!1,e};Y.prototype.del=Y.prototype.Cb;Y.prototype.Eb=function(){var t=[],e=Qr(this);e.sort();for(var r=0;r<e.length;r++){var i=this.a[e[r]];t.push([i.key,i.value])}return t};Y.prototype.getEntryList=Y.prototype.Eb;Y.prototype.entries=function(){var t=[],e=Qr(this);e.sort();for(var r=0;r<e.length;r++){var i=this.a[e[r]];t.push([i.key,In(this,i)])}return new zs(t)};Y.prototype.entries=Y.prototype.entries;Y.prototype.keys=function(){var t=[],e=Qr(this);e.sort();for(var r=0;r<e.length;r++)t.push(this.a[e[r]].key);return new zs(t)};Y.prototype.keys=Y.prototype.keys;Y.prototype.values=function(){var t=[],e=Qr(this);e.sort();for(var r=0;r<e.length;r++)t.push(In(this,this.a[e[r]]));return new zs(t)};Y.prototype.values=Y.prototype.values;Y.prototype.forEach=function(t,e){var r=Qr(this);r.sort();for(var i=0;i<r.length;i++){var n=this.a[r[i]];t.call(e,In(this,n),n.key,this)}};Y.prototype.forEach=Y.prototype.forEach;Y.prototype.set=function(t,e){var r=new Mv(t);return this.b?(r.a=e,r.value=e.g()):r.value=e,this.a[t.toString()]=r,this.arrClean=!1,this};Y.prototype.set=Y.prototype.set;function In(t,e){return t.b?(e.a||(e.a=new t.b(e.value)),e.a):e.value}Y.prototype.get=function(t){if(t=this.a[t.toString()])return In(this,t)};Y.prototype.get=Y.prototype.get;Y.prototype.has=function(t){return t.toString()in this.a};Y.prototype.has=Y.prototype.has;Y.prototype.Jc=function(t,e,r,i,n){var s=Qr(this);s.sort();for(var o=0;o<s.length;o++){var a=this.a[s[o]];e.Va(t),r.call(e,1,a.key),this.b?i.call(e,2,In(this,a),n):i.call(e,2,a.value),e.Ya()}};Y.prototype.serializeBinary=Y.prototype.Jc;Y.deserializeBinary=function(t,e,r,i,n,s,o){for(;e.oa()&&!e.bb();){var a=e.c;a==1?s=r.call(e):a==2&&(t.b?(v(n),o||(o=new t.b),i.call(e,o,n)):o=i.call(e))}v(s!=null),v(o!=null),t.set(s,o)};function Qr(t){t=t.a;var e=[],r;for(r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.push(r);return e}function Mv(t,e){this.key=t,this.value=e,this.a=void 0}function Iv(t){if(8192>=t.length)return String.fromCharCode.apply(null,t);for(var e="",r=0;r<t.length;r+=8192)e+=String.fromCharCode.apply(null,ex(t,r,r+8192));return e}var Vh={"\0":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\x0B",'"':'\\"',"\\":"\\\\","<":"\\u003C"},pl={"'":"\\'"},Nv={},Fs=null;function Dv(t,e){e===void 0&&(e=0),Fv(),e=Nv[e];for(var r=[],i=0;i<t.length;i+=3){var n=t[i],s=i+1<t.length,o=s?t[i+1]:0,a=i+2<t.length,l=a?t[i+2]:0,c=n>>2;n=(n&3)<<4|o>>4,o=(o&15)<<2|l>>6,l&=63,a||(l=64,s||(o=64)),r.push(e[c],e[n],e[o]||"",e[l]||"")}return r.join("")}function Lv(t){var e=t.length,r=3*e/4;r%3?r=Math.floor(r):"=.".indexOf(t[e-1])!=-1&&(r="=.".indexOf(t[e-2])!=-1?r-2:r-1);var i=new Uint8Array(r),n=0;return ix(t,function(s){i[n++]=s}),i.subarray(0,n)}function ix(t,e){function r(l){for(;i<t.length;){var c=t.charAt(i++),u=Fs[c];if(u!=null)return u;if(!/^[\s\xa0]*$/.test(c))throw Error("Unknown base64 encoding at char: "+c)}return l}Fv();for(var i=0;;){var n=r(-1),s=r(0),o=r(64),a=r(64);if(a===64&&n===-1)break;e(n<<2|s>>4),o!=64&&(e(s<<4&240|o>>2),a!=64&&e(o<<6&192|a))}}function Fv(){if(!Fs){Fs={};for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),e=["+/=","+/","-_=","-_.","-_"],r=0;5>r;r++){var i=t.concat(e[r].split(""));Nv[r]=i;for(var n=0;n<i.length;n++){var s=i[n];Fs[s]===void 0&&(Fs[s]=n)}}}}B("jspb.ConstBinaryMessage",function(){},void 0);B("jspb.BinaryMessage",function(){},void 0);B("jspb.BinaryConstants.FieldType",{yb:-1,ee:1,FLOAT:2,ke:3,te:4,je:5,xb:6,wb:7,BOOL:8,re:9,ie:10,le:11,ce:12,se:13,ge:14,me:15,ne:16,oe:17,pe:18,he:30,ve:31},void 0);B("jspb.BinaryConstants.WireType",{yb:-1,ue:0,xb:1,de:2,qe:3,fe:4,wb:5},void 0);B("jspb.BinaryConstants.FieldTypeToWireType",function(t){switch(t){case 5:case 3:case 13:case 4:case 17:case 18:case 8:case 14:case 31:return 0;case 1:case 6:case 16:case 30:return 1;case 9:case 11:case 12:return 2;case 2:case 7:case 15:return 5;default:return-1}},void 0);B("jspb.BinaryConstants.INVALID_FIELD_NUMBER",-1,void 0);B("jspb.BinaryConstants.FLOAT32_EPS",1401298464324817e-60,void 0);B("jspb.BinaryConstants.FLOAT32_MIN",11754943508222875e-54,void 0);B("jspb.BinaryConstants.FLOAT32_MAX",34028234663852886e22,void 0);B("jspb.BinaryConstants.FLOAT64_EPS",5e-324,void 0);B("jspb.BinaryConstants.FLOAT64_MIN",22250738585072014e-324,void 0);B("jspb.BinaryConstants.FLOAT64_MAX",17976931348623157e292,void 0);B("jspb.BinaryConstants.TWO_TO_20",1048576,void 0);B("jspb.BinaryConstants.TWO_TO_23",8388608,void 0);B("jspb.BinaryConstants.TWO_TO_31",2147483648,void 0);B("jspb.BinaryConstants.TWO_TO_32",4294967296,void 0);B("jspb.BinaryConstants.TWO_TO_52",4503599627370496,void 0);B("jspb.BinaryConstants.TWO_TO_63",9223372036854776e3,void 0);B("jspb.BinaryConstants.TWO_TO_64",18446744073709552e3,void 0);B("jspb.BinaryConstants.ZERO_HASH","\0\0\0\0\0\0\0\0",void 0);var de=0,he=0;B("jspb.utils.getSplit64Low",function(){return de},void 0);B("jspb.utils.getSplit64High",function(){return he},void 0);function Xh(t){var e=t>>>0;t=Math.floor((t-e)/4294967296)>>>0,de=e,he=t}B("jspb.utils.splitUint64",Xh,void 0);function Hs(t){var e=0>t;t=Math.abs(t);var r=t>>>0;t=Math.floor((t-r)/4294967296),t>>>=0,e&&(t=~t>>>0,r=(~r>>>0)+1,4294967295<r&&(r=0,t++,4294967295<t&&(t=0))),de=r,he=t}B("jspb.utils.splitInt64",Hs,void 0);function qv(t){var e=0>t;t=2*Math.abs(t),Xh(t),t=de;var r=he;e&&(t==0?r==0?r=t=4294967295:(r--,t=4294967295):t--),de=t,he=r}B("jspb.utils.splitZigzag64",qv,void 0);function Bv(t){var e=0>t?1:0;if(t=e?-t:t,t===0)0<1/t?de=he=0:(he=0,de=2147483648);else if(isNaN(t))he=0,de=2147483647;else if(34028234663852886e22<t)he=0,de=(e<<31|2139095040)>>>0;else if(11754943508222875e-54>t)t=Math.round(t/Math.pow(2,-149)),he=0,de=(e<<31|t)>>>0;else{var r=Math.floor(Math.log(t)/Math.LN2);t*=Math.pow(2,-r),t=Math.round(8388608*t),16777216<=t&&++r,he=0,de=(e<<31|r+127<<23|t&8388607)>>>0}}B("jspb.utils.splitFloat32",Bv,void 0);function jv(t){var e=0>t?1:0;if(t=e?-t:t,t===0)he=0<1/t?0:2147483648,de=0;else if(isNaN(t))he=2147483647,de=4294967295;else if(17976931348623157e292<t)he=(e<<31|2146435072)>>>0,de=0;else if(22250738585072014e-324>t)t/=Math.pow(2,-1074),he=(e<<31|t/4294967296)>>>0,de=t>>>0;else{var r=t,i=0;if(2<=r)for(;2<=r&&1023>i;)i++,r/=2;else for(;1>r&&-1022<i;)r*=2,i--;t*=Math.pow(2,-i),he=(e<<31|i+1023<<20|1048576*t&1048575)>>>0,de=4503599627370496*t>>>0}}B("jspb.utils.splitFloat64",jv,void 0);function ei(t){var e=t.charCodeAt(4),r=t.charCodeAt(5),i=t.charCodeAt(6),n=t.charCodeAt(7);de=t.charCodeAt(0)+(t.charCodeAt(1)<<8)+(t.charCodeAt(2)<<16)+(t.charCodeAt(3)<<24)>>>0,he=e+(r<<8)+(i<<16)+(n<<24)>>>0}B("jspb.utils.splitHash64",ei,void 0);function Nn(t,e){return 4294967296*e+(t>>>0)}B("jspb.utils.joinUint64",Nn,void 0);function Ws(t,e){var r=e&2147483648;return r&&(t=~t+1>>>0,e=~e>>>0,t==0&&(e=e+1>>>0)),t=Nn(t,e),r?-t:t}B("jspb.utils.joinInt64",Ws,void 0);function ml(t,e,r){var i=e>>31;return r(t<<1^i,(e<<1|t>>>31)^i)}B("jspb.utils.toZigzag64",ml,void 0);function Uv(t,e){return yl(t,e,Ws)}B("jspb.utils.joinZigzag64",Uv,void 0);function yl(t,e,r){var i=-(t&1);return r((t>>>1|e<<31)^i,e>>>1^i)}B("jspb.utils.fromZigzag64",yl,void 0);function zv(t){var e=2*(t>>31)+1,r=t>>>23&255;return t&=8388607,r==255?t?NaN:1/0*e:r==0?e*Math.pow(2,-149)*t:e*Math.pow(2,r-150)*(t+Math.pow(2,23))}B("jspb.utils.joinFloat32",zv,void 0);function Hv(t,e){var r=2*(e>>31)+1,i=e>>>20&2047;return t=4294967296*(e&1048575)+t,i==2047?t?NaN:1/0*r:i==0?r*Math.pow(2,-1074)*t:r*Math.pow(2,i-1075)*(t+4503599627370496)}B("jspb.utils.joinFloat64",Hv,void 0);function vl(t,e){return String.fromCharCode(t>>>0&255,t>>>8&255,t>>>16&255,t>>>24&255,e>>>0&255,e>>>8&255,e>>>16&255,e>>>24&255)}B("jspb.utils.joinHash64",vl,void 0);B("jspb.utils.DIGITS","0123456789abcdef".split(""),void 0);function $s(t,e){function r(n,s){return n=n?String(n):"",s?"0000000".slice(n.length)+n:n}if(2097151>=e)return""+Nn(t,e);var i=(t>>>24|e<<8)>>>0&16777215;return e=e>>16&65535,t=(t&16777215)+6777216*i+6710656*e,i+=8147497*e,e*=2,1e7<=t&&(i+=Math.floor(t/1e7),t%=1e7),1e7<=i&&(e+=Math.floor(i/1e7),i%=1e7),r(e,0)+r(i,e)+r(t,1)}B("jspb.utils.joinUnsignedDecimalString",$s,void 0);function Vs(t,e){var r=e&2147483648;return r&&(t=~t+1>>>0,e=~e+(t==0?1:0)>>>0),t=$s(t,e),r?"-"+t:t}B("jspb.utils.joinSignedDecimalString",Vs,void 0);function Wv(t,e){ei(t),t=de;var r=he;return e?Vs(t,r):$s(t,r)}B("jspb.utils.hash64ToDecimalString",Wv,void 0);B("jspb.utils.hash64ArrayToDecimalStrings",function(t,e){for(var r=Array(t.length),i=0;i<t.length;i++)r[i]=Wv(t[i],e);return r},void 0);function Gs(t){function e(o,a){for(var l=0;8>l&&(o!==1||0<a);l++)a=o*n[l]+a,n[l]=a&255,a>>>=8}function r(){for(var o=0;8>o;o++)n[o]=~n[o]&255}v(0<t.length);var i=!1;t[0]==="-"&&(i=!0,t=t.slice(1));for(var n=[0,0,0,0,0,0,0,0],s=0;s<t.length;s++)e(10,t.charCodeAt(s)-48);return i&&(r(),e(1,1)),Iv(n)}B("jspb.utils.decimalStringToHash64",Gs,void 0);B("jspb.utils.splitDecimalString",function(t){ei(Gs(t))},void 0);function xv(t){return String.fromCharCode(10>t?48+t:87+t)}function Ov(t){return 97<=t?t-97+10:t-48}B("jspb.utils.hash64ToHexString",function(t){var e=Array(18);e[0]="0",e[1]="x";for(var r=0;8>r;r++){var i=t.charCodeAt(7-r);e[2*r+2]=xv(i>>4),e[2*r+3]=xv(i&15)}return e.join("")},void 0);B("jspb.utils.hexStringToHash64",function(t){t=t.toLowerCase(),v(t.length==18),v(t[0]=="0"),v(t[1]=="x");for(var e="",r=0;8>r;r++)e=String.fromCharCode(16*Ov(t.charCodeAt(2*r+2))+Ov(t.charCodeAt(2*r+3)))+e;return e},void 0);B("jspb.utils.hash64ToNumber",function(t,e){ei(t),t=de;var r=he;return e?Ws(t,r):Nn(t,r)},void 0);B("jspb.utils.numberToHash64",function(t){return Hs(t),vl(de,he)},void 0);B("jspb.utils.countVarints",function(t,e,r){for(var i=0,n=e;n<r;n++)i+=t[n]>>7;return r-e-i},void 0);B("jspb.utils.countVarintFields",function(t,e,r,i){var n=0;if(i*=8,128>i)for(;e<r&&t[e++]==i;)for(n++;;){var s=t[e++];if(!(s&128))break}else for(;e<r;){for(s=i;128<s;){if(t[e]!=(s&127|128))return n;e++,s>>=7}if(t[e++]!=s)break;for(n++;s=t[e++],(s&128)!=0;);}return n},void 0);function $v(t,e,r,i,n){var s=0;if(128>i)for(;e<r&&t[e++]==i;)s++,e+=n;else for(;e<r;){for(var o=i;128<o;){if(t[e++]!=(o&127|128))return s;o>>=7}if(t[e++]!=o)break;s++,e+=n}return s}B("jspb.utils.countFixed32Fields",function(t,e,r,i){return $v(t,e,r,8*i+5,4)},void 0);B("jspb.utils.countFixed64Fields",function(t,e,r,i){return $v(t,e,r,8*i+1,8)},void 0);B("jspb.utils.countDelimitedFields",function(t,e,r,i){var n=0;for(i=8*i+2;e<r;){for(var s=i;128<s;){if(t[e++]!=(s&127|128))return n;s>>=7}if(t[e++]!=s)break;n++;for(var o=0,a=1;s=t[e++],o+=(s&127)*a,a*=128,(s&128)!=0;);e+=o}return n},void 0);B("jspb.utils.debugBytesToTextFormat",function(t){var e='"';if(t){t=_l(t);for(var r=0;r<t.length;r++)e+="\\x",16>t[r]&&(e+="0"),e+=t[r].toString(16)}return e+'"'},void 0);B("jspb.utils.debugScalarToTextFormat",function(t){if(typeof t=="string"){t=String(t);for(var e=['"'],r=0;r<t.length;r++){var i=t.charAt(r),n=i.charCodeAt(0),s=r+1,o;(o=Vh[i])||(31<n&&127>n||(n=i,n in pl?i=pl[n]:n in Vh?i=pl[n]=Vh[n]:(o=n.charCodeAt(0),31<o&&127>o?i=n:(256>o?(i="\\x",(16>o||256<o)&&(i+="0")):(i="\\u",4096>o&&(i+="0")),i+=o.toString(16).toUpperCase()),i=pl[n]=i)),o=i),e[s]=o}e.push('"'),t=e.join("")}else t=t.toString();return t},void 0);B("jspb.utils.stringToByteArray",function(t){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++){var i=t.charCodeAt(r);if(255<i)throw Error("Conversion error: string contains codepoint outside of byte range");e[r]=i}return e},void 0);function _l(t){return t.constructor===Uint8Array?t:t.constructor===ArrayBuffer?new Uint8Array(t):t.constructor===Array?new Uint8Array(t):t.constructor===String?Lv(t):t instanceof Uint8Array?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):(Ue("Type not convertible to Uint8Array."),new Uint8Array(0))}B("jspb.utils.byteSourceToUint8Array",_l,void 0);function y(t,e,r){this.b=null,this.a=this.c=this.h=0,this.v=!1,t&&this.H(t,e,r)}B("jspb.BinaryDecoder",y,void 0);var qs=[];y.getInstanceCacheLength=function(){return qs.length};function Sl(t,e,r){if(qs.length){var i=qs.pop();return t&&i.H(t,e,r),i}return new y(t,e,r)}y.alloc=Sl;y.prototype.Ca=function(){this.clear(),100>qs.length&&qs.push(this)};y.prototype.free=y.prototype.Ca;y.prototype.clone=function(){return Sl(this.b,this.h,this.c-this.h)};y.prototype.clone=y.prototype.clone;y.prototype.clear=function(){this.b=null,this.a=this.c=this.h=0,this.v=!1};y.prototype.clear=y.prototype.clear;y.prototype.Y=function(){return this.b};y.prototype.getBuffer=y.prototype.Y;y.prototype.H=function(t,e,r){this.b=_l(t),this.h=e!==void 0?e:0,this.c=r!==void 0?this.h+r:this.b.length,this.a=this.h};y.prototype.setBlock=y.prototype.H;y.prototype.Db=function(){return this.c};y.prototype.getEnd=y.prototype.Db;y.prototype.setEnd=function(t){this.c=t};y.prototype.setEnd=y.prototype.setEnd;y.prototype.reset=function(){this.a=this.h};y.prototype.reset=y.prototype.reset;y.prototype.B=function(){return this.a};y.prototype.getCursor=y.prototype.B;y.prototype.Ma=function(t){this.a=t};y.prototype.setCursor=y.prototype.Ma;y.prototype.advance=function(t){this.a+=t,v(this.a<=this.c)};y.prototype.advance=y.prototype.advance;y.prototype.ya=function(){return this.a==this.c};y.prototype.atEnd=y.prototype.ya;y.prototype.Qb=function(){return this.a>this.c};y.prototype.pastEnd=y.prototype.Qb;y.prototype.getError=function(){return this.v||0>this.a||this.a>this.c};y.prototype.getError=y.prototype.getError;y.prototype.w=function(t){for(var e=128,r=0,i=0,n=0;4>n&&128<=e;n++)e=this.b[this.a++],r|=(e&127)<<7*n;if(128<=e&&(e=this.b[this.a++],r|=(e&127)<<28,i|=(e&127)>>4),128<=e)for(n=0;5>n&&128<=e;n++)e=this.b[this.a++],i|=(e&127)<<7*n+3;if(128>e)return t(r>>>0,i>>>0);Ue("Failed to read varint, encoding is invalid."),this.v=!0};y.prototype.readSplitVarint64=y.prototype.w;y.prototype.ea=function(t){return this.w(function(e,r){return yl(e,r,t)})};y.prototype.readSplitZigzagVarint64=y.prototype.ea;y.prototype.ta=function(t){var e=this.b,r=this.a;this.a+=8;for(var i=0,n=0,s=r+7;s>=r;s--)i=i<<8|e[s],n=n<<8|e[s+4];return t(i,n)};y.prototype.readSplitFixed64=y.prototype.ta;y.prototype.kb=function(){for(;this.b[this.a]&128;)this.a++;this.a++};y.prototype.skipVarint=y.prototype.kb;y.prototype.mb=function(t){for(;128<t;)this.a--,t>>>=7;this.a--};y.prototype.unskipVarint=y.prototype.mb;y.prototype.o=function(){var t=this.b,e=t[this.a],r=e&127;return 128>e?(this.a+=1,v(this.a<=this.c),r):(e=t[this.a+1],r|=(e&127)<<7,128>e?(this.a+=2,v(this.a<=this.c),r):(e=t[this.a+2],r|=(e&127)<<14,128>e?(this.a+=3,v(this.a<=this.c),r):(e=t[this.a+3],r|=(e&127)<<21,128>e?(this.a+=4,v(this.a<=this.c),r):(e=t[this.a+4],r|=(e&15)<<28,128>e?(this.a+=5,v(this.a<=this.c),r>>>0):(this.a+=5,128<=t[this.a++]&&128<=t[this.a++]&&128<=t[this.a++]&&128<=t[this.a++]&&128<=t[this.a++]&&v(!1),v(this.a<=this.c),r)))))};y.prototype.readUnsignedVarint32=y.prototype.o;y.prototype.da=function(){return~~this.o()};y.prototype.readSignedVarint32=y.prototype.da;y.prototype.O=function(){return this.o().toString()};y.prototype.Ea=function(){return this.da().toString()};y.prototype.readSignedVarint32String=y.prototype.Ea;y.prototype.Ia=function(){var t=this.o();return t>>>1^-(t&1)};y.prototype.readZigzagVarint32=y.prototype.Ia;y.prototype.Ga=function(){return this.w(Nn)};y.prototype.readUnsignedVarint64=y.prototype.Ga;y.prototype.Ha=function(){return this.w($s)};y.prototype.readUnsignedVarint64String=y.prototype.Ha;y.prototype.sa=function(){return this.w(Ws)};y.prototype.readSignedVarint64=y.prototype.sa;y.prototype.Fa=function(){return this.w(Vs)};y.prototype.readSignedVarint64String=y.prototype.Fa;y.prototype.Ja=function(){return this.w(Uv)};y.prototype.readZigzagVarint64=y.prototype.Ja;y.prototype.fb=function(){return this.ea(vl)};y.prototype.readZigzagVarintHash64=y.prototype.fb;y.prototype.Ka=function(){return this.ea(Vs)};y.prototype.readZigzagVarint64String=y.prototype.Ka;y.prototype.Gc=function(){var t=this.b[this.a];return this.a+=1,v(this.a<=this.c),t};y.prototype.readUint8=y.prototype.Gc;y.prototype.Ec=function(){var t=this.b[this.a],e=this.b[this.a+1];return this.a+=2,v(this.a<=this.c),t<<0|e<<8};y.prototype.readUint16=y.prototype.Ec;y.prototype.m=function(){var t=this.b[this.a],e=this.b[this.a+1],r=this.b[this.a+2],i=this.b[this.a+3];return this.a+=4,v(this.a<=this.c),(t<<0|e<<8|r<<16|i<<24)>>>0};y.prototype.readUint32=y.prototype.m;y.prototype.ga=function(){var t=this.m(),e=this.m();return Nn(t,e)};y.prototype.readUint64=y.prototype.ga;y.prototype.ha=function(){var t=this.m(),e=this.m();return $s(t,e)};y.prototype.readUint64String=y.prototype.ha;y.prototype.Xb=function(){var t=this.b[this.a];return this.a+=1,v(this.a<=this.c),t<<24>>24};y.prototype.readInt8=y.prototype.Xb;y.prototype.Vb=function(){var t=this.b[this.a],e=this.b[this.a+1];return this.a+=2,v(this.a<=this.c),(t<<0|e<<8)<<16>>16};y.prototype.readInt16=y.prototype.Vb;y.prototype.P=function(){var t=this.b[this.a],e=this.b[this.a+1],r=this.b[this.a+2],i=this.b[this.a+3];return this.a+=4,v(this.a<=this.c),t<<0|e<<8|r<<16|i<<24};y.prototype.readInt32=y.prototype.P;y.prototype.ba=function(){var t=this.m(),e=this.m();return Ws(t,e)};y.prototype.readInt64=y.prototype.ba;y.prototype.ca=function(){var t=this.m(),e=this.m();return Vs(t,e)};y.prototype.readInt64String=y.prototype.ca;y.prototype.aa=function(){var t=this.m();return zv(t,0)};y.prototype.readFloat=y.prototype.aa;y.prototype.Z=function(){var t=this.m(),e=this.m();return Hv(t,e)};y.prototype.readDouble=y.prototype.Z;y.prototype.pa=function(){return!!this.b[this.a++]};y.prototype.readBool=y.prototype.pa;y.prototype.ra=function(){return this.da()};y.prototype.readEnum=y.prototype.ra;y.prototype.fa=function(t){var e=this.b,r=this.a;t=r+t;for(var i=[],n="";r<t;){var s=e[r++];if(128>s)i.push(s);else{if(192>s)continue;if(224>s){var o=e[r++];i.push((s&31)<<6|o&63)}else if(240>s){o=e[r++];var a=e[r++];i.push((s&15)<<12|(o&63)<<6|a&63)}else if(248>s){o=e[r++],a=e[r++];var l=e[r++];s=(s&7)<<18|(o&63)<<12|(a&63)<<6|l&63,s-=65536,i.push((s>>10&1023)+55296,(s&1023)+56320)}}8192<=i.length&&(n+=String.fromCharCode.apply(null,i),i.length=0)}return n+=Iv(i),this.a=r,n};y.prototype.readString=y.prototype.fa;y.prototype.Dc=function(){var t=this.o();return this.fa(t)};y.prototype.readStringWithLength=y.prototype.Dc;y.prototype.qa=function(t){if(0>t||this.a+t>this.b.length)return this.v=!0,Ue("Invalid byte length!"),new Uint8Array(0);var e=this.b.subarray(this.a,this.a+t);return this.a+=t,v(this.a<=this.c),e};y.prototype.readBytes=y.prototype.qa;y.prototype.ia=function(){return this.w(vl)};y.prototype.readVarintHash64=y.prototype.ia;y.prototype.$=function(){var t=this.b,e=this.a,r=t[e],i=t[e+1],n=t[e+2],s=t[e+3],o=t[e+4],a=t[e+5],l=t[e+6];return t=t[e+7],this.a+=8,String.fromCharCode(r,i,n,s,o,a,l,t)};y.prototype.readFixedHash64=y.prototype.$;function g(t,e,r){this.a=Sl(t,e,r),this.O=this.a.B(),this.b=this.c=-1,this.h=!1,this.v=null}B("jspb.BinaryReader",g,void 0);var Mn=[];g.clearInstanceCache=function(){Mn=[]};g.getInstanceCacheLength=function(){return Mn.length};function Vv(t,e,r){if(Mn.length){var i=Mn.pop();return t&&i.a.H(t,e,r),i}return new g(t,e,r)}g.alloc=Vv;g.prototype.zb=Vv;g.prototype.alloc=g.prototype.zb;g.prototype.Ca=function(){this.a.clear(),this.b=this.c=-1,this.h=!1,this.v=null,100>Mn.length&&Mn.push(this)};g.prototype.free=g.prototype.Ca;g.prototype.Fb=function(){return this.O};g.prototype.getFieldCursor=g.prototype.Fb;g.prototype.B=function(){return this.a.B()};g.prototype.getCursor=g.prototype.B;g.prototype.Y=function(){return this.a.Y()};g.prototype.getBuffer=g.prototype.Y;g.prototype.Hb=function(){return this.c};g.prototype.getFieldNumber=g.prototype.Hb;g.prototype.Lb=function(){return this.b};g.prototype.getWireType=g.prototype.Lb;g.prototype.Mb=function(){return this.b==2};g.prototype.isDelimited=g.prototype.Mb;g.prototype.bb=function(){return this.b==4};g.prototype.isEndGroup=g.prototype.bb;g.prototype.getError=function(){return this.h||this.a.getError()};g.prototype.getError=g.prototype.getError;g.prototype.H=function(t,e,r){this.a.H(t,e,r),this.b=this.c=-1};g.prototype.setBlock=g.prototype.H;g.prototype.reset=function(){this.a.reset(),this.b=this.c=-1};g.prototype.reset=g.prototype.reset;g.prototype.advance=function(t){this.a.advance(t)};g.prototype.advance=g.prototype.advance;g.prototype.oa=function(){if(this.a.ya())return!1;if(this.getError())return Ue("Decoder hit an error"),!1;this.O=this.a.B();var t=this.a.o(),e=t>>>3;return t&=7,t!=0&&t!=5&&t!=1&&t!=2&&t!=3&&t!=4?(Ue("Invalid wire type: %s (at position %s)",t,this.O),this.h=!0,!1):(this.c=e,this.b=t,!0)};g.prototype.nextField=g.prototype.oa;g.prototype.Oa=function(){this.a.mb(this.c<<3|this.b)};g.prototype.unskipHeader=g.prototype.Oa;g.prototype.Lc=function(){var t=this.c;for(this.Oa();this.oa()&&this.c==t;)this.C();this.a.ya()||this.Oa()};g.prototype.skipMatchingFields=g.prototype.Lc;g.prototype.lb=function(){this.b!=0?(Ue("Invalid wire type for skipVarintField"),this.C()):this.a.kb()};g.prototype.skipVarintField=g.prototype.lb;g.prototype.gb=function(){if(this.b!=2)Ue("Invalid wire type for skipDelimitedField"),this.C();else{var t=this.a.o();this.a.advance(t)}};g.prototype.skipDelimitedField=g.prototype.gb;g.prototype.hb=function(){this.b!=5?(Ue("Invalid wire type for skipFixed32Field"),this.C()):this.a.advance(4)};g.prototype.skipFixed32Field=g.prototype.hb;g.prototype.ib=function(){this.b!=1?(Ue("Invalid wire type for skipFixed64Field"),this.C()):this.a.advance(8)};g.prototype.skipFixed64Field=g.prototype.ib;g.prototype.jb=function(){var t=this.c;do{if(!this.oa()){Ue("Unmatched start-group tag: stream EOF"),this.h=!0;break}if(this.b==4){this.c!=t&&(Ue("Unmatched end-group tag"),this.h=!0);break}this.C()}while(!0)};g.prototype.skipGroup=g.prototype.jb;g.prototype.C=function(){switch(this.b){case 0:this.lb();break;case 1:this.ib();break;case 2:this.gb();break;case 5:this.hb();break;case 3:this.jb();break;default:Ue("Invalid wire encoding for field.")}};g.prototype.skipField=g.prototype.C;g.prototype.Hc=function(t,e){this.v===null&&(this.v={}),v(!this.v[t]),this.v[t]=e};g.prototype.registerReadCallback=g.prototype.Hc;g.prototype.Ic=function(t){return v(this.v!==null),t=this.v[t],v(t),t(this)};g.prototype.runReadCallback=g.prototype.Ic;g.prototype.Yb=function(t,e){v(this.b==2);var r=this.a.c,i=this.a.o();i=this.a.B()+i,this.a.setEnd(i),e(t,this),this.a.Ma(i),this.a.setEnd(r)};g.prototype.readMessage=g.prototype.Yb;g.prototype.Ub=function(t,e,r){v(this.b==3),v(this.c==t),r(e,this),this.h||this.b==4||(Ue("Group submessage did not end with an END_GROUP tag"),this.h=!0)};g.prototype.readGroup=g.prototype.Ub;g.prototype.Gb=function(){v(this.b==2);var t=this.a.o(),e=this.a.B(),r=e+t;return t=Sl(this.a.Y(),e,t),this.a.Ma(r),t};g.prototype.getFieldDecoder=g.prototype.Gb;g.prototype.P=function(){return v(this.b==0),this.a.da()};g.prototype.readInt32=g.prototype.P;g.prototype.Wb=function(){return v(this.b==0),this.a.Ea()};g.prototype.readInt32String=g.prototype.Wb;g.prototype.ba=function(){return v(this.b==0),this.a.sa()};g.prototype.readInt64=g.prototype.ba;g.prototype.ca=function(){return v(this.b==0),this.a.Fa()};g.prototype.readInt64String=g.prototype.ca;g.prototype.m=function(){return v(this.b==0),this.a.o()};g.prototype.readUint32=g.prototype.m;g.prototype.Fc=function(){return v(this.b==0),this.a.O()};g.prototype.readUint32String=g.prototype.Fc;g.prototype.ga=function(){return v(this.b==0),this.a.Ga()};g.prototype.readUint64=g.prototype.ga;g.prototype.ha=function(){return v(this.b==0),this.a.Ha()};g.prototype.readUint64String=g.prototype.ha;g.prototype.zc=function(){return v(this.b==0),this.a.Ia()};g.prototype.readSint32=g.prototype.zc;g.prototype.Ac=function(){return v(this.b==0),this.a.Ja()};g.prototype.readSint64=g.prototype.Ac;g.prototype.Bc=function(){return v(this.b==0),this.a.Ka()};g.prototype.readSint64String=g.prototype.Bc;g.prototype.Rb=function(){return v(this.b==5),this.a.m()};g.prototype.readFixed32=g.prototype.Rb;g.prototype.Sb=function(){return v(this.b==1),this.a.ga()};g.prototype.readFixed64=g.prototype.Sb;g.prototype.Tb=function(){return v(this.b==1),this.a.ha()};g.prototype.readFixed64String=g.prototype.Tb;g.prototype.vc=function(){return v(this.b==5),this.a.P()};g.prototype.readSfixed32=g.prototype.vc;g.prototype.wc=function(){return v(this.b==5),this.a.P().toString()};g.prototype.readSfixed32String=g.prototype.wc;g.prototype.xc=function(){return v(this.b==1),this.a.ba()};g.prototype.readSfixed64=g.prototype.xc;g.prototype.yc=function(){return v(this.b==1),this.a.ca()};g.prototype.readSfixed64String=g.prototype.yc;g.prototype.aa=function(){return v(this.b==5),this.a.aa()};g.prototype.readFloat=g.prototype.aa;g.prototype.Z=function(){return v(this.b==1),this.a.Z()};g.prototype.readDouble=g.prototype.Z;g.prototype.pa=function(){return v(this.b==0),!!this.a.o()};g.prototype.readBool=g.prototype.pa;g.prototype.ra=function(){return v(this.b==0),this.a.sa()};g.prototype.readEnum=g.prototype.ra;g.prototype.fa=function(){v(this.b==2);var t=this.a.o();return this.a.fa(t)};g.prototype.readString=g.prototype.fa;g.prototype.qa=function(){v(this.b==2);var t=this.a.o();return this.a.qa(t)};g.prototype.readBytes=g.prototype.qa;g.prototype.ia=function(){return v(this.b==0),this.a.ia()};g.prototype.readVarintHash64=g.prototype.ia;g.prototype.Cc=function(){return v(this.b==0),this.a.fb()};g.prototype.readSintHash64=g.prototype.Cc;g.prototype.w=function(t){return v(this.b==0),this.a.w(t)};g.prototype.readSplitVarint64=g.prototype.w;g.prototype.ea=function(t){return v(this.b==0),this.a.w(function(e,r){return yl(e,r,t)})};g.prototype.readSplitZigzagVarint64=g.prototype.ea;g.prototype.$=function(){return v(this.b==1),this.a.$()};g.prototype.readFixedHash64=g.prototype.$;g.prototype.ta=function(t){return v(this.b==1),this.a.ta(t)};g.prototype.readSplitFixed64=g.prototype.ta;function Te(t,e){v(t.b==2);var r=t.a.o();r=t.a.B()+r;for(var i=[];t.a.B()<r;)i.push(e.call(t.a));return i}g.prototype.gc=function(){return Te(this,this.a.da)};g.prototype.readPackedInt32=g.prototype.gc;g.prototype.hc=function(){return Te(this,this.a.Ea)};g.prototype.readPackedInt32String=g.prototype.hc;g.prototype.ic=function(){return Te(this,this.a.sa)};g.prototype.readPackedInt64=g.prototype.ic;g.prototype.jc=function(){return Te(this,this.a.Fa)};g.prototype.readPackedInt64String=g.prototype.jc;g.prototype.qc=function(){return Te(this,this.a.o)};g.prototype.readPackedUint32=g.prototype.qc;g.prototype.rc=function(){return Te(this,this.a.O)};g.prototype.readPackedUint32String=g.prototype.rc;g.prototype.sc=function(){return Te(this,this.a.Ga)};g.prototype.readPackedUint64=g.prototype.sc;g.prototype.tc=function(){return Te(this,this.a.Ha)};g.prototype.readPackedUint64String=g.prototype.tc;g.prototype.nc=function(){return Te(this,this.a.Ia)};g.prototype.readPackedSint32=g.prototype.nc;g.prototype.oc=function(){return Te(this,this.a.Ja)};g.prototype.readPackedSint64=g.prototype.oc;g.prototype.pc=function(){return Te(this,this.a.Ka)};g.prototype.readPackedSint64String=g.prototype.pc;g.prototype.bc=function(){return Te(this,this.a.m)};g.prototype.readPackedFixed32=g.prototype.bc;g.prototype.cc=function(){return Te(this,this.a.ga)};g.prototype.readPackedFixed64=g.prototype.cc;g.prototype.dc=function(){return Te(this,this.a.ha)};g.prototype.readPackedFixed64String=g.prototype.dc;g.prototype.kc=function(){return Te(this,this.a.P)};g.prototype.readPackedSfixed32=g.prototype.kc;g.prototype.lc=function(){return Te(this,this.a.ba)};g.prototype.readPackedSfixed64=g.prototype.lc;g.prototype.mc=function(){return Te(this,this.a.ca)};g.prototype.readPackedSfixed64String=g.prototype.mc;g.prototype.fc=function(){return Te(this,this.a.aa)};g.prototype.readPackedFloat=g.prototype.fc;g.prototype.$b=function(){return Te(this,this.a.Z)};g.prototype.readPackedDouble=g.prototype.$b;g.prototype.Zb=function(){return Te(this,this.a.pa)};g.prototype.readPackedBool=g.prototype.Zb;g.prototype.ac=function(){return Te(this,this.a.ra)};g.prototype.readPackedEnum=g.prototype.ac;g.prototype.uc=function(){return Te(this,this.a.ia)};g.prototype.readPackedVarintHash64=g.prototype.uc;g.prototype.ec=function(){return Te(this,this.a.$)};g.prototype.readPackedFixedHash64=g.prototype.ec;function Bs(t,e,r,i,n){this.ma=t,this.Ba=e,this.la=r,this.Na=i,this.na=n}B("jspb.ExtensionFieldInfo",Bs,void 0);function Gv(t,e,r,i,n,s){this.Za=t,this.za=e,this.Aa=r,this.Wa=i,this.Ab=n,this.Nb=s}B("jspb.ExtensionFieldBinaryInfo",Gv,void 0);Bs.prototype.F=function(){return!!this.la};Bs.prototype.isMessageType=Bs.prototype.F;function D(){}B("jspb.Message",D,void 0);D.GENERATE_TO_OBJECT=!0;D.GENERATE_FROM_OBJECT=!0;var Cl=typeof Uint8Array=="function";D.prototype.Ib=function(){return this.b};D.prototype.getJsPbMessageId=D.prototype.Ib;D.initialize=function(t,e,r,i,n,s){t.f=null,e||(e=r?[r]:[]),t.b=r?String(r):void 0,t.D=r===0?-1:0,t.u=e;e:{if(r=t.u.length,e=-1,r&&(e=r-1,r=t.u[e],!(r===null||typeof r!="object"||Array.isArray(r)||Cl&&r instanceof Uint8Array))){t.G=e-t.D,t.i=r;break e}-1<i?(t.G=Math.max(i,e+1-t.D),t.i=null):t.G=Number.MAX_VALUE}if(t.a={},n)for(i=0;i<n.length;i++)e=n[i],e<t.G?(e+=t.D,t.u[e]=t.u[e]||js):(bl(t),t.i[e]=t.i[e]||js);if(s&&s.length)for(i=0;i<s.length;i++)Qh(t,s[i])};var js=Object.freeze?Object.freeze([]):[];function bl(t){var e=t.G+t.D;t.u[e]||(t.i=t.u[e]={})}function Zv(t,e,r){for(var i=[],n=0;n<t.length;n++)i[n]=e.call(t[n],r,t[n]);return i}D.toObjectList=Zv;D.toObjectExtension=function(t,e,r,i,n){for(var s in r){var o=r[s],a=i.call(t,o);if(a!=null){for(var l in o.Ba)if(o.Ba.hasOwnProperty(l))break;e[l]=o.Na?o.na?Zv(a,o.Na,n):o.Na(n,a):a}}};D.serializeBinaryExtensions=function(t,e,r,i){for(var n in r){var s=r[n],o=s.Za;if(!s.Aa)throw Error("Message extension present that was generated without binary serialization support");var a=i.call(t,o);if(a!=null)if(o.F())if(s.Wa)s.Aa.call(e,o.ma,a,s.Wa);else throw Error("Message extension present holding submessage without binary support enabled, and message is being serialized to binary format");else s.Aa.call(e,o.ma,a)}};D.readBinaryExtension=function(t,e,r,i,n){var s=r[e.c];if(s){if(r=s.Za,!s.za)throw Error("Deserializing extension whose generated code does not support binary format");if(r.F()){var o=new r.la;s.za.call(e,o,s.Ab)}else o=s.za.call(e);r.na&&!s.Nb?(e=i.call(t,r))?e.push(o):n.call(t,r,[o]):n.call(t,r,o)}else e.C()};function yt(t,e){if(e<t.G){e+=t.D;var r=t.u[e];return r===js?t.u[e]=[]:r}if(t.i)return r=t.i[e],r===js?t.i[e]=[]:r}D.getField=yt;D.getRepeatedField=function(t,e){return yt(t,e)};function Yv(t,e){return t=yt(t,e),t==null?t:+t}D.getOptionalFloatingPointField=Yv;function Jv(t,e){return t=yt(t,e),t==null?t:!!t}D.getBooleanField=Jv;D.getRepeatedFloatingPointField=function(t,e){var r=yt(t,e);if(t.a||(t.a={}),!t.a[e]){for(var i=0;i<r.length;i++)r[i]=+r[i];t.a[e]=!0}return r};D.getRepeatedBooleanField=function(t,e){var r=yt(t,e);if(t.a||(t.a={}),!t.a[e]){for(var i=0;i<r.length;i++)r[i]=!!r[i];t.a[e]=!0}return r};function Kv(t){return t==null||typeof t=="string"?t:Cl&&t instanceof Uint8Array?Dv(t):(Ue("Cannot coerce to b64 string: "+kr(t)),null)}D.bytesAsB64=Kv;function Xv(t){return t==null||t instanceof Uint8Array?t:typeof t=="string"?Lv(t):(Ue("Cannot coerce to Uint8Array: "+kr(t)),null)}D.bytesAsU8=Xv;D.bytesListAsB64=function(t){return Qv(t),t.length&&typeof t[0]!="string"?Us(t,Kv):t};D.bytesListAsU8=function(t){return Qv(t),!t.length||t[0]instanceof Uint8Array?t:Us(t,Xv)};function Qv(t){if(t&&1<t.length){var e=kr(t[0]);Qk(t,function(r){kr(r)!=e&&Ue("Inconsistent type in JSPB repeated field array. Got "+kr(r)+" expected "+e)})}}function e0(t,e,r){return t=yt(t,e),t??r}D.getFieldWithDefault=e0;D.getBooleanFieldWithDefault=function(t,e,r){return t=Jv(t,e),t??r};D.getFloatingPointFieldWithDefault=function(t,e,r){return t=Yv(t,e),t??r};D.getFieldProto3=e0;D.getMapField=function(t,e,r,i){if(t.f||(t.f={}),e in t.f)return t.f[e];var n=yt(t,e);if(!n){if(r)return;n=[],xr(t,e,n)}return t.f[e]=new Y(n,i)};function xr(t,e,r){return Zt(t,D),e<t.G?t.u[e+t.D]=r:(bl(t),t.i[e]=r),t}D.setField=xr;D.setProto3IntField=function(t,e,r){return Ui(t,e,r,0)};D.setProto3FloatField=function(t,e,r){return Ui(t,e,r,0)};D.setProto3BooleanField=function(t,e,r){return Ui(t,e,r,!1)};D.setProto3StringField=function(t,e,r){return Ui(t,e,r,"")};D.setProto3BytesField=function(t,e,r){return Ui(t,e,r,"")};D.setProto3EnumField=function(t,e,r){return Ui(t,e,r,0)};D.setProto3StringIntField=function(t,e,r){return Ui(t,e,r,"0")};function Ui(t,e,r,i){return Zt(t,D),r!==i?xr(t,e,r):e<t.G?t.u[e+t.D]=null:(bl(t),delete t.i[e]),t}D.addToRepeatedField=function(t,e,r,i){return Zt(t,D),e=yt(t,e),i!=null?e.splice(i,0,r):e.push(r),t};function t0(t,e,r,i){return Zt(t,D),(r=Qh(t,r))&&r!==e&&i!==void 0&&(t.f&&r in t.f&&(t.f[r]=void 0),xr(t,r,void 0)),xr(t,e,i)}D.setOneofField=t0;function Qh(t,e){for(var r,i,n=0;n<e.length;n++){var s=e[n],o=yt(t,s);o!=null&&(r=s,i=o,xr(t,s,void 0))}return r?(xr(t,r,i),r):0}D.computeOneofCase=Qh;D.getWrapperField=function(t,e,r,i){if(t.f||(t.f={}),!t.f[r]){var n=yt(t,r);(i||n)&&(t.f[r]=new e(n))}return t.f[r]};D.getRepeatedWrapperField=function(t,e,r){return r0(t,e,r),e=t.f[r],e==js&&(e=t.f[r]=[]),e};function r0(t,e,r){if(t.f||(t.f={}),!t.f[r]){for(var i=yt(t,r),n=[],s=0;s<i.length;s++)n[s]=new e(i[s]);t.f[r]=n}}D.setWrapperField=function(t,e,r){Zt(t,D),t.f||(t.f={});var i=r&&r.g();return t.f[e]=r,xr(t,e,i)};D.setOneofWrapperField=function(t,e,r,i){Zt(t,D),t.f||(t.f={});var n=i&&i.g();return t.f[e]=i,t0(t,e,r,n)};D.setRepeatedWrapperField=function(t,e,r){Zt(t,D),t.f||(t.f={}),r=r||[];for(var i=[],n=0;n<r.length;n++)i[n]=r[n].g();return t.f[e]=r,xr(t,e,i)};D.addToRepeatedWrapperField=function(t,e,r,i,n){r0(t,i,e);var s=t.f[e];return s||(s=t.f[e]=[]),r=r||new i,t=yt(t,e),n!=null?(s.splice(n,0,r),t.splice(n,0,r.g())):(s.push(r),t.push(r.g())),r};D.toMap=function(t,e,r,i){for(var n={},s=0;s<t.length;s++)n[e.call(t[s])]=r?r.call(t[s],i,t[s]):t[s];return n};function i0(t){if(t.f)for(var e in t.f){var r=t.f[e];if(Array.isArray(r))for(var i=0;i<r.length;i++)r[i]&&r[i].g();else r&&r.g()}}D.prototype.g=function(){return i0(this),this.u};D.prototype.toArray=D.prototype.g;D.prototype.toString=function(){return i0(this),this.u.toString()};D.prototype.getExtension=function(t){if(this.i){this.f||(this.f={});var e=t.ma;if(t.na){if(t.F())return this.f[e]||(this.f[e]=Us(this.i[e]||[],function(r){return new t.la(r)})),this.f[e]}else if(t.F())return!this.f[e]&&this.i[e]&&(this.f[e]=new t.la(this.i[e])),this.f[e];return this.i[e]}};D.prototype.getExtension=D.prototype.getExtension;D.prototype.Kc=function(t,e){this.f||(this.f={}),bl(this);var r=t.ma;return t.na?(e=e||[],t.F()?(this.f[r]=e,this.i[r]=Us(e,function(i){return i.g()})):this.i[r]=e):t.F()?(this.f[r]=e,this.i[r]=e&&e.g()):this.i[r]=e,this};D.prototype.setExtension=D.prototype.Kc;D.difference=function(t,e){if(!(t instanceof e.constructor))throw Error("Messages have different types.");var r=t.g();e=e.g();var i=[],n=0,s=r.length>e.length?r.length:e.length;for(t.b&&(i[0]=t.b,n=1);n<s;n++)Zs(r[n],e[n])||(i[n]=e[n]);return new t.constructor(i)};D.equals=function(t,e){return t==e||!(!t||!e)&&t instanceof e.constructor&&Zs(t.g(),e.g())};function Gh(t,e){t=t||{},e=e||{};var r={},i;for(i in t)r[i]=0;for(i in e)r[i]=0;for(i in r)if(!Zs(t[i],e[i]))return!1;return!0}D.compareExtensions=Gh;function Zs(t,e){if(t==e)return!0;if(!wv(t)||!wv(e))return typeof t=="number"&&isNaN(t)||typeof e=="number"&&isNaN(e)?String(t)==String(e):!1;if(t.constructor!=e.constructor)return!1;if(Cl&&t.constructor===Uint8Array){if(t.length!=e.length)return!1;for(var r=0;r<t.length;r++)if(t[r]!=e[r])return!1;return!0}if(t.constructor===Array){var i=void 0,n=void 0,s=Math.max(t.length,e.length);for(r=0;r<s;r++){var o=t[r],a=e[r];if(o&&o.constructor==Object&&(v(i===void 0),v(r===t.length-1),i=o,o=void 0),a&&a.constructor==Object&&(v(n===void 0),v(r===e.length-1),n=a,a=void 0),!Zs(o,a))return!1}return i||n?(i=i||{},n=n||{},Gh(i,n)):!0}if(t.constructor===Object)return Gh(t,e);throw Error("Invalid type in JSPB array")}D.compareFields=Zs;D.prototype.Bb=function(){return El(this)};D.prototype.cloneMessage=D.prototype.Bb;D.prototype.clone=function(){return El(this)};D.prototype.clone=D.prototype.clone;D.clone=function(t){return El(t)};function El(t){return new t.constructor(Zh(t.g()))}D.copyInto=function(t,e){Zt(t,D),Zt(e,D),v(t.constructor==e.constructor,"Copy source and target message should have the same type."),t=El(t);for(var r=e.g(),i=t.g(),n=r.length=0;n<i.length;n++)r[n]=i[n];e.f=t.f,e.i=t.i};function Zh(t){if(Array.isArray(t)){for(var e=Array(t.length),r=0;r<t.length;r++){var i=t[r];i!=null&&(e[r]=typeof i=="object"?Zh(v(i)):i)}return e}if(Cl&&t instanceof Uint8Array)return new Uint8Array(t);e={};for(r in t)i=t[r],i!=null&&(e[r]=typeof i=="object"?Zh(v(i)):i);return e}D.registerMessageType=function(t,e){e.we=t};var Gt={dump:function(t){return Zt(t,D,"jspb.Message instance expected"),v(t.getExtension,"Only unobfuscated and unoptimized compilation modes supported."),Gt.X(t)}};B("jspb.debug.dump",Gt.dump,void 0);Gt.X=function(t){var e=kr(t);if(e=="number"||e=="string"||e=="boolean"||e=="null"||e=="undefined"||typeof Uint8Array<"u"&&t instanceof Uint8Array)return t;if(e=="array")return rx(t),Us(t,Gt.X);if(t instanceof Y){var r={};t=t.entries();for(var i=t.next();!i.done;i=t.next())r[i.value[0]]=Gt.X(i.value[1]);return r}Zt(t,D,"Only messages expected: "+t),e=t.constructor;var n={$name:e.name||e.displayName};for(a in e.prototype){var s=/^get([A-Z]\w*)/.exec(a);if(s&&a!="getExtension"&&a!="getJsPbMessageId"){var o="has"+s[1];(!t[o]||t[o]())&&(o=t[a](),n[Gt.$a(s[1])]=Gt.X(o))}}if(t.extensionObject_)return n.$extensions="Recursive dumping of extensions not supported in compiled code. Switch to uncompiled or dump extension object directly",n;for(i in e.extensions)if(/^\d+$/.test(i)){o=e.extensions[i];var a=t.getExtension(o);s=void 0,o=o.Ba;var l=[],c=0;for(s in o)l[c++]=s;s=l[0],a!=null&&(r||(r=n.$extensions={}),r[Gt.$a(s)]=Gt.X(a))}return n};Gt.$a=function(t){return t.replace(/^[A-Z]/,function(e){return e.toLowerCase()})};function A(){this.a=[]}B("jspb.BinaryEncoder",A,void 0);A.prototype.length=function(){return this.a.length};A.prototype.length=A.prototype.length;A.prototype.end=function(){var t=this.a;return this.a=[],t};A.prototype.end=A.prototype.end;A.prototype.l=function(t,e){for(v(t==Math.floor(t)),v(e==Math.floor(e)),v(0<=t&&4294967296>t),v(0<=e&&4294967296>e);0<e||127<t;)this.a.push(t&127|128),t=(t>>>7|e<<25)>>>0,e>>>=7;this.a.push(t)};A.prototype.writeSplitVarint64=A.prototype.l;A.prototype.A=function(t,e){v(t==Math.floor(t)),v(e==Math.floor(e)),v(0<=t&&4294967296>t),v(0<=e&&4294967296>e),this.s(t),this.s(e)};A.prototype.writeSplitFixed64=A.prototype.A;A.prototype.j=function(t){for(v(t==Math.floor(t)),v(0<=t&&4294967296>t);127<t;)this.a.push(t&127|128),t>>>=7;this.a.push(t)};A.prototype.writeUnsignedVarint32=A.prototype.j;A.prototype.M=function(t){if(v(t==Math.floor(t)),v(-2147483648<=t&&2147483648>t),0<=t)this.j(t);else{for(var e=0;9>e;e++)this.a.push(t&127|128),t>>=7;this.a.push(1)}};A.prototype.writeSignedVarint32=A.prototype.M;A.prototype.va=function(t){v(t==Math.floor(t)),v(0<=t&&18446744073709552e3>t),Hs(t),this.l(de,he)};A.prototype.writeUnsignedVarint64=A.prototype.va;A.prototype.ua=function(t){v(t==Math.floor(t)),v(-9223372036854776e3<=t&&9223372036854776e3>t),Hs(t),this.l(de,he)};A.prototype.writeSignedVarint64=A.prototype.ua;A.prototype.wa=function(t){v(t==Math.floor(t)),v(-2147483648<=t&&2147483648>t),this.j((t<<1^t>>31)>>>0)};A.prototype.writeZigzagVarint32=A.prototype.wa;A.prototype.xa=function(t){v(t==Math.floor(t)),v(-9223372036854776e3<=t&&9223372036854776e3>t),qv(t),this.l(de,he)};A.prototype.writeZigzagVarint64=A.prototype.xa;A.prototype.Ta=function(t){this.W(Gs(t))};A.prototype.writeZigzagVarint64String=A.prototype.Ta;A.prototype.W=function(t){var e=this;ei(t),ml(de,he,function(r,i){e.l(r>>>0,i>>>0)})};A.prototype.writeZigzagVarintHash64=A.prototype.W;A.prototype.be=function(t){v(t==Math.floor(t)),v(0<=t&&256>t),this.a.push(t>>>0&255)};A.prototype.writeUint8=A.prototype.be;A.prototype.ae=function(t){v(t==Math.floor(t)),v(0<=t&&65536>t),this.a.push(t>>>0&255),this.a.push(t>>>8&255)};A.prototype.writeUint16=A.prototype.ae;A.prototype.s=function(t){v(t==Math.floor(t)),v(0<=t&&4294967296>t),this.a.push(t>>>0&255),this.a.push(t>>>8&255),this.a.push(t>>>16&255),this.a.push(t>>>24&255)};A.prototype.writeUint32=A.prototype.s;A.prototype.V=function(t){v(t==Math.floor(t)),v(0<=t&&18446744073709552e3>t),Xh(t),this.s(de),this.s(he)};A.prototype.writeUint64=A.prototype.V;A.prototype.Qc=function(t){v(t==Math.floor(t)),v(-128<=t&&128>t),this.a.push(t>>>0&255)};A.prototype.writeInt8=A.prototype.Qc;A.prototype.Pc=function(t){v(t==Math.floor(t)),v(-32768<=t&&32768>t),this.a.push(t>>>0&255),this.a.push(t>>>8&255)};A.prototype.writeInt16=A.prototype.Pc;A.prototype.S=function(t){v(t==Math.floor(t)),v(-2147483648<=t&&2147483648>t),this.a.push(t>>>0&255),this.a.push(t>>>8&255),this.a.push(t>>>16&255),this.a.push(t>>>24&255)};A.prototype.writeInt32=A.prototype.S;A.prototype.T=function(t){v(t==Math.floor(t)),v(-9223372036854776e3<=t&&9223372036854776e3>t),Hs(t),this.A(de,he)};A.prototype.writeInt64=A.prototype.T;A.prototype.ka=function(t){v(t==Math.floor(t)),v(-9223372036854776e3<=+t&&9223372036854776e3>+t),ei(Gs(t)),this.A(de,he)};A.prototype.writeInt64String=A.prototype.ka;A.prototype.L=function(t){v(t===1/0||t===-1/0||isNaN(t)||-34028234663852886e22<=t&&34028234663852886e22>=t),Bv(t),this.s(de)};A.prototype.writeFloat=A.prototype.L;A.prototype.J=function(t){v(t===1/0||t===-1/0||isNaN(t)||-17976931348623157e292<=t&&17976931348623157e292>=t),jv(t),this.s(de),this.s(he)};A.prototype.writeDouble=A.prototype.J;A.prototype.I=function(t){v(typeof t=="boolean"||typeof t=="number"),this.a.push(t?1:0)};A.prototype.writeBool=A.prototype.I;A.prototype.R=function(t){v(t==Math.floor(t)),v(-2147483648<=t&&2147483648>t),this.M(t)};A.prototype.writeEnum=A.prototype.R;A.prototype.ja=function(t){this.a.push.apply(this.a,t)};A.prototype.writeBytes=A.prototype.ja;A.prototype.N=function(t){ei(t),this.l(de,he)};A.prototype.writeVarintHash64=A.prototype.N;A.prototype.K=function(t){ei(t),this.s(de),this.s(he)};A.prototype.writeFixedHash64=A.prototype.K;A.prototype.U=function(t){var e=this.a.length;tx(t);for(var r=0;r<t.length;r++){var i=t.charCodeAt(r);if(128>i)this.a.push(i);else if(2048>i)this.a.push(i>>6|192),this.a.push(i&63|128);else if(65536>i)if(55296<=i&&56319>=i&&r+1<t.length){var n=t.charCodeAt(r+1);56320<=n&&57343>=n&&(i=1024*(i-55296)+n-56320+65536,this.a.push(i>>18|240),this.a.push(i>>12&63|128),this.a.push(i>>6&63|128),this.a.push(i&63|128),r++)}else this.a.push(i>>12|224),this.a.push(i>>6&63|128),this.a.push(i&63|128)}return this.a.length-e};A.prototype.writeString=A.prototype.U;function V(t,e){this.lo=t,this.hi=e}B("jspb.arith.UInt64",V,void 0);V.prototype.cmp=function(t){return this.hi<t.hi||this.hi==t.hi&&this.lo<t.lo?-1:this.hi==t.hi&&this.lo==t.lo?0:1};V.prototype.cmp=V.prototype.cmp;V.prototype.La=function(){return new V((this.lo>>>1|(this.hi&1)<<31)>>>0,this.hi>>>1>>>0)};V.prototype.rightShift=V.prototype.La;V.prototype.Da=function(){return new V(this.lo<<1>>>0,(this.hi<<1|this.lo>>>31)>>>0)};V.prototype.leftShift=V.prototype.Da;V.prototype.cb=function(){return!!(this.hi&2147483648)};V.prototype.msb=V.prototype.cb;V.prototype.Ob=function(){return!!(this.lo&1)};V.prototype.lsb=V.prototype.Ob;V.prototype.Ua=function(){return this.lo==0&&this.hi==0};V.prototype.zero=V.prototype.Ua;V.prototype.add=function(t){return new V((this.lo+t.lo&4294967295)>>>0>>>0,((this.hi+t.hi&4294967295)>>>0)+(4294967296<=this.lo+t.lo?1:0)>>>0)};V.prototype.add=V.prototype.add;V.prototype.sub=function(t){return new V((this.lo-t.lo&4294967295)>>>0>>>0,((this.hi-t.hi&4294967295)>>>0)-(0>this.lo-t.lo?1:0)>>>0)};V.prototype.sub=V.prototype.sub;function Yh(t,e){var r=t&65535;t>>>=16;var i=e&65535,n=e>>>16;for(e=r*i+65536*(r*n&65535)+65536*(t*i&65535),r=t*n+(r*n>>>16)+(t*i>>>16);4294967296<=e;)e-=4294967296,r+=1;return new V(e>>>0,r>>>0)}V.mul32x32=Yh;V.prototype.eb=function(t){var e=Yh(this.lo,t);return t=Yh(this.hi,t),t.hi=t.lo,t.lo=0,e.add(t)};V.prototype.mul=V.prototype.eb;V.prototype.Xa=function(t){if(t==0)return[];var e=new V(0,0),r=new V(this.lo,this.hi);t=new V(t,0);for(var i=new V(1,0);!t.cb();)t=t.Da(),i=i.Da();for(;!i.Ua();)0>=t.cmp(r)&&(e=e.add(i),r=r.sub(t)),t=t.La(),i=i.La();return[e,r]};V.prototype.div=V.prototype.Xa;V.prototype.toString=function(){for(var t="",e=this;!e.Ua();){e=e.Xa(10);var r=e[0];t=e[1].lo+t,e=r}return t==""&&(t="0"),t};V.prototype.toString=V.prototype.toString;function Dn(t){for(var e=new V(0,0),r=new V(0,0),i=0;i<t.length;i++){if("0">t[i]||"9"<t[i])return null;r.lo=parseInt(t[i],10),e=e.eb(10).add(r)}return e}V.fromString=Dn;V.prototype.clone=function(){return new V(this.lo,this.hi)};V.prototype.clone=V.prototype.clone;function $e(t,e){this.lo=t,this.hi=e}B("jspb.arith.Int64",$e,void 0);$e.prototype.add=function(t){return new $e((this.lo+t.lo&4294967295)>>>0>>>0,((this.hi+t.hi&4294967295)>>>0)+(4294967296<=this.lo+t.lo?1:0)>>>0)};$e.prototype.add=$e.prototype.add;$e.prototype.sub=function(t){return new $e((this.lo-t.lo&4294967295)>>>0>>>0,((this.hi-t.hi&4294967295)>>>0)-(0>this.lo-t.lo?1:0)>>>0)};$e.prototype.sub=$e.prototype.sub;$e.prototype.clone=function(){return new $e(this.lo,this.hi)};$e.prototype.clone=$e.prototype.clone;$e.prototype.toString=function(){var t=(this.hi&2147483648)!=0,e=new V(this.lo,this.hi);return t&&(e=new V(0,0).sub(e)),(t?"-":"")+e.toString()};$e.prototype.toString=$e.prototype.toString;function Tl(t){var e=0<t.length&&t[0]=="-";return e&&(t=t.substring(1)),t=Dn(t),t===null?null:(e&&(t=new V(0,0).sub(t)),new $e(t.lo,t.hi))}$e.fromString=Tl;function d(){this.c=[],this.b=0,this.a=new A,this.h=[]}B("jspb.BinaryWriter",d,void 0);function n0(t,e){var r=t.a.end();t.c.push(r),t.c.push(e),t.b+=r.length+e.length}function xe(t,e){return G(t,e,2),e=t.a.end(),t.c.push(e),t.b+=e.length,e.push(t.b),e}function Oe(t,e){var r=e.pop();for(r=t.b+t.a.length()-r,v(0<=r);127<r;)e.push(r&127|128),r>>>=7,t.b++;e.push(r),t.b++}d.prototype.pb=function(t,e,r){n0(this,t.subarray(e,r))};d.prototype.writeSerializedMessage=d.prototype.pb;d.prototype.Pb=function(t,e,r){t!=null&&e!=null&&r!=null&&this.pb(t,e,r)};d.prototype.maybeWriteSerializedMessage=d.prototype.Pb;d.prototype.reset=function(){this.c=[],this.a.end(),this.b=0,this.h=[]};d.prototype.reset=d.prototype.reset;d.prototype.ab=function(){v(this.h.length==0);for(var t=new Uint8Array(this.b+this.a.length()),e=this.c,r=e.length,i=0,n=0;n<r;n++){var s=e[n];t.set(s,i),i+=s.length}return e=this.a.end(),t.set(e,i),i+=e.length,v(i==t.length),this.c=[t],t};d.prototype.getResultBuffer=d.prototype.ab;d.prototype.Kb=function(t){return Dv(this.ab(),t)};d.prototype.getResultBase64String=d.prototype.Kb;d.prototype.Va=function(t){this.h.push(xe(this,t))};d.prototype.beginSubMessage=d.prototype.Va;d.prototype.Ya=function(){v(0<=this.h.length),Oe(this,this.h.pop())};d.prototype.endSubMessage=d.prototype.Ya;function G(t,e,r){v(1<=e&&e==Math.floor(e)),t.a.j(8*e+r)}d.prototype.Nc=function(t,e,r){switch(t){case 1:this.J(e,r);break;case 2:this.L(e,r);break;case 3:this.T(e,r);break;case 4:this.V(e,r);break;case 5:this.S(e,r);break;case 6:this.Qa(e,r);break;case 7:this.Pa(e,r);break;case 8:this.I(e,r);break;case 9:this.U(e,r);break;case 10:Ue("Group field type not supported in writeAny()");break;case 11:Ue("Message field type not supported in writeAny()");break;case 12:this.ja(e,r);break;case 13:this.s(e,r);break;case 14:this.R(e,r);break;case 15:this.Ra(e,r);break;case 16:this.Sa(e,r);break;case 17:this.rb(e,r);break;case 18:this.sb(e,r);break;case 30:this.K(e,r);break;case 31:this.N(e,r);break;default:Ue("Invalid field type in writeAny()")}};d.prototype.writeAny=d.prototype.Nc;function ef(t,e,r){r!=null&&(G(t,e,0),t.a.j(r))}function tf(t,e,r){r!=null&&(G(t,e,0),t.a.M(r))}d.prototype.S=function(t,e){e!=null&&(v(-2147483648<=e&&2147483648>e),tf(this,t,e))};d.prototype.writeInt32=d.prototype.S;d.prototype.ob=function(t,e){e!=null&&(e=parseInt(e,10),v(-2147483648<=e&&2147483648>e),tf(this,t,e))};d.prototype.writeInt32String=d.prototype.ob;d.prototype.T=function(t,e){e!=null&&(v(-9223372036854776e3<=e&&9223372036854776e3>e),e!=null&&(G(this,t,0),this.a.ua(e)))};d.prototype.writeInt64=d.prototype.T;d.prototype.ka=function(t,e){e!=null&&(e=Tl(e),G(this,t,0),this.a.l(e.lo,e.hi))};d.prototype.writeInt64String=d.prototype.ka;d.prototype.s=function(t,e){e!=null&&(v(0<=e&&4294967296>e),ef(this,t,e))};d.prototype.writeUint32=d.prototype.s;d.prototype.ub=function(t,e){e!=null&&(e=parseInt(e,10),v(0<=e&&4294967296>e),ef(this,t,e))};d.prototype.writeUint32String=d.prototype.ub;d.prototype.V=function(t,e){e!=null&&(v(0<=e&&18446744073709552e3>e),e!=null&&(G(this,t,0),this.a.va(e)))};d.prototype.writeUint64=d.prototype.V;d.prototype.vb=function(t,e){e!=null&&(e=Dn(e),G(this,t,0),this.a.l(e.lo,e.hi))};d.prototype.writeUint64String=d.prototype.vb;d.prototype.rb=function(t,e){e!=null&&(v(-2147483648<=e&&2147483648>e),e!=null&&(G(this,t,0),this.a.wa(e)))};d.prototype.writeSint32=d.prototype.rb;d.prototype.sb=function(t,e){e!=null&&(v(-9223372036854776e3<=e&&9223372036854776e3>e),e!=null&&(G(this,t,0),this.a.xa(e)))};d.prototype.writeSint64=d.prototype.sb;d.prototype.$d=function(t,e){e!=null&&e!=null&&(G(this,t,0),this.a.W(e))};d.prototype.writeSintHash64=d.prototype.$d;d.prototype.Zd=function(t,e){e!=null&&e!=null&&(G(this,t,0),this.a.Ta(e))};d.prototype.writeSint64String=d.prototype.Zd;d.prototype.Pa=function(t,e){e!=null&&(v(0<=e&&4294967296>e),G(this,t,5),this.a.s(e))};d.prototype.writeFixed32=d.prototype.Pa;d.prototype.Qa=function(t,e){e!=null&&(v(0<=e&&18446744073709552e3>e),G(this,t,1),this.a.V(e))};d.prototype.writeFixed64=d.prototype.Qa;d.prototype.nb=function(t,e){e!=null&&(e=Dn(e),G(this,t,1),this.a.A(e.lo,e.hi))};d.prototype.writeFixed64String=d.prototype.nb;d.prototype.Ra=function(t,e){e!=null&&(v(-2147483648<=e&&2147483648>e),G(this,t,5),this.a.S(e))};d.prototype.writeSfixed32=d.prototype.Ra;d.prototype.Sa=function(t,e){e!=null&&(v(-9223372036854776e3<=e&&9223372036854776e3>e),G(this,t,1),this.a.T(e))};d.prototype.writeSfixed64=d.prototype.Sa;d.prototype.qb=function(t,e){e!=null&&(e=Tl(e),G(this,t,1),this.a.A(e.lo,e.hi))};d.prototype.writeSfixed64String=d.prototype.qb;d.prototype.L=function(t,e){e!=null&&(G(this,t,5),this.a.L(e))};d.prototype.writeFloat=d.prototype.L;d.prototype.J=function(t,e){e!=null&&(G(this,t,1),this.a.J(e))};d.prototype.writeDouble=d.prototype.J;d.prototype.I=function(t,e){e!=null&&(v(typeof e=="boolean"||typeof e=="number"),G(this,t,0),this.a.I(e))};d.prototype.writeBool=d.prototype.I;d.prototype.R=function(t,e){e!=null&&(v(-2147483648<=e&&2147483648>e),G(this,t,0),this.a.M(e))};d.prototype.writeEnum=d.prototype.R;d.prototype.U=function(t,e){e!=null&&(t=xe(this,t),this.a.U(e),Oe(this,t))};d.prototype.writeString=d.prototype.U;d.prototype.ja=function(t,e){e!=null&&(e=_l(e),G(this,t,2),this.a.j(e.length),n0(this,e))};d.prototype.writeBytes=d.prototype.ja;d.prototype.Rc=function(t,e,r){e!=null&&(t=xe(this,t),r(e,this),Oe(this,t))};d.prototype.writeMessage=d.prototype.Rc;d.prototype.Sc=function(t,e,r){e!=null&&(G(this,1,3),G(this,2,0),this.a.M(t),t=xe(this,3),r(e,this),Oe(this,t),G(this,1,4))};d.prototype.writeMessageSet=d.prototype.Sc;d.prototype.Oc=function(t,e,r){e!=null&&(G(this,t,3),r(e,this),G(this,t,4))};d.prototype.writeGroup=d.prototype.Oc;d.prototype.K=function(t,e){e!=null&&(v(e.length==8),G(this,t,1),this.a.K(e))};d.prototype.writeFixedHash64=d.prototype.K;d.prototype.N=function(t,e){e!=null&&(v(e.length==8),G(this,t,0),this.a.N(e))};d.prototype.writeVarintHash64=d.prototype.N;d.prototype.A=function(t,e,r){G(this,t,1),this.a.A(e,r)};d.prototype.writeSplitFixed64=d.prototype.A;d.prototype.l=function(t,e,r){G(this,t,0),this.a.l(e,r)};d.prototype.writeSplitVarint64=d.prototype.l;d.prototype.tb=function(t,e,r){G(this,t,0);var i=this.a;ml(e,r,function(n,s){i.l(n>>>0,s>>>0)})};d.prototype.writeSplitZigzagVarint64=d.prototype.tb;d.prototype.Ed=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)tf(this,t,e[r])};d.prototype.writeRepeatedInt32=d.prototype.Ed;d.prototype.Fd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.ob(t,e[r])};d.prototype.writeRepeatedInt32String=d.prototype.Fd;d.prototype.Gd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];i!=null&&(G(this,t,0),this.a.ua(i))}};d.prototype.writeRepeatedInt64=d.prototype.Gd;d.prototype.Qd=function(t,e,r,i){if(e!=null)for(var n=0;n<e.length;n++)this.A(t,r(e[n]),i(e[n]))};d.prototype.writeRepeatedSplitFixed64=d.prototype.Qd;d.prototype.Rd=function(t,e,r,i){if(e!=null)for(var n=0;n<e.length;n++)this.l(t,r(e[n]),i(e[n]))};d.prototype.writeRepeatedSplitVarint64=d.prototype.Rd;d.prototype.Sd=function(t,e,r,i){if(e!=null)for(var n=0;n<e.length;n++)this.tb(t,r(e[n]),i(e[n]))};d.prototype.writeRepeatedSplitZigzagVarint64=d.prototype.Sd;d.prototype.Hd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.ka(t,e[r])};d.prototype.writeRepeatedInt64String=d.prototype.Hd;d.prototype.Ud=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)ef(this,t,e[r])};d.prototype.writeRepeatedUint32=d.prototype.Ud;d.prototype.Vd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.ub(t,e[r])};d.prototype.writeRepeatedUint32String=d.prototype.Vd;d.prototype.Wd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];i!=null&&(G(this,t,0),this.a.va(i))}};d.prototype.writeRepeatedUint64=d.prototype.Wd;d.prototype.Xd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.vb(t,e[r])};d.prototype.writeRepeatedUint64String=d.prototype.Xd;d.prototype.Md=function(t,e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];i!=null&&(G(this,t,0),this.a.wa(i))}};d.prototype.writeRepeatedSint32=d.prototype.Md;d.prototype.Nd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];i!=null&&(G(this,t,0),this.a.xa(i))}};d.prototype.writeRepeatedSint64=d.prototype.Nd;d.prototype.Od=function(t,e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];i!=null&&(G(this,t,0),this.a.Ta(i))}};d.prototype.writeRepeatedSint64String=d.prototype.Od;d.prototype.Pd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++){var i=e[r];i!=null&&(G(this,t,0),this.a.W(i))}};d.prototype.writeRepeatedSintHash64=d.prototype.Pd;d.prototype.yd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.Pa(t,e[r])};d.prototype.writeRepeatedFixed32=d.prototype.yd;d.prototype.zd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.Qa(t,e[r])};d.prototype.writeRepeatedFixed64=d.prototype.zd;d.prototype.Ad=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.nb(t,e[r])};d.prototype.writeRepeatedFixed64String=d.prototype.Ad;d.prototype.Jd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.Ra(t,e[r])};d.prototype.writeRepeatedSfixed32=d.prototype.Jd;d.prototype.Kd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.Sa(t,e[r])};d.prototype.writeRepeatedSfixed64=d.prototype.Kd;d.prototype.Ld=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.qb(t,e[r])};d.prototype.writeRepeatedSfixed64String=d.prototype.Ld;d.prototype.Cd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.L(t,e[r])};d.prototype.writeRepeatedFloat=d.prototype.Cd;d.prototype.wd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.J(t,e[r])};d.prototype.writeRepeatedDouble=d.prototype.wd;d.prototype.ud=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.I(t,e[r])};d.prototype.writeRepeatedBool=d.prototype.ud;d.prototype.xd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.R(t,e[r])};d.prototype.writeRepeatedEnum=d.prototype.xd;d.prototype.Td=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.U(t,e[r])};d.prototype.writeRepeatedString=d.prototype.Td;d.prototype.vd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.ja(t,e[r])};d.prototype.writeRepeatedBytes=d.prototype.vd;d.prototype.Id=function(t,e,r){if(e!=null)for(var i=0;i<e.length;i++){var n=xe(this,t);r(e[i],this),Oe(this,n)}};d.prototype.writeRepeatedMessage=d.prototype.Id;d.prototype.Dd=function(t,e,r){if(e!=null)for(var i=0;i<e.length;i++)G(this,t,3),r(e[i],this),G(this,t,4)};d.prototype.writeRepeatedGroup=d.prototype.Dd;d.prototype.Bd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.K(t,e[r])};d.prototype.writeRepeatedFixedHash64=d.prototype.Bd;d.prototype.Yd=function(t,e){if(e!=null)for(var r=0;r<e.length;r++)this.N(t,e[r])};d.prototype.writeRepeatedVarintHash64=d.prototype.Yd;d.prototype.ad=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.M(e[r]);Oe(this,t)}};d.prototype.writePackedInt32=d.prototype.ad;d.prototype.bd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.M(parseInt(e[r],10));Oe(this,t)}};d.prototype.writePackedInt32String=d.prototype.bd;d.prototype.cd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.ua(e[r]);Oe(this,t)}};d.prototype.writePackedInt64=d.prototype.cd;d.prototype.md=function(t,e,r,i){if(e!=null){t=xe(this,t);for(var n=0;n<e.length;n++)this.a.A(r(e[n]),i(e[n]));Oe(this,t)}};d.prototype.writePackedSplitFixed64=d.prototype.md;d.prototype.nd=function(t,e,r,i){if(e!=null){t=xe(this,t);for(var n=0;n<e.length;n++)this.a.l(r(e[n]),i(e[n]));Oe(this,t)}};d.prototype.writePackedSplitVarint64=d.prototype.nd;d.prototype.od=function(t,e,r,i){if(e!=null){t=xe(this,t);for(var n=this.a,s=0;s<e.length;s++)ml(r(e[s]),i(e[s]),function(o,a){n.l(o>>>0,a>>>0)});Oe(this,t)}};d.prototype.writePackedSplitZigzagVarint64=d.prototype.od;d.prototype.dd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++){var i=Tl(e[r]);this.a.l(i.lo,i.hi)}Oe(this,t)}};d.prototype.writePackedInt64String=d.prototype.dd;d.prototype.pd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.j(e[r]);Oe(this,t)}};d.prototype.writePackedUint32=d.prototype.pd;d.prototype.qd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.j(parseInt(e[r],10));Oe(this,t)}};d.prototype.writePackedUint32String=d.prototype.qd;d.prototype.rd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.va(e[r]);Oe(this,t)}};d.prototype.writePackedUint64=d.prototype.rd;d.prototype.sd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++){var i=Dn(e[r]);this.a.l(i.lo,i.hi)}Oe(this,t)}};d.prototype.writePackedUint64String=d.prototype.sd;d.prototype.hd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.wa(e[r]);Oe(this,t)}};d.prototype.writePackedSint32=d.prototype.hd;d.prototype.jd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.xa(e[r]);Oe(this,t)}};d.prototype.writePackedSint64=d.prototype.jd;d.prototype.kd=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.W(Gs(e[r]));Oe(this,t)}};d.prototype.writePackedSint64String=d.prototype.kd;d.prototype.ld=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.W(e[r]);Oe(this,t)}};d.prototype.writePackedSintHash64=d.prototype.ld;d.prototype.Wc=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(4*e.length),t=0;t<e.length;t++)this.a.s(e[t])};d.prototype.writePackedFixed32=d.prototype.Wc;d.prototype.Xc=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(8*e.length),t=0;t<e.length;t++)this.a.V(e[t])};d.prototype.writePackedFixed64=d.prototype.Xc;d.prototype.Yc=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(8*e.length),t=0;t<e.length;t++){var r=Dn(e[t]);this.a.A(r.lo,r.hi)}};d.prototype.writePackedFixed64String=d.prototype.Yc;d.prototype.ed=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(4*e.length),t=0;t<e.length;t++)this.a.S(e[t])};d.prototype.writePackedSfixed32=d.prototype.ed;d.prototype.fd=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(8*e.length),t=0;t<e.length;t++)this.a.T(e[t])};d.prototype.writePackedSfixed64=d.prototype.fd;d.prototype.gd=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(8*e.length),t=0;t<e.length;t++)this.a.ka(e[t])};d.prototype.writePackedSfixed64String=d.prototype.gd;d.prototype.$c=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(4*e.length),t=0;t<e.length;t++)this.a.L(e[t])};d.prototype.writePackedFloat=d.prototype.$c;d.prototype.Uc=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(8*e.length),t=0;t<e.length;t++)this.a.J(e[t])};d.prototype.writePackedDouble=d.prototype.Uc;d.prototype.Tc=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(e.length),t=0;t<e.length;t++)this.a.I(e[t])};d.prototype.writePackedBool=d.prototype.Tc;d.prototype.Vc=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.R(e[r]);Oe(this,t)}};d.prototype.writePackedEnum=d.prototype.Vc;d.prototype.Zc=function(t,e){if(e!=null&&e.length)for(G(this,t,2),this.a.j(8*e.length),t=0;t<e.length;t++)this.a.K(e[t])};d.prototype.writePackedFixedHash64=d.prototype.Zc;d.prototype.td=function(t,e){if(e!=null&&e.length){t=xe(this,t);for(var r=0;r<e.length;r++)this.a.N(e[r]);Oe(this,t)}};d.prototype.writePackedVarintHash64=d.prototype.td;typeof Ze=="object"&&(Ze.debug=Gt,Ze.Map=Y,Ze.Message=D,Ze.BinaryReader=g,Ze.BinaryWriter=d,Ze.ExtensionFieldInfo=Bs,Ze.ExtensionFieldBinaryInfo=Gv,Ze.exportSymbol=Jk,Ze.inherits=Kk,Ze.object={extend:Xk},Ze.typeOf=kr)});var Rl=S(s0=>{var Ln=rf(),wl=Ln,nf=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof nf<"u"&&nf||typeof self<"u"&&self||function(){return this}.call(null)||Function("return this")();wl.exportSymbol("proto.google.protobuf.Empty",null,nf);proto.google.protobuf.Empty=function(t){Ln.Message.initialize(this,t,0,-1,null,null)};wl.inherits(proto.google.protobuf.Empty,Ln.Message);wl.DEBUG&&!COMPILED&&(proto.google.protobuf.Empty.displayName="proto.google.protobuf.Empty");Ln.Message.GENERATE_TO_OBJECT&&(proto.google.protobuf.Empty.prototype.toObject=function(t){return proto.google.protobuf.Empty.toObject(t,this)},proto.google.protobuf.Empty.toObject=function(t,e){var r,i={};return t&&(i.$jspbMessageInstance=e),i});proto.google.protobuf.Empty.deserializeBinary=function(t){var e=new Ln.BinaryReader(t),r=new proto.google.protobuf.Empty;return proto.google.protobuf.Empty.deserializeBinaryFromReader(r,e)};proto.google.protobuf.Empty.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){default:e.skipField();break}}return t};proto.google.protobuf.Empty.prototype.serializeBinary=function(){var t=new Ln.BinaryWriter;return proto.google.protobuf.Empty.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.google.protobuf.Empty.serializeBinaryToWriter=function(t,e){var r=void 0};wl.object.extend(s0,proto.google.protobuf)});var kl=S(o0=>{var O=rf(),we=O,Or=typeof globalThis<"u"&&globalThis||typeof window<"u"&&window||typeof Or<"u"&&Or||typeof self<"u"&&self||function(){return this}.call(null)||Function("return this")(),nx=Rl();we.object.extend(proto,nx);we.exportSymbol("proto.postgres.Cmd",null,Or);we.exportSymbol("proto.postgres.CreateRequest",null,Or);we.exportSymbol("proto.postgres.DeleteRequest",null,Or);we.exportSymbol("proto.postgres.GetRequest",null,Or);we.exportSymbol("proto.postgres.Postgres",null,Or);we.exportSymbol("proto.postgres.PostgresId",null,Or);we.exportSymbol("proto.postgres.PostgresList",null,Or);proto.postgres.CreateRequest=function(t){O.Message.initialize(this,t,0,-1,null,null)};we.inherits(proto.postgres.CreateRequest,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.CreateRequest.displayName="proto.postgres.CreateRequest");proto.postgres.Postgres=function(t){O.Message.initialize(this,t,0,-1,null,null)};we.inherits(proto.postgres.Postgres,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.Postgres.displayName="proto.postgres.Postgres");proto.postgres.Cmd=function(t){O.Message.initialize(this,t,0,-1,null,null)};we.inherits(proto.postgres.Cmd,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.Cmd.displayName="proto.postgres.Cmd");proto.postgres.PostgresList=function(t){O.Message.initialize(this,t,0,-1,proto.postgres.PostgresList.repeatedFields_,null)};we.inherits(proto.postgres.PostgresList,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.PostgresList.displayName="proto.postgres.PostgresList");proto.postgres.GetRequest=function(t){O.Message.initialize(this,t,0,-1,null,null)};we.inherits(proto.postgres.GetRequest,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.GetRequest.displayName="proto.postgres.GetRequest");proto.postgres.DeleteRequest=function(t){O.Message.initialize(this,t,0,-1,null,null)};we.inherits(proto.postgres.DeleteRequest,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.DeleteRequest.displayName="proto.postgres.DeleteRequest");proto.postgres.PostgresId=function(t){O.Message.initialize(this,t,0,-1,null,null)};we.inherits(proto.postgres.PostgresId,O.Message);we.DEBUG&&!COMPILED&&(proto.postgres.PostgresId.displayName="proto.postgres.PostgresId");O.Message.GENERATE_TO_OBJECT&&(proto.postgres.CreateRequest.prototype.toObject=function(t){return proto.postgres.CreateRequest.toObject(t,this)},proto.postgres.CreateRequest.toObject=function(t,e){var r,i={name:O.Message.getFieldWithDefault(e,1,"")};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.CreateRequest.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.CreateRequest;return proto.postgres.CreateRequest.deserializeBinaryFromReader(r,e)};proto.postgres.CreateRequest.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=e.readString();t.setName(i);break;default:e.skipField();break}}return t};proto.postgres.CreateRequest.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.CreateRequest.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.CreateRequest.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getName(),r.length>0&&e.writeString(1,r)};proto.postgres.CreateRequest.prototype.getName=function(){return O.Message.getFieldWithDefault(this,1,"")};proto.postgres.CreateRequest.prototype.setName=function(t){return O.Message.setProto3StringField(this,1,t)};O.Message.GENERATE_TO_OBJECT&&(proto.postgres.Postgres.prototype.toObject=function(t){return proto.postgres.Postgres.toObject(t,this)},proto.postgres.Postgres.toObject=function(t,e){var r,i={id:O.Message.getFieldWithDefault(e,1,""),name:O.Message.getFieldWithDefault(e,2,""),username:O.Message.getFieldWithDefault(e,3,""),password:O.Message.getFieldWithDefault(e,4,""),database:O.Message.getFieldWithDefault(e,5,""),host:O.Message.getFieldWithDefault(e,6,""),port:O.Message.getFieldWithDefault(e,10,0),status:O.Message.getFieldWithDefault(e,7,""),errorReason:O.Message.getFieldWithDefault(e,8,""),cmd:(r=e.getCmd())&&proto.postgres.Cmd.toObject(t,r)};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.Postgres.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.Postgres;return proto.postgres.Postgres.deserializeBinaryFromReader(r,e)};proto.postgres.Postgres.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=e.readString();t.setId(i);break;case 2:var i=e.readString();t.setName(i);break;case 3:var i=e.readString();t.setUsername(i);break;case 4:var i=e.readString();t.setPassword(i);break;case 5:var i=e.readString();t.setDatabase(i);break;case 6:var i=e.readString();t.setHost(i);break;case 10:var i=e.readUint32();t.setPort(i);break;case 7:var i=e.readString();t.setStatus(i);break;case 8:var i=e.readString();t.setErrorReason(i);break;case 9:var i=new proto.postgres.Cmd;e.readMessage(i,proto.postgres.Cmd.deserializeBinaryFromReader),t.setCmd(i);break;default:e.skipField();break}}return t};proto.postgres.Postgres.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.Postgres.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.Postgres.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getId(),r.length>0&&e.writeString(1,r),r=t.getName(),r.length>0&&e.writeString(2,r),r=t.getUsername(),r.length>0&&e.writeString(3,r),r=t.getPassword(),r.length>0&&e.writeString(4,r),r=t.getDatabase(),r.length>0&&e.writeString(5,r),r=t.getHost(),r.length>0&&e.writeString(6,r),r=t.getPort(),r!==0&&e.writeUint32(10,r),r=t.getStatus(),r.length>0&&e.writeString(7,r),r=t.getErrorReason(),r.length>0&&e.writeString(8,r),r=t.getCmd(),r!=null&&e.writeMessage(9,r,proto.postgres.Cmd.serializeBinaryToWriter)};proto.postgres.Postgres.prototype.getId=function(){return O.Message.getFieldWithDefault(this,1,"")};proto.postgres.Postgres.prototype.setId=function(t){return O.Message.setProto3StringField(this,1,t)};proto.postgres.Postgres.prototype.getName=function(){return O.Message.getFieldWithDefault(this,2,"")};proto.postgres.Postgres.prototype.setName=function(t){return O.Message.setProto3StringField(this,2,t)};proto.postgres.Postgres.prototype.getUsername=function(){return O.Message.getFieldWithDefault(this,3,"")};proto.postgres.Postgres.prototype.setUsername=function(t){return O.Message.setProto3StringField(this,3,t)};proto.postgres.Postgres.prototype.getPassword=function(){return O.Message.getFieldWithDefault(this,4,"")};proto.postgres.Postgres.prototype.setPassword=function(t){return O.Message.setProto3StringField(this,4,t)};proto.postgres.Postgres.prototype.getDatabase=function(){return O.Message.getFieldWithDefault(this,5,"")};proto.postgres.Postgres.prototype.setDatabase=function(t){return O.Message.setProto3StringField(this,5,t)};proto.postgres.Postgres.prototype.getHost=function(){return O.Message.getFieldWithDefault(this,6,"")};proto.postgres.Postgres.prototype.setHost=function(t){return O.Message.setProto3StringField(this,6,t)};proto.postgres.Postgres.prototype.getPort=function(){return O.Message.getFieldWithDefault(this,10,0)};proto.postgres.Postgres.prototype.setPort=function(t){return O.Message.setProto3IntField(this,10,t)};proto.postgres.Postgres.prototype.getStatus=function(){return O.Message.getFieldWithDefault(this,7,"")};proto.postgres.Postgres.prototype.setStatus=function(t){return O.Message.setProto3StringField(this,7,t)};proto.postgres.Postgres.prototype.getErrorReason=function(){return O.Message.getFieldWithDefault(this,8,"")};proto.postgres.Postgres.prototype.setErrorReason=function(t){return O.Message.setProto3StringField(this,8,t)};proto.postgres.Postgres.prototype.getCmd=function(){return O.Message.getWrapperField(this,proto.postgres.Cmd,9)};proto.postgres.Postgres.prototype.setCmd=function(t){return O.Message.setWrapperField(this,9,t)};proto.postgres.Postgres.prototype.clearCmd=function(){return this.setCmd(void 0)};proto.postgres.Postgres.prototype.hasCmd=function(){return O.Message.getField(this,9)!=null};O.Message.GENERATE_TO_OBJECT&&(proto.postgres.Cmd.prototype.toObject=function(t){return proto.postgres.Cmd.toObject(t,this)},proto.postgres.Cmd.toObject=function(t,e){var r,i={cli:O.Message.getFieldWithDefault(e,1,""),go:O.Message.getFieldWithDefault(e,2,""),java:O.Message.getFieldWithDefault(e,3,"")};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.Cmd.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.Cmd;return proto.postgres.Cmd.deserializeBinaryFromReader(r,e)};proto.postgres.Cmd.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=e.readString();t.setCli(i);break;case 2:var i=e.readString();t.setGo(i);break;case 3:var i=e.readString();t.setJava(i);break;default:e.skipField();break}}return t};proto.postgres.Cmd.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.Cmd.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.Cmd.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getCli(),r.length>0&&e.writeString(1,r),r=t.getGo(),r.length>0&&e.writeString(2,r),r=t.getJava(),r.length>0&&e.writeString(3,r)};proto.postgres.Cmd.prototype.getCli=function(){return O.Message.getFieldWithDefault(this,1,"")};proto.postgres.Cmd.prototype.setCli=function(t){return O.Message.setProto3StringField(this,1,t)};proto.postgres.Cmd.prototype.getGo=function(){return O.Message.getFieldWithDefault(this,2,"")};proto.postgres.Cmd.prototype.setGo=function(t){return O.Message.setProto3StringField(this,2,t)};proto.postgres.Cmd.prototype.getJava=function(){return O.Message.getFieldWithDefault(this,3,"")};proto.postgres.Cmd.prototype.setJava=function(t){return O.Message.setProto3StringField(this,3,t)};proto.postgres.PostgresList.repeatedFields_=[1];O.Message.GENERATE_TO_OBJECT&&(proto.postgres.PostgresList.prototype.toObject=function(t){return proto.postgres.PostgresList.toObject(t,this)},proto.postgres.PostgresList.toObject=function(t,e){var r,i={itemsList:O.Message.toObjectList(e.getItemsList(),proto.postgres.Postgres.toObject,t)};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.PostgresList.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.PostgresList;return proto.postgres.PostgresList.deserializeBinaryFromReader(r,e)};proto.postgres.PostgresList.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=new proto.postgres.Postgres;e.readMessage(i,proto.postgres.Postgres.deserializeBinaryFromReader),t.addItems(i);break;default:e.skipField();break}}return t};proto.postgres.PostgresList.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.PostgresList.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.PostgresList.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getItemsList(),r.length>0&&e.writeRepeatedMessage(1,r,proto.postgres.Postgres.serializeBinaryToWriter)};proto.postgres.PostgresList.prototype.getItemsList=function(){return O.Message.getRepeatedWrapperField(this,proto.postgres.Postgres,1)};proto.postgres.PostgresList.prototype.setItemsList=function(t){return O.Message.setRepeatedWrapperField(this,1,t)};proto.postgres.PostgresList.prototype.addItems=function(t,e){return O.Message.addToRepeatedWrapperField(this,1,t,proto.postgres.Postgres,e)};proto.postgres.PostgresList.prototype.clearItemsList=function(){return this.setItemsList([])};O.Message.GENERATE_TO_OBJECT&&(proto.postgres.GetRequest.prototype.toObject=function(t){return proto.postgres.GetRequest.toObject(t,this)},proto.postgres.GetRequest.toObject=function(t,e){var r,i={id:O.Message.getFieldWithDefault(e,1,"")};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.GetRequest.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.GetRequest;return proto.postgres.GetRequest.deserializeBinaryFromReader(r,e)};proto.postgres.GetRequest.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=e.readString();t.setId(i);break;default:e.skipField();break}}return t};proto.postgres.GetRequest.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.GetRequest.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.GetRequest.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getId(),r.length>0&&e.writeString(1,r)};proto.postgres.GetRequest.prototype.getId=function(){return O.Message.getFieldWithDefault(this,1,"")};proto.postgres.GetRequest.prototype.setId=function(t){return O.Message.setProto3StringField(this,1,t)};O.Message.GENERATE_TO_OBJECT&&(proto.postgres.DeleteRequest.prototype.toObject=function(t){return proto.postgres.DeleteRequest.toObject(t,this)},proto.postgres.DeleteRequest.toObject=function(t,e){var r,i={id:O.Message.getFieldWithDefault(e,1,"")};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.DeleteRequest.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.DeleteRequest;return proto.postgres.DeleteRequest.deserializeBinaryFromReader(r,e)};proto.postgres.DeleteRequest.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=e.readString();t.setId(i);break;default:e.skipField();break}}return t};proto.postgres.DeleteRequest.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.DeleteRequest.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.DeleteRequest.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getId(),r.length>0&&e.writeString(1,r)};proto.postgres.DeleteRequest.prototype.getId=function(){return O.Message.getFieldWithDefault(this,1,"")};proto.postgres.DeleteRequest.prototype.setId=function(t){return O.Message.setProto3StringField(this,1,t)};O.Message.GENERATE_TO_OBJECT&&(proto.postgres.PostgresId.prototype.toObject=function(t){return proto.postgres.PostgresId.toObject(t,this)},proto.postgres.PostgresId.toObject=function(t,e){var r,i={id:O.Message.getFieldWithDefault(e,1,"")};return t&&(i.$jspbMessageInstance=e),i});proto.postgres.PostgresId.deserializeBinary=function(t){var e=new O.BinaryReader(t),r=new proto.postgres.PostgresId;return proto.postgres.PostgresId.deserializeBinaryFromReader(r,e)};proto.postgres.PostgresId.deserializeBinaryFromReader=function(t,e){for(;e.nextField()&&!e.isEndGroup();){var r=e.getFieldNumber();switch(r){case 1:var i=e.readString();t.setId(i);break;default:e.skipField();break}}return t};proto.postgres.PostgresId.prototype.serializeBinary=function(){var t=new O.BinaryWriter;return proto.postgres.PostgresId.serializeBinaryToWriter(this,t),t.getResultBuffer()};proto.postgres.PostgresId.serializeBinaryToWriter=function(t,e){var r=void 0;r=t.getId(),r.length>0&&e.writeString(1,r)};proto.postgres.PostgresId.prototype.getId=function(){return O.Message.getFieldWithDefault(this,1,"")};proto.postgres.PostgresId.prototype.setId=function(t){return O.Message.setProto3StringField(this,1,t)};we.object.extend(o0,proto.postgres)});var c0=S(sf=>{"use strict";var sx=$h(),Ve=kl(),xl=Rl();function a0(t){if(!(t instanceof xl.Empty))throw new Error("Expected argument of type google.protobuf.Empty");return Buffer.from(t.serializeBinary())}function l0(t){return xl.Empty.deserializeBinary(new Uint8Array(t))}function ox(t){if(!(t instanceof Ve.CreateRequest))throw new Error("Expected argument of type postgres.CreateRequest");return Buffer.from(t.serializeBinary())}function ax(t){return Ve.CreateRequest.deserializeBinary(new Uint8Array(t))}function lx(t){if(!(t instanceof Ve.DeleteRequest))throw new Error("Expected argument of type postgres.DeleteRequest");return Buffer.from(t.serializeBinary())}function cx(t){return Ve.DeleteRequest.deserializeBinary(new Uint8Array(t))}function ux(t){if(!(t instanceof Ve.GetRequest))throw new Error("Expected argument of type postgres.GetRequest");return Buffer.from(t.serializeBinary())}function dx(t){return Ve.GetRequest.deserializeBinary(new Uint8Array(t))}function hx(t){if(!(t instanceof Ve.Postgres))throw new Error("Expected argument of type postgres.Postgres");return Buffer.from(t.serializeBinary())}function fx(t){return Ve.Postgres.deserializeBinary(new Uint8Array(t))}function px(t){if(!(t instanceof Ve.PostgresId))throw new Error("Expected argument of type postgres.PostgresId");return Buffer.from(t.serializeBinary())}function gx(t){return Ve.PostgresId.deserializeBinary(new Uint8Array(t))}function mx(t){if(!(t instanceof Ve.PostgresList))throw new Error("Expected argument of type postgres.PostgresList");return Buffer.from(t.serializeBinary())}function yx(t){return Ve.PostgresList.deserializeBinary(new Uint8Array(t))}var vx=sf.PostgresServiceService={create:{path:"/postgres.PostgresService/Create",requestStream:!1,responseStream:!1,requestType:Ve.CreateRequest,responseType:Ve.PostgresId,requestSerialize:ox,requestDeserialize:ax,responseSerialize:px,responseDeserialize:gx},list:{path:"/postgres.PostgresService/List",requestStream:!1,responseStream:!1,requestType:xl.Empty,responseType:Ve.PostgresList,requestSerialize:a0,requestDeserialize:l0,responseSerialize:mx,responseDeserialize:yx},get:{path:"/postgres.PostgresService/Get",requestStream:!1,responseStream:!1,requestType:Ve.GetRequest,responseType:Ve.Postgres,requestSerialize:ux,requestDeserialize:dx,responseSerialize:hx,responseDeserialize:fx},delete:{path:"/postgres.PostgresService/Delete",requestStream:!1,responseStream:!1,requestType:Ve.DeleteRequest,responseType:xl.Empty,requestSerialize:lx,requestDeserialize:cx,responseSerialize:a0,responseDeserialize:l0}};sf.PostgresServiceClient=sx.makeGenericClientConstructor(vx,"PostgresService")});var h0=S(vt=>{"use strict";var d0=vt&&vt.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),_x=vt&&vt.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Sx=vt&&vt.__importStar||function(){var t=function(e){return t=Object.getOwnPropertyNames||function(r){var i=[];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(i[i.length]=n);return i},t(e)};return function(e){if(e&&e.__esModule)return e;var r={};if(e!=null)for(var i=t(e),n=0;n<i.length;n++)i[n]!=="default"&&d0(r,e,i[n]);return _x(r,e),r}}(),Cx=vt&&vt.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&d0(e,t,r)};Object.defineProperty(vt,"__esModule",{value:!0});vt.RapidappClient=void 0;var u0=Sx($h()),of=kl(),bx=c0(),Ex=Rl(),af=class{constructor(e){let r=e.host||"api.rapidapp.io",i=e.port||443,n=`${r}:${i}`,s=u0.credentials.createSsl();this.client=new bx.PostgresServiceClient(n,s),this.apiKey=e.apiKey}getMetadata(){let e=new u0.Metadata;return e.add("x-api-key",this.apiKey),e}async createPostgres(e){return new Promise((r,i)=>{let n=new of.CreateRequest;n.setName(e),this.client.create(n,this.getMetadata(),(s,o)=>{if(s){i(s);return}r(o)})})}async getPostgres(e){return new Promise((r,i)=>{let n=new of.GetRequest;n.setId(e),this.client.get(n,this.getMetadata(),(s,o)=>{if(s){i(s);return}r(o)})})}async listPostgres(){return new Promise((e,r)=>{this.client.list(new Ex.Empty,this.getMetadata(),(i,n)=>{if(i){r(i);return}e(n)})})}async deletePostgres(e){return new Promise((r,i)=>{let n=new of.DeleteRequest;n.setId(e),this.client.delete(n,this.getMetadata(),s=>{if(s){i(s);return}r()})})}};vt.RapidappClient=af;Cx(kl(),vt)});var ae;(function(t){t.assertEqual=n=>n;function e(n){}t.assertIs=e;function r(n){throw new Error}t.assertNever=r,t.arrayToEnum=n=>{let s={};for(let o of n)s[o]=o;return s},t.getValidEnumValues=n=>{let s=t.objectKeys(n).filter(a=>typeof n[n[a]]!="number"),o={};for(let a of s)o[a]=n[a];return t.objectValues(o)},t.objectValues=n=>t.objectKeys(n).map(function(s){return n[s]}),t.objectKeys=typeof Object.keys=="function"?n=>Object.keys(n):n=>{let s=[];for(let o in n)Object.prototype.hasOwnProperty.call(n,o)&&s.push(o);return s},t.find=(n,s)=>{for(let o of n)if(s(o))return o},t.isInteger=typeof Number.isInteger=="function"?n=>Number.isInteger(n):n=>typeof n=="number"&&isFinite(n)&&Math.floor(n)===n;function i(n,s=" | "){return n.map(o=>typeof o=="string"?`'${o}'`:o).join(s)}t.joinValues=i,t.jsonStringifyReplacer=(n,s)=>typeof s=="bigint"?s.toString():s})(ae||(ae={}));var Pl;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(Pl||(Pl={}));var q=ae.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),gr=t=>{switch(typeof t){case"undefined":return q.undefined;case"string":return q.string;case"number":return isNaN(t)?q.nan:q.number;case"boolean":return q.boolean;case"function":return q.function;case"bigint":return q.bigint;case"symbol":return q.symbol;case"object":return Array.isArray(t)?q.array:t===null?q.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?q.promise:typeof Map<"u"&&t instanceof Map?q.map:typeof Set<"u"&&t instanceof Set?q.set:typeof Date<"u"&&t instanceof Date?q.date:q.object;default:return q.unknown}},x=ae.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),S0=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),dt=class t extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};let r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){let r=e||function(s){return s.message},i={_errors:[]},n=s=>{for(let o of s.issues)if(o.code==="invalid_union")o.unionErrors.map(n);else if(o.code==="invalid_return_type")n(o.returnTypeError);else if(o.code==="invalid_arguments")n(o.argumentsError);else if(o.path.length===0)i._errors.push(r(o));else{let a=i,l=0;for(;l<o.path.length;){let c=o.path[l];l===o.path.length-1?(a[c]=a[c]||{_errors:[]},a[c]._errors.push(r(o))):a[c]=a[c]||{_errors:[]},a=a[c],l++}}};return n(this),i}static assert(e){if(!(e instanceof t))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ae.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){let r={},i=[];for(let n of this.issues)n.path.length>0?(r[n.path[0]]=r[n.path[0]]||[],r[n.path[0]].push(e(n))):i.push(e(n));return{formErrors:i,fieldErrors:r}}get formErrors(){return this.flatten()}};dt.create=t=>new dt(t);var $i=(t,e)=>{let r;switch(t.code){case x.invalid_type:t.received===q.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case x.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,ae.jsonStringifyReplacer)}`;break;case x.unrecognized_keys:r=`Unrecognized key(s) in object: ${ae.joinValues(t.keys,", ")}`;break;case x.invalid_union:r="Invalid input";break;case x.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${ae.joinValues(t.options)}`;break;case x.invalid_enum_value:r=`Invalid enum value. Expected ${ae.joinValues(t.options)}, received '${t.received}'`;break;case x.invalid_arguments:r="Invalid function arguments";break;case x.invalid_return_type:r="Invalid function return type";break;case x.invalid_date:r="Invalid date";break;case x.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:ae.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case x.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case x.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case x.custom:r="Invalid input";break;case x.invalid_intersection_types:r="Intersection results could not be merged";break;case x.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case x.not_finite:r="Number must be finite";break;default:r=e.defaultError,ae.assertNever(t)}return{message:r}},mf=$i;function C0(t){mf=t}function Js(){return mf}var Ks=t=>{let{data:e,path:r,errorMaps:i,issueData:n}=t,s=[...r,...n.path||[]],o={...n,path:s};if(n.message!==void 0)return{...n,path:s,message:n.message};let a="",l=i.filter(c=>!!c).slice().reverse();for(let c of l)a=c(o,{data:e,defaultError:a}).message;return{...n,path:s,message:a}},b0=[];function L(t,e){let r=Js(),i=Ks({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===$i?void 0:$i].filter(n=>!!n)});t.common.issues.push(i)}var Je=class t{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){let i=[];for(let n of r){if(n.status==="aborted")return K;n.status==="dirty"&&e.dirty(),i.push(n.value)}return{status:e.value,value:i}}static async mergeObjectAsync(e,r){let i=[];for(let n of r){let s=await n.key,o=await n.value;i.push({key:s,value:o})}return t.mergeObjectSync(e,i)}static mergeObjectSync(e,r){let i={};for(let n of r){let{key:s,value:o}=n;if(s.status==="aborted"||o.status==="aborted")return K;s.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),s.value!=="__proto__"&&(typeof o.value<"u"||n.alwaysSet)&&(i[s.value]=o.value)}return{status:e.value,value:i}}},K=Object.freeze({status:"aborted"}),Wi=t=>({status:"dirty",value:t}),tt=t=>({status:"valid",value:t}),Ml=t=>t.status==="aborted",Il=t=>t.status==="dirty",ti=t=>t.status==="valid",Bn=t=>typeof Promise<"u"&&t instanceof Promise;function Xs(t,e,r,i){if(r==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?i:r==="a"?i.call(t):i?i.value:e.get(t)}function yf(t,e,r,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,r):n?n.value=r:e.set(t,r),r}var H;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(H||(H={}));var Fn,qn,St=class{constructor(e,r,i,n){this._cachedPath=[],this.parent=e,this.data=r,this._path=i,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},ff=(t,e)=>{if(ti(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let r=new dt(t.common.issues);return this._error=r,this._error}}};function Q(t){if(!t)return{};let{errorMap:e,invalid_type_error:r,required_error:i,description:n}=t;if(e&&(r||i))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:n}:{errorMap:(o,a)=>{var l,c;let{message:u}=t;return o.code==="invalid_enum_value"?{message:u??a.defaultError}:typeof a.data>"u"?{message:(l=u??i)!==null&&l!==void 0?l:a.defaultError}:o.code!=="invalid_type"?{message:a.defaultError}:{message:(c=u??r)!==null&&c!==void 0?c:a.defaultError}},description:n}}var ee=class{get description(){return this._def.description}_getType(e){return gr(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:gr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Je,ctx:{common:e.parent.common,data:e.data,parsedType:gr(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let r=this._parse(e);if(Bn(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){let r=this._parse(e);return Promise.resolve(r)}parse(e,r){let i=this.safeParse(e,r);if(i.success)return i.data;throw i.error}safeParse(e,r){var i;let n={common:{issues:[],async:(i=r?.async)!==null&&i!==void 0?i:!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:gr(e)},s=this._parseSync({data:e,path:n.path,parent:n});return ff(n,s)}"~validate"(e){var r,i;let n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:gr(e)};if(!this["~standard"].async)try{let s=this._parseSync({data:e,path:[],parent:n});return ti(s)?{value:s.value}:{issues:n.common.issues}}catch(s){!((i=(r=s?.message)===null||r===void 0?void 0:r.toLowerCase())===null||i===void 0)&&i.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:n}).then(s=>ti(s)?{value:s.value}:{issues:n.common.issues})}async parseAsync(e,r){let i=await this.safeParseAsync(e,r);if(i.success)return i.data;throw i.error}async safeParseAsync(e,r){let i={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:gr(e)},n=this._parse({data:e,path:i.path,parent:i}),s=await(Bn(n)?n:Promise.resolve(n));return ff(i,s)}refine(e,r){let i=n=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(n):r;return this._refinement((n,s)=>{let o=e(n),a=()=>s.addIssue({code:x.custom,...i(n)});return typeof Promise<"u"&&o instanceof Promise?o.then(l=>l?!0:(a(),!1)):o?!0:(a(),!1)})}refinement(e,r){return this._refinement((i,n)=>e(i)?!0:(n.addIssue(typeof r=="function"?r(i,n):r),!1))}_refinement(e){return new ht({schema:this,typeName:Z.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return _t.create(this,this._def)}nullable(){return Jt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return yr.create(this)}promise(){return Ir.create(this,this._def)}or(e){return li.create([this,e],this._def)}and(e){return ci.create(this,e,this._def)}transform(e){return new ht({...Q(this._def),schema:this,typeName:Z.ZodEffects,effect:{type:"transform",transform:e}})}default(e){let r=typeof e=="function"?e:()=>e;return new pi({...Q(this._def),innerType:this,defaultValue:r,typeName:Z.ZodDefault})}brand(){return new jn({typeName:Z.ZodBranded,type:this,...Q(this._def)})}catch(e){let r=typeof e=="function"?e:()=>e;return new gi({...Q(this._def),innerType:this,catchValue:r,typeName:Z.ZodCatch})}describe(e){let r=this.constructor;return new r({...this._def,description:e})}pipe(e){return Un.create(this,e)}readonly(){return mi.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},E0=/^c[^\s-]{8,}$/i,T0=/^[0-9a-z]+$/,w0=/^[0-9A-HJKMNP-TV-Z]{26}$/i,R0=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,k0=/^[a-z0-9_-]{21}$/i,x0=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,O0=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,A0=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,P0="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$",Al,M0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,I0=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,N0=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,D0=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,L0=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,F0=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,vf="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",q0=new RegExp(`^${vf}$`);function _f(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function B0(t){return new RegExp(`^${_f(t)}$`)}function Sf(t){let e=`${vf}T${_f(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function j0(t,e){return!!((e==="v4"||!e)&&M0.test(t)||(e==="v6"||!e)&&N0.test(t))}function U0(t,e){if(!x0.test(t))return!1;try{let[r]=t.split("."),i=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),n=JSON.parse(atob(i));return!(typeof n!="object"||n===null||!n.typ||!n.alg||e&&n.alg!==e)}catch{return!1}}function z0(t,e){return!!((e==="v4"||!e)&&I0.test(t)||(e==="v6"||!e)&&D0.test(t))}var Pr=class t extends ee{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==q.string){let s=this._getOrReturnCtx(e);return L(s,{code:x.invalid_type,expected:q.string,received:s.parsedType}),K}let i=new Je,n;for(let s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(n=this._getOrReturnCtx(e,n),L(n,{code:x.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="max")e.data.length>s.value&&(n=this._getOrReturnCtx(e,n),L(n,{code:x.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),i.dirty());else if(s.kind==="length"){let o=e.data.length>s.value,a=e.data.length<s.value;(o||a)&&(n=this._getOrReturnCtx(e,n),o?L(n,{code:x.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):a&&L(n,{code:x.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),i.dirty())}else if(s.kind==="email")A0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"email",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="emoji")Al||(Al=new RegExp(P0,"u")),Al.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"emoji",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="uuid")R0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"uuid",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="nanoid")k0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"nanoid",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid")E0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"cuid",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="cuid2")T0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"cuid2",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="ulid")w0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"ulid",code:x.invalid_string,message:s.message}),i.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{n=this._getOrReturnCtx(e,n),L(n,{validation:"url",code:x.invalid_string,message:s.message}),i.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"regex",code:x.invalid_string,message:s.message}),i.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(n=this._getOrReturnCtx(e,n),L(n,{code:x.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),i.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(n=this._getOrReturnCtx(e,n),L(n,{code:x.invalid_string,validation:{startsWith:s.value},message:s.message}),i.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(n=this._getOrReturnCtx(e,n),L(n,{code:x.invalid_string,validation:{endsWith:s.value},message:s.message}),i.dirty()):s.kind==="datetime"?Sf(s).test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{code:x.invalid_string,validation:"datetime",message:s.message}),i.dirty()):s.kind==="date"?q0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{code:x.invalid_string,validation:"date",message:s.message}),i.dirty()):s.kind==="time"?B0(s).test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{code:x.invalid_string,validation:"time",message:s.message}),i.dirty()):s.kind==="duration"?O0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"duration",code:x.invalid_string,message:s.message}),i.dirty()):s.kind==="ip"?j0(e.data,s.version)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"ip",code:x.invalid_string,message:s.message}),i.dirty()):s.kind==="jwt"?U0(e.data,s.alg)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"jwt",code:x.invalid_string,message:s.message}),i.dirty()):s.kind==="cidr"?z0(e.data,s.version)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"cidr",code:x.invalid_string,message:s.message}),i.dirty()):s.kind==="base64"?L0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"base64",code:x.invalid_string,message:s.message}),i.dirty()):s.kind==="base64url"?F0.test(e.data)||(n=this._getOrReturnCtx(e,n),L(n,{validation:"base64url",code:x.invalid_string,message:s.message}),i.dirty()):ae.assertNever(s);return{status:i.value,value:e.data}}_regex(e,r,i){return this.refinement(n=>e.test(n),{validation:r,code:x.invalid_string,...H.errToObj(i)})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...H.errToObj(e)})}url(e){return this._addCheck({kind:"url",...H.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...H.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...H.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...H.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...H.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...H.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...H.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...H.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...H.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...H.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...H.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...H.errToObj(e)})}datetime(e){var r,i;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(r=e?.offset)!==null&&r!==void 0?r:!1,local:(i=e?.local)!==null&&i!==void 0?i:!1,...H.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...H.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...H.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...H.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...H.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...H.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...H.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...H.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...H.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...H.errToObj(r)})}nonempty(e){return this.min(1,H.errToObj(e))}trim(){return new t({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new t({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};Pr.create=t=>{var e;return new Pr({checks:[],typeName:Z.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};function H0(t,e){let r=(t.toString().split(".")[1]||"").length,i=(e.toString().split(".")[1]||"").length,n=r>i?r:i,s=parseInt(t.toFixed(n).replace(".","")),o=parseInt(e.toFixed(n).replace(".",""));return s%o/Math.pow(10,n)}var ri=class t extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==q.number){let s=this._getOrReturnCtx(e);return L(s,{code:x.invalid_type,expected:q.number,received:s.parsedType}),K}let i,n=new Je;for(let s of this._def.checks)s.kind==="int"?ae.isInteger(e.data)||(i=this._getOrReturnCtx(e,i),L(i,{code:x.invalid_type,expected:"integer",received:"float",message:s.message}),n.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),L(i,{code:x.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),L(i,{code:x.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),n.dirty()):s.kind==="multipleOf"?H0(e.data,s.value)!==0&&(i=this._getOrReturnCtx(e,i),L(i,{code:x.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(i=this._getOrReturnCtx(e,i),L(i,{code:x.not_finite,message:s.message}),n.dirty()):ae.assertNever(s);return{status:n.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,H.toString(r))}gt(e,r){return this.setLimit("min",e,!1,H.toString(r))}lte(e,r){return this.setLimit("max",e,!0,H.toString(r))}lt(e,r){return this.setLimit("max",e,!1,H.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:H.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:H.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:H.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(e)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ae.isInteger(e.value))}get isFinite(){let e=null,r=null;for(let i of this._def.checks){if(i.kind==="finite"||i.kind==="int"||i.kind==="multipleOf")return!0;i.kind==="min"?(r===null||i.value>r)&&(r=i.value):i.kind==="max"&&(e===null||i.value<e)&&(e=i.value)}return Number.isFinite(r)&&Number.isFinite(e)}};ri.create=t=>new ri({checks:[],typeName:Z.ZodNumber,coerce:t?.coerce||!1,...Q(t)});var ii=class t extends ee{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==q.bigint)return this._getInvalidInput(e);let i,n=new Je;for(let s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(i=this._getOrReturnCtx(e,i),L(i,{code:x.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(i=this._getOrReturnCtx(e,i),L(i,{code:x.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),n.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(i=this._getOrReturnCtx(e,i),L(i,{code:x.not_multiple_of,multipleOf:s.value,message:s.message}),n.dirty()):ae.assertNever(s);return{status:n.value,value:e.data}}_getInvalidInput(e){let r=this._getOrReturnCtx(e);return L(r,{code:x.invalid_type,expected:q.bigint,received:r.parsedType}),K}gte(e,r){return this.setLimit("min",e,!0,H.toString(r))}gt(e,r){return this.setLimit("min",e,!1,H.toString(r))}lte(e,r){return this.setLimit("max",e,!0,H.toString(r))}lt(e,r){return this.setLimit("max",e,!1,H.toString(r))}setLimit(e,r,i,n){return new t({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:i,message:H.toString(n)}]})}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(r)})}get minValue(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}};ii.create=t=>{var e;return new ii({checks:[],typeName:Z.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...Q(t)})};var ni=class extends ee{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==q.boolean){let i=this._getOrReturnCtx(e);return L(i,{code:x.invalid_type,expected:q.boolean,received:i.parsedType}),K}return tt(e.data)}};ni.create=t=>new ni({typeName:Z.ZodBoolean,coerce:t?.coerce||!1,...Q(t)});var si=class t extends ee{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==q.date){let s=this._getOrReturnCtx(e);return L(s,{code:x.invalid_type,expected:q.date,received:s.parsedType}),K}if(isNaN(e.data.getTime())){let s=this._getOrReturnCtx(e);return L(s,{code:x.invalid_date}),K}let i=new Je,n;for(let s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(n=this._getOrReturnCtx(e,n),L(n,{code:x.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),i.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(n=this._getOrReturnCtx(e,n),L(n,{code:x.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),i.dirty()):ae.assertNever(s);return{status:i.value,value:new Date(e.data.getTime())}}_addCheck(e){return new t({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:H.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:H.toString(r)})}get minDate(){let e=null;for(let r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(let r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}};si.create=t=>new si({checks:[],coerce:t?.coerce||!1,typeName:Z.ZodDate,...Q(t)});var Vi=class extends ee{_parse(e){if(this._getType(e)!==q.symbol){let i=this._getOrReturnCtx(e);return L(i,{code:x.invalid_type,expected:q.symbol,received:i.parsedType}),K}return tt(e.data)}};Vi.create=t=>new Vi({typeName:Z.ZodSymbol,...Q(t)});var oi=class extends ee{_parse(e){if(this._getType(e)!==q.undefined){let i=this._getOrReturnCtx(e);return L(i,{code:x.invalid_type,expected:q.undefined,received:i.parsedType}),K}return tt(e.data)}};oi.create=t=>new oi({typeName:Z.ZodUndefined,...Q(t)});var ai=class extends ee{_parse(e){if(this._getType(e)!==q.null){let i=this._getOrReturnCtx(e);return L(i,{code:x.invalid_type,expected:q.null,received:i.parsedType}),K}return tt(e.data)}};ai.create=t=>new ai({typeName:Z.ZodNull,...Q(t)});var Mr=class extends ee{constructor(){super(...arguments),this._any=!0}_parse(e){return tt(e.data)}};Mr.create=t=>new Mr({typeName:Z.ZodAny,...Q(t)});var mr=class extends ee{constructor(){super(...arguments),this._unknown=!0}_parse(e){return tt(e.data)}};mr.create=t=>new mr({typeName:Z.ZodUnknown,...Q(t)});var Pt=class extends ee{_parse(e){let r=this._getOrReturnCtx(e);return L(r,{code:x.invalid_type,expected:q.never,received:r.parsedType}),K}};Pt.create=t=>new Pt({typeName:Z.ZodNever,...Q(t)});var Gi=class extends ee{_parse(e){if(this._getType(e)!==q.undefined){let i=this._getOrReturnCtx(e);return L(i,{code:x.invalid_type,expected:q.void,received:i.parsedType}),K}return tt(e.data)}};Gi.create=t=>new Gi({typeName:Z.ZodVoid,...Q(t)});var yr=class t extends ee{_parse(e){let{ctx:r,status:i}=this._processInputParams(e),n=this._def;if(r.parsedType!==q.array)return L(r,{code:x.invalid_type,expected:q.array,received:r.parsedType}),K;if(n.exactLength!==null){let o=r.data.length>n.exactLength.value,a=r.data.length<n.exactLength.value;(o||a)&&(L(r,{code:o?x.too_big:x.too_small,minimum:a?n.exactLength.value:void 0,maximum:o?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),i.dirty())}if(n.minLength!==null&&r.data.length<n.minLength.value&&(L(r,{code:x.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),i.dirty()),n.maxLength!==null&&r.data.length>n.maxLength.value&&(L(r,{code:x.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),i.dirty()),r.common.async)return Promise.all([...r.data].map((o,a)=>n.type._parseAsync(new St(r,o,r.path,a)))).then(o=>Je.mergeArray(i,o));let s=[...r.data].map((o,a)=>n.type._parseSync(new St(r,o,r.path,a)));return Je.mergeArray(i,s)}get element(){return this._def.type}min(e,r){return new t({...this._def,minLength:{value:e,message:H.toString(r)}})}max(e,r){return new t({...this._def,maxLength:{value:e,message:H.toString(r)}})}length(e,r){return new t({...this._def,exactLength:{value:e,message:H.toString(r)}})}nonempty(e){return this.min(1,e)}};yr.create=(t,e)=>new yr({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Z.ZodArray,...Q(e)});function Hi(t){if(t instanceof nt){let e={};for(let r in t.shape){let i=t.shape[r];e[r]=_t.create(Hi(i))}return new nt({...t._def,shape:()=>e})}else return t instanceof yr?new yr({...t._def,type:Hi(t.element)}):t instanceof _t?_t.create(Hi(t.unwrap())):t instanceof Jt?Jt.create(Hi(t.unwrap())):t instanceof Yt?Yt.create(t.items.map(e=>Hi(e))):t}var nt=class t extends ee{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;let e=this._def.shape(),r=ae.objectKeys(e);return this._cached={shape:e,keys:r}}_parse(e){if(this._getType(e)!==q.object){let c=this._getOrReturnCtx(e);return L(c,{code:x.invalid_type,expected:q.object,received:c.parsedType}),K}let{status:i,ctx:n}=this._processInputParams(e),{shape:s,keys:o}=this._getCached(),a=[];if(!(this._def.catchall instanceof Pt&&this._def.unknownKeys==="strip"))for(let c in n.data)o.includes(c)||a.push(c);let l=[];for(let c of o){let u=s[c],f=n.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new St(n,f,n.path,c)),alwaysSet:c in n.data})}if(this._def.catchall instanceof Pt){let c=this._def.unknownKeys;if(c==="passthrough")for(let u of a)l.push({key:{status:"valid",value:u},value:{status:"valid",value:n.data[u]}});else if(c==="strict")a.length>0&&(L(n,{code:x.unrecognized_keys,keys:a}),i.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{let c=this._def.catchall;for(let u of a){let f=n.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new St(n,f,n.path,u)),alwaysSet:u in n.data})}}return n.common.async?Promise.resolve().then(async()=>{let c=[];for(let u of l){let f=await u.key,m=await u.value;c.push({key:f,value:m,alwaysSet:u.alwaysSet})}return c}).then(c=>Je.mergeObjectSync(i,c)):Je.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(e){return H.errToObj,new t({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,i)=>{var n,s,o,a;let l=(o=(s=(n=this._def).errorMap)===null||s===void 0?void 0:s.call(n,r,i).message)!==null&&o!==void 0?o:i.defaultError;return r.code==="unrecognized_keys"?{message:(a=H.errToObj(e).message)!==null&&a!==void 0?a:l}:{message:l}}}:{}})}strip(){return new t({...this._def,unknownKeys:"strip"})}passthrough(){return new t({...this._def,unknownKeys:"passthrough"})}extend(e){return new t({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new t({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Z.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new t({...this._def,catchall:e})}pick(e){let r={};return ae.objectKeys(e).forEach(i=>{e[i]&&this.shape[i]&&(r[i]=this.shape[i])}),new t({...this._def,shape:()=>r})}omit(e){let r={};return ae.objectKeys(this.shape).forEach(i=>{e[i]||(r[i]=this.shape[i])}),new t({...this._def,shape:()=>r})}deepPartial(){return Hi(this)}partial(e){let r={};return ae.objectKeys(this.shape).forEach(i=>{let n=this.shape[i];e&&!e[i]?r[i]=n:r[i]=n.optional()}),new t({...this._def,shape:()=>r})}required(e){let r={};return ae.objectKeys(this.shape).forEach(i=>{if(e&&!e[i])r[i]=this.shape[i];else{let s=this.shape[i];for(;s instanceof _t;)s=s._def.innerType;r[i]=s}}),new t({...this._def,shape:()=>r})}keyof(){return Cf(ae.objectKeys(this.shape))}};nt.create=(t,e)=>new nt({shape:()=>t,unknownKeys:"strip",catchall:Pt.create(),typeName:Z.ZodObject,...Q(e)});nt.strictCreate=(t,e)=>new nt({shape:()=>t,unknownKeys:"strict",catchall:Pt.create(),typeName:Z.ZodObject,...Q(e)});nt.lazycreate=(t,e)=>new nt({shape:t,unknownKeys:"strip",catchall:Pt.create(),typeName:Z.ZodObject,...Q(e)});var li=class extends ee{_parse(e){let{ctx:r}=this._processInputParams(e),i=this._def.options;function n(s){for(let a of s)if(a.result.status==="valid")return a.result;for(let a of s)if(a.result.status==="dirty")return r.common.issues.push(...a.ctx.common.issues),a.result;let o=s.map(a=>new dt(a.ctx.common.issues));return L(r,{code:x.invalid_union,unionErrors:o}),K}if(r.common.async)return Promise.all(i.map(async s=>{let o={...r,common:{...r.common,issues:[]},parent:null};return{result:await s._parseAsync({data:r.data,path:r.path,parent:o}),ctx:o}})).then(n);{let s,o=[];for(let l of i){let c={...r,common:{...r.common,issues:[]},parent:null},u=l._parseSync({data:r.data,path:r.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!s&&(s={result:u,ctx:c}),c.common.issues.length&&o.push(c.common.issues)}if(s)return r.common.issues.push(...s.ctx.common.issues),s.result;let a=o.map(l=>new dt(l));return L(r,{code:x.invalid_union,unionErrors:a}),K}}get options(){return this._def.options}};li.create=(t,e)=>new li({options:t,typeName:Z.ZodUnion,...Q(e)});var pr=t=>t instanceof ui?pr(t.schema):t instanceof ht?pr(t.innerType()):t instanceof di?[t.value]:t instanceof hi?t.options:t instanceof fi?ae.objectValues(t.enum):t instanceof pi?pr(t._def.innerType):t instanceof oi?[void 0]:t instanceof ai?[null]:t instanceof _t?[void 0,...pr(t.unwrap())]:t instanceof Jt?[null,...pr(t.unwrap())]:t instanceof jn||t instanceof mi?pr(t.unwrap()):t instanceof gi?pr(t._def.innerType):[],Qs=class t extends ee{_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==q.object)return L(r,{code:x.invalid_type,expected:q.object,received:r.parsedType}),K;let i=this.discriminator,n=r.data[i],s=this.optionsMap.get(n);return s?r.common.async?s._parseAsync({data:r.data,path:r.path,parent:r}):s._parseSync({data:r.data,path:r.path,parent:r}):(L(r,{code:x.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[i]}),K)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,r,i){let n=new Map;for(let s of r){let o=pr(s.shape[e]);if(!o.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of o){if(n.has(a))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);n.set(a,s)}}return new t({typeName:Z.ZodDiscriminatedUnion,discriminator:e,options:r,optionsMap:n,...Q(i)})}};function Nl(t,e){let r=gr(t),i=gr(e);if(t===e)return{valid:!0,data:t};if(r===q.object&&i===q.object){let n=ae.objectKeys(e),s=ae.objectKeys(t).filter(a=>n.indexOf(a)!==-1),o={...t,...e};for(let a of s){let l=Nl(t[a],e[a]);if(!l.valid)return{valid:!1};o[a]=l.data}return{valid:!0,data:o}}else if(r===q.array&&i===q.array){if(t.length!==e.length)return{valid:!1};let n=[];for(let s=0;s<t.length;s++){let o=t[s],a=e[s],l=Nl(o,a);if(!l.valid)return{valid:!1};n.push(l.data)}return{valid:!0,data:n}}else return r===q.date&&i===q.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}var ci=class extends ee{_parse(e){let{status:r,ctx:i}=this._processInputParams(e),n=(s,o)=>{if(Ml(s)||Ml(o))return K;let a=Nl(s.value,o.value);return a.valid?((Il(s)||Il(o))&&r.dirty(),{status:r.value,value:a.data}):(L(i,{code:x.invalid_intersection_types}),K)};return i.common.async?Promise.all([this._def.left._parseAsync({data:i.data,path:i.path,parent:i}),this._def.right._parseAsync({data:i.data,path:i.path,parent:i})]).then(([s,o])=>n(s,o)):n(this._def.left._parseSync({data:i.data,path:i.path,parent:i}),this._def.right._parseSync({data:i.data,path:i.path,parent:i}))}};ci.create=(t,e,r)=>new ci({left:t,right:e,typeName:Z.ZodIntersection,...Q(r)});var Yt=class t extends ee{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==q.array)return L(i,{code:x.invalid_type,expected:q.array,received:i.parsedType}),K;if(i.data.length<this._def.items.length)return L(i,{code:x.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),K;!this._def.rest&&i.data.length>this._def.items.length&&(L(i,{code:x.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());let s=[...i.data].map((o,a)=>{let l=this._def.items[a]||this._def.rest;return l?l._parse(new St(i,o,i.path,a)):null}).filter(o=>!!o);return i.common.async?Promise.all(s).then(o=>Je.mergeArray(r,o)):Je.mergeArray(r,s)}get items(){return this._def.items}rest(e){return new t({...this._def,rest:e})}};Yt.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Yt({items:t,typeName:Z.ZodTuple,rest:null,...Q(e)})};var eo=class t extends ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==q.object)return L(i,{code:x.invalid_type,expected:q.object,received:i.parsedType}),K;let n=[],s=this._def.keyType,o=this._def.valueType;for(let a in i.data)n.push({key:s._parse(new St(i,a,i.path,a)),value:o._parse(new St(i,i.data[a],i.path,a)),alwaysSet:a in i.data});return i.common.async?Je.mergeObjectAsync(r,n):Je.mergeObjectSync(r,n)}get element(){return this._def.valueType}static create(e,r,i){return r instanceof ee?new t({keyType:e,valueType:r,typeName:Z.ZodRecord,...Q(i)}):new t({keyType:Pr.create(),valueType:e,typeName:Z.ZodRecord,...Q(r)})}},Zi=class extends ee{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==q.map)return L(i,{code:x.invalid_type,expected:q.map,received:i.parsedType}),K;let n=this._def.keyType,s=this._def.valueType,o=[...i.data.entries()].map(([a,l],c)=>({key:n._parse(new St(i,a,i.path,[c,"key"])),value:s._parse(new St(i,l,i.path,[c,"value"]))}));if(i.common.async){let a=new Map;return Promise.resolve().then(async()=>{for(let l of o){let c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return K;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(c.value,u.value)}return{status:r.value,value:a}})}else{let a=new Map;for(let l of o){let c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return K;(c.status==="dirty"||u.status==="dirty")&&r.dirty(),a.set(c.value,u.value)}return{status:r.value,value:a}}}};Zi.create=(t,e,r)=>new Zi({valueType:e,keyType:t,typeName:Z.ZodMap,...Q(r)});var Yi=class t extends ee{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.parsedType!==q.set)return L(i,{code:x.invalid_type,expected:q.set,received:i.parsedType}),K;let n=this._def;n.minSize!==null&&i.data.size<n.minSize.value&&(L(i,{code:x.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),r.dirty()),n.maxSize!==null&&i.data.size>n.maxSize.value&&(L(i,{code:x.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),r.dirty());let s=this._def.valueType;function o(l){let c=new Set;for(let u of l){if(u.status==="aborted")return K;u.status==="dirty"&&r.dirty(),c.add(u.value)}return{status:r.value,value:c}}let a=[...i.data.values()].map((l,c)=>s._parse(new St(i,l,i.path,c)));return i.common.async?Promise.all(a).then(l=>o(l)):o(a)}min(e,r){return new t({...this._def,minSize:{value:e,message:H.toString(r)}})}max(e,r){return new t({...this._def,maxSize:{value:e,message:H.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}};Yi.create=(t,e)=>new Yi({valueType:t,minSize:null,maxSize:null,typeName:Z.ZodSet,...Q(e)});var to=class t extends ee{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==q.function)return L(r,{code:x.invalid_type,expected:q.function,received:r.parsedType}),K;function i(a,l){return Ks({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Js(),$i].filter(c=>!!c),issueData:{code:x.invalid_arguments,argumentsError:l}})}function n(a,l){return Ks({data:a,path:r.path,errorMaps:[r.common.contextualErrorMap,r.schemaErrorMap,Js(),$i].filter(c=>!!c),issueData:{code:x.invalid_return_type,returnTypeError:l}})}let s={errorMap:r.common.contextualErrorMap},o=r.data;if(this._def.returns instanceof Ir){let a=this;return tt(async function(...l){let c=new dt([]),u=await a._def.args.parseAsync(l,s).catch(_=>{throw c.addIssue(i(l,_)),c}),f=await Reflect.apply(o,this,u);return await a._def.returns._def.type.parseAsync(f,s).catch(_=>{throw c.addIssue(n(f,_)),c})})}else{let a=this;return tt(function(...l){let c=a._def.args.safeParse(l,s);if(!c.success)throw new dt([i(l,c.error)]);let u=Reflect.apply(o,this,c.data),f=a._def.returns.safeParse(u,s);if(!f.success)throw new dt([n(u,f.error)]);return f.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t({...this._def,args:Yt.create(e).rest(mr.create())})}returns(e){return new t({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,r,i){return new t({args:e||Yt.create([]).rest(mr.create()),returns:r||mr.create(),typeName:Z.ZodFunction,...Q(i)})}},ui=class extends ee{get schema(){return this._def.getter()}_parse(e){let{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}};ui.create=(t,e)=>new ui({getter:t,typeName:Z.ZodLazy,...Q(e)});var di=class extends ee{_parse(e){if(e.data!==this._def.value){let r=this._getOrReturnCtx(e);return L(r,{received:r.data,code:x.invalid_literal,expected:this._def.value}),K}return{status:"valid",value:e.data}}get value(){return this._def.value}};di.create=(t,e)=>new di({value:t,typeName:Z.ZodLiteral,...Q(e)});function Cf(t,e){return new hi({values:t,typeName:Z.ZodEnum,...Q(e)})}var hi=class t extends ee{constructor(){super(...arguments),Fn.set(this,void 0)}_parse(e){if(typeof e.data!="string"){let r=this._getOrReturnCtx(e),i=this._def.values;return L(r,{expected:ae.joinValues(i),received:r.parsedType,code:x.invalid_type}),K}if(Xs(this,Fn,"f")||yf(this,Fn,new Set(this._def.values),"f"),!Xs(this,Fn,"f").has(e.data)){let r=this._getOrReturnCtx(e),i=this._def.values;return L(r,{received:r.data,code:x.invalid_enum_value,options:i}),K}return tt(e.data)}get options(){return this._def.values}get enum(){let e={};for(let r of this._def.values)e[r]=r;return e}get Values(){let e={};for(let r of this._def.values)e[r]=r;return e}get Enum(){let e={};for(let r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return t.create(e,{...this._def,...r})}exclude(e,r=this._def){return t.create(this.options.filter(i=>!e.includes(i)),{...this._def,...r})}};Fn=new WeakMap;hi.create=Cf;var fi=class extends ee{constructor(){super(...arguments),qn.set(this,void 0)}_parse(e){let r=ae.getValidEnumValues(this._def.values),i=this._getOrReturnCtx(e);if(i.parsedType!==q.string&&i.parsedType!==q.number){let n=ae.objectValues(r);return L(i,{expected:ae.joinValues(n),received:i.parsedType,code:x.invalid_type}),K}if(Xs(this,qn,"f")||yf(this,qn,new Set(ae.getValidEnumValues(this._def.values)),"f"),!Xs(this,qn,"f").has(e.data)){let n=ae.objectValues(r);return L(i,{received:i.data,code:x.invalid_enum_value,options:n}),K}return tt(e.data)}get enum(){return this._def.values}};qn=new WeakMap;fi.create=(t,e)=>new fi({values:t,typeName:Z.ZodNativeEnum,...Q(e)});var Ir=class extends ee{unwrap(){return this._def.type}_parse(e){let{ctx:r}=this._processInputParams(e);if(r.parsedType!==q.promise&&r.common.async===!1)return L(r,{code:x.invalid_type,expected:q.promise,received:r.parsedType}),K;let i=r.parsedType===q.promise?r.data:Promise.resolve(r.data);return tt(i.then(n=>this._def.type.parseAsync(n,{path:r.path,errorMap:r.common.contextualErrorMap})))}};Ir.create=(t,e)=>new Ir({type:t,typeName:Z.ZodPromise,...Q(e)});var ht=class extends ee{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Z.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:r,ctx:i}=this._processInputParams(e),n=this._def.effect||null,s={addIssue:o=>{L(i,o),o.fatal?r.abort():r.dirty()},get path(){return i.path}};if(s.addIssue=s.addIssue.bind(s),n.type==="preprocess"){let o=n.transform(i.data,s);if(i.common.async)return Promise.resolve(o).then(async a=>{if(r.value==="aborted")return K;let l=await this._def.schema._parseAsync({data:a,path:i.path,parent:i});return l.status==="aborted"?K:l.status==="dirty"||r.value==="dirty"?Wi(l.value):l});{if(r.value==="aborted")return K;let a=this._def.schema._parseSync({data:o,path:i.path,parent:i});return a.status==="aborted"?K:a.status==="dirty"||r.value==="dirty"?Wi(a.value):a}}if(n.type==="refinement"){let o=a=>{let l=n.refinement(a,s);if(i.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return a};if(i.common.async===!1){let a=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});return a.status==="aborted"?K:(a.status==="dirty"&&r.dirty(),o(a.value),{status:r.value,value:a.value})}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(a=>a.status==="aborted"?K:(a.status==="dirty"&&r.dirty(),o(a.value).then(()=>({status:r.value,value:a.value}))))}if(n.type==="transform")if(i.common.async===!1){let o=this._def.schema._parseSync({data:i.data,path:i.path,parent:i});if(!ti(o))return o;let a=n.transform(o.value,s);if(a instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:a}}else return this._def.schema._parseAsync({data:i.data,path:i.path,parent:i}).then(o=>ti(o)?Promise.resolve(n.transform(o.value,s)).then(a=>({status:r.value,value:a})):o);ae.assertNever(n)}};ht.create=(t,e,r)=>new ht({schema:t,typeName:Z.ZodEffects,effect:e,...Q(r)});ht.createWithPreprocess=(t,e,r)=>new ht({schema:e,effect:{type:"preprocess",transform:t},typeName:Z.ZodEffects,...Q(r)});var _t=class extends ee{_parse(e){return this._getType(e)===q.undefined?tt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};_t.create=(t,e)=>new _t({innerType:t,typeName:Z.ZodOptional,...Q(e)});var Jt=class extends ee{_parse(e){return this._getType(e)===q.null?tt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}};Jt.create=(t,e)=>new Jt({innerType:t,typeName:Z.ZodNullable,...Q(e)});var pi=class extends ee{_parse(e){let{ctx:r}=this._processInputParams(e),i=r.data;return r.parsedType===q.undefined&&(i=this._def.defaultValue()),this._def.innerType._parse({data:i,path:r.path,parent:r})}removeDefault(){return this._def.innerType}};pi.create=(t,e)=>new pi({innerType:t,typeName:Z.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Q(e)});var gi=class extends ee{_parse(e){let{ctx:r}=this._processInputParams(e),i={...r,common:{...r.common,issues:[]}},n=this._def.innerType._parse({data:i.data,path:i.path,parent:{...i}});return Bn(n)?n.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new dt(i.common.issues)},input:i.data})})):{status:"valid",value:n.status==="valid"?n.value:this._def.catchValue({get error(){return new dt(i.common.issues)},input:i.data})}}removeCatch(){return this._def.innerType}};gi.create=(t,e)=>new gi({innerType:t,typeName:Z.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Q(e)});var Ji=class extends ee{_parse(e){if(this._getType(e)!==q.nan){let i=this._getOrReturnCtx(e);return L(i,{code:x.invalid_type,expected:q.nan,received:i.parsedType}),K}return{status:"valid",value:e.data}}};Ji.create=t=>new Ji({typeName:Z.ZodNaN,...Q(t)});var W0=Symbol("zod_brand"),jn=class extends ee{_parse(e){let{ctx:r}=this._processInputParams(e),i=r.data;return this._def.type._parse({data:i,path:r.path,parent:r})}unwrap(){return this._def.type}},Un=class t extends ee{_parse(e){let{status:r,ctx:i}=this._processInputParams(e);if(i.common.async)return(async()=>{let s=await this._def.in._parseAsync({data:i.data,path:i.path,parent:i});return s.status==="aborted"?K:s.status==="dirty"?(r.dirty(),Wi(s.value)):this._def.out._parseAsync({data:s.value,path:i.path,parent:i})})();{let n=this._def.in._parseSync({data:i.data,path:i.path,parent:i});return n.status==="aborted"?K:n.status==="dirty"?(r.dirty(),{status:"dirty",value:n.value}):this._def.out._parseSync({data:n.value,path:i.path,parent:i})}}static create(e,r){return new t({in:e,out:r,typeName:Z.ZodPipeline})}},mi=class extends ee{_parse(e){let r=this._def.innerType._parse(e),i=n=>(ti(n)&&(n.value=Object.freeze(n.value)),n);return Bn(r)?r.then(n=>i(n)):i(r)}unwrap(){return this._def.innerType}};mi.create=(t,e)=>new mi({innerType:t,typeName:Z.ZodReadonly,...Q(e)});function pf(t,e){let r=typeof t=="function"?t(e):typeof t=="string"?{message:t}:t;return typeof r=="string"?{message:r}:r}function bf(t,e={},r){return t?Mr.create().superRefine((i,n)=>{var s,o;let a=t(i);if(a instanceof Promise)return a.then(l=>{var c,u;if(!l){let f=pf(e,i),m=(u=(c=f.fatal)!==null&&c!==void 0?c:r)!==null&&u!==void 0?u:!0;n.addIssue({code:"custom",...f,fatal:m})}});if(!a){let l=pf(e,i),c=(o=(s=l.fatal)!==null&&s!==void 0?s:r)!==null&&o!==void 0?o:!0;n.addIssue({code:"custom",...l,fatal:c})}}):Mr.create()}var $0={object:nt.lazycreate},Z;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Z||(Z={}));var V0=(t,e={message:`Input not instance of ${t.name}`})=>bf(r=>r instanceof t,e),Ef=Pr.create,Tf=ri.create,G0=Ji.create,Z0=ii.create,wf=ni.create,Y0=si.create,J0=Vi.create,K0=oi.create,X0=ai.create,Q0=Mr.create,e_=mr.create,t_=Pt.create,r_=Gi.create,i_=yr.create,n_=nt.create,s_=nt.strictCreate,o_=li.create,a_=Qs.create,l_=ci.create,c_=Yt.create,u_=eo.create,d_=Zi.create,h_=Yi.create,f_=to.create,p_=ui.create,g_=di.create,m_=hi.create,y_=fi.create,v_=Ir.create,gf=ht.create,__=_t.create,S_=Jt.create,C_=ht.createWithPreprocess,b_=Un.create,E_=()=>Ef().optional(),T_=()=>Tf().optional(),w_=()=>wf().optional(),R_={string:t=>Pr.create({...t,coerce:!0}),number:t=>ri.create({...t,coerce:!0}),boolean:t=>ni.create({...t,coerce:!0}),bigint:t=>ii.create({...t,coerce:!0}),date:t=>si.create({...t,coerce:!0})},k_=K,p=Object.freeze({__proto__:null,defaultErrorMap:$i,setErrorMap:C0,getErrorMap:Js,makeIssue:Ks,EMPTY_PATH:b0,addIssueToContext:L,ParseStatus:Je,INVALID:K,DIRTY:Wi,OK:tt,isAborted:Ml,isDirty:Il,isValid:ti,isAsync:Bn,get util(){return ae},get objectUtil(){return Pl},ZodParsedType:q,getParsedType:gr,ZodType:ee,datetimeRegex:Sf,ZodString:Pr,ZodNumber:ri,ZodBigInt:ii,ZodBoolean:ni,ZodDate:si,ZodSymbol:Vi,ZodUndefined:oi,ZodNull:ai,ZodAny:Mr,ZodUnknown:mr,ZodNever:Pt,ZodVoid:Gi,ZodArray:yr,ZodObject:nt,ZodUnion:li,ZodDiscriminatedUnion:Qs,ZodIntersection:ci,ZodTuple:Yt,ZodRecord:eo,ZodMap:Zi,ZodSet:Yi,ZodFunction:to,ZodLazy:ui,ZodLiteral:di,ZodEnum:hi,ZodNativeEnum:fi,ZodPromise:Ir,ZodEffects:ht,ZodTransformer:ht,ZodOptional:_t,ZodNullable:Jt,ZodDefault:pi,ZodCatch:gi,ZodNaN:Ji,BRAND:W0,ZodBranded:jn,ZodPipeline:Un,ZodReadonly:mi,custom:bf,Schema:ee,ZodSchema:ee,late:$0,get ZodFirstPartyTypeKind(){return Z},coerce:R_,any:Q0,array:i_,bigint:Z0,boolean:wf,date:Y0,discriminatedUnion:a_,effect:gf,enum:m_,function:f_,instanceof:V0,intersection:l_,lazy:p_,literal:g_,map:d_,nan:G0,nativeEnum:y_,never:t_,null:X0,nullable:S_,number:Tf,object:n_,oboolean:w_,onumber:T_,optional:__,ostring:E_,pipeline:b_,preprocess:C_,promise:v_,record:u_,set:h_,strictObject:s_,string:Ef,symbol:J0,transformer:gf,tuple:c_,undefined:K0,union:o_,unknown:e_,void:r_,NEVER:k_,ZodIssueCode:x,quotelessJson:S0,ZodError:dt});var Dl="2024-11-05",Rf=[Dl,"2024-10-07"],ro="2.0",kf=p.union([p.string(),p.number().int()]),xf=p.string(),Mt=p.object({_meta:p.optional(p.object({progressToken:p.optional(kf)}).passthrough())}).passthrough(),ft=p.object({method:p.string(),params:p.optional(Mt)}),vr=p.object({method:p.string(),params:p.optional(p.object({_meta:p.optional(p.object({}).passthrough())}).passthrough())}),It=p.object({_meta:p.optional(p.object({}).passthrough())}).passthrough(),Ll=p.union([p.string(),p.number().int()]),x_=p.object({jsonrpc:p.literal(ro),id:Ll}).merge(ft).strict(),O_=p.object({jsonrpc:p.literal(ro)}).merge(vr).strict(),A_=p.object({jsonrpc:p.literal(ro),id:Ll,result:It}).strict(),Ki;(function(t){t[t.ConnectionClosed=-1]="ConnectionClosed",t[t.ParseError=-32700]="ParseError",t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError"})(Ki||(Ki={}));var P_=p.object({jsonrpc:p.literal(ro),id:Ll,error:p.object({code:p.number().int(),message:p.string(),data:p.optional(p.unknown())})}).strict(),Of=p.union([x_,O_,A_,P_]),io=It.strict(),Af=p.object({name:p.string(),version:p.string()}).passthrough(),M_=p.object({experimental:p.optional(p.object({}).passthrough()),sampling:p.optional(p.object({}).passthrough()),roots:p.optional(p.object({listChanged:p.optional(p.boolean())}).passthrough())}).passthrough(),Fl=ft.extend({method:p.literal("initialize"),params:Mt.extend({protocolVersion:p.string(),capabilities:M_,clientInfo:Af})}),I_=p.object({experimental:p.optional(p.object({}).passthrough()),logging:p.optional(p.object({}).passthrough()),prompts:p.optional(p.object({listChanged:p.optional(p.boolean())}).passthrough()),resources:p.optional(p.object({subscribe:p.optional(p.boolean()),listChanged:p.optional(p.boolean())}).passthrough()),tools:p.optional(p.object({listChanged:p.optional(p.boolean())}).passthrough())}).passthrough(),N_=It.extend({protocolVersion:p.string(),capabilities:I_,serverInfo:Af}),ql=vr.extend({method:p.literal("notifications/initialized")}),no=ft.extend({method:p.literal("ping")}),D_=p.object({progress:p.number(),total:p.optional(p.number())}).passthrough(),so=vr.extend({method:p.literal("notifications/progress"),params:D_.extend({progressToken:kf})}),oo=ft.extend({params:Mt.extend({cursor:p.optional(xf)}).optional()}),ao=It.extend({nextCursor:p.optional(xf)}),Pf=p.object({uri:p.string(),mimeType:p.optional(p.string())}).passthrough(),Mf=Pf.extend({text:p.string()}),If=Pf.extend({blob:p.string().base64()}),L_=p.object({uri:p.string(),name:p.string(),description:p.optional(p.string()),mimeType:p.optional(p.string())}).passthrough(),F_=p.object({uriTemplate:p.string(),name:p.string(),description:p.optional(p.string()),mimeType:p.optional(p.string())}).passthrough(),Bl=oo.extend({method:p.literal("resources/list")}),q_=ao.extend({resources:p.array(L_)}),B_=oo.extend({method:p.literal("resources/templates/list")}),j_=ao.extend({resourceTemplates:p.array(F_)}),U_=ft.extend({method:p.literal("resources/read"),params:Mt.extend({uri:p.string()})}),z_=It.extend({contents:p.array(p.union([Mf,If]))}),H_=vr.extend({method:p.literal("notifications/resources/list_changed")}),W_=ft.extend({method:p.literal("resources/subscribe"),params:Mt.extend({uri:p.string()})}),$_=ft.extend({method:p.literal("resources/unsubscribe"),params:Mt.extend({uri:p.string()})}),V_=vr.extend({method:p.literal("notifications/resources/updated"),params:p.object({uri:p.string()}).passthrough()}),G_=p.object({name:p.string(),description:p.optional(p.string()),required:p.optional(p.boolean())}).passthrough(),Z_=p.object({name:p.string(),description:p.optional(p.string()),arguments:p.optional(p.array(G_))}).passthrough(),jl=oo.extend({method:p.literal("prompts/list")}),Y_=ao.extend({prompts:p.array(Z_)}),J_=ft.extend({method:p.literal("prompts/get"),params:Mt.extend({name:p.string(),arguments:p.optional(p.record(p.string()))})}),lo=p.object({type:p.literal("text"),text:p.string()}).passthrough(),co=p.object({type:p.literal("image"),data:p.string().base64(),mimeType:p.string()}).passthrough(),Nf=p.object({type:p.literal("resource"),resource:p.union([Mf,If])}).passthrough(),K_=p.object({role:p.enum(["user","assistant"]),content:p.union([lo,co,Nf])}).passthrough(),X_=It.extend({description:p.optional(p.string()),messages:p.array(K_)}),Q_=vr.extend({method:p.literal("notifications/prompts/list_changed")}),eS=p.object({name:p.string(),description:p.optional(p.string()),inputSchema:p.object({type:p.literal("object"),properties:p.optional(p.object({}).passthrough())}).passthrough()}).passthrough(),Hn=oo.extend({method:p.literal("tools/list")}),tS=ao.extend({tools:p.array(eS)}),Df=It.extend({content:p.array(p.union([lo,co,Nf])),isError:p.boolean().default(!1)}),Px=Df.or(It.extend({toolResult:p.unknown()})),Ul=ft.extend({method:p.literal("tools/call"),params:Mt.extend({name:p.string(),arguments:p.optional(p.record(p.unknown()))})}),rS=vr.extend({method:p.literal("notifications/tools/list_changed")}),Lf=p.enum(["debug","info","notice","warning","error","critical","alert","emergency"]),zl=ft.extend({method:p.literal("logging/setLevel"),params:Mt.extend({level:Lf})}),iS=vr.extend({method:p.literal("notifications/message"),params:p.object({level:Lf,logger:p.optional(p.string()),data:p.unknown()}).passthrough()}),nS=p.object({name:p.string().optional()}).passthrough(),sS=p.object({hints:p.optional(p.array(nS)),costPriority:p.optional(p.number().min(0).max(1)),speedPriority:p.optional(p.number().min(0).max(1)),intelligencePriority:p.optional(p.number().min(0).max(1))}).passthrough(),oS=p.object({role:p.enum(["user","assistant"]),content:p.union([lo,co])}).passthrough(),aS=ft.extend({method:p.literal("sampling/createMessage"),params:Mt.extend({messages:p.array(oS),systemPrompt:p.optional(p.string()),includeContext:p.optional(p.enum(["none","thisServer","allServers"])),temperature:p.optional(p.number()),maxTokens:p.number().int(),stopSequences:p.optional(p.array(p.string())),metadata:p.optional(p.object({}).passthrough()),modelPreferences:p.optional(sS)})}),Hl=It.extend({model:p.string(),stopReason:p.optional(p.enum(["endTurn","stopSequence","maxTokens"]).or(p.string())),role:p.enum(["user","assistant"]),content:p.discriminatedUnion("type",[lo,co])}),lS=p.object({type:p.literal("ref/resource"),uri:p.string()}).passthrough(),cS=p.object({type:p.literal("ref/prompt"),name:p.string()}).passthrough(),uS=ft.extend({method:p.literal("completion/complete"),params:Mt.extend({ref:p.union([cS,lS]),argument:p.object({name:p.string(),value:p.string()}).passthrough()})}),dS=It.extend({completion:p.object({values:p.array(p.string()).max(100),total:p.optional(p.number().int()),hasMore:p.optional(p.boolean())}).passthrough()}),hS=p.object({uri:p.string().startsWith("file://"),name:p.optional(p.string())}).passthrough(),fS=ft.extend({method:p.literal("roots/list")}),Wl=It.extend({roots:p.array(hS)}),pS=vr.extend({method:p.literal("notifications/roots/list_changed")}),Mx=p.union([no,Fl,uS,zl,J_,jl,Bl,B_,U_,W_,$_,Ul,Hn]),Ix=p.union([so,ql,pS]),Nx=p.union([io,Hl,Wl]),Dx=p.union([no,aS,fS]),Lx=p.union([so,iS,V_,H_,rS,Q_]),Fx=p.union([io,N_,dS,X_,Y_,q_,j_,z_,Df,tS]),zn=class extends Error{constructor(e,r,i){super(`MCP error ${e}: ${r}`),this.code=e,this.data=i}};var uo=class{constructor(){this._requestMessageId=0,this._requestHandlers=new Map,this._notificationHandlers=new Map,this._responseHandlers=new Map,this._progressHandlers=new Map,this.setNotificationHandler(so,e=>{this._onprogress(e)}),this.setRequestHandler(no,e=>({}))}async connect(e){this._transport=e,this._transport.onclose=()=>{this._onclose()},this._transport.onerror=r=>{this._onerror(r)},this._transport.onmessage=r=>{"method"in r?"id"in r?this._onrequest(r):this._onnotification(r):this._onresponse(r)},await this._transport.start()}_onclose(){var e;let r=this._responseHandlers;this._responseHandlers=new Map,this._progressHandlers.clear(),this._transport=void 0,(e=this.onclose)===null||e===void 0||e.call(this);let i=new zn(Ki.ConnectionClosed,"Connection closed");for(let n of r.values())n(i)}_onerror(e){var r;(r=this.onerror)===null||r===void 0||r.call(this,e)}_onnotification(e){var r;let i=(r=this._notificationHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackNotificationHandler;i!==void 0&&i(e).catch(n=>this._onerror(new Error(`Uncaught error in notification handler: ${n}`)))}_onrequest(e){var r,i;let n=(r=this._requestHandlers.get(e.method))!==null&&r!==void 0?r:this.fallbackRequestHandler;if(n===void 0){(i=this._transport)===null||i===void 0||i.send({jsonrpc:"2.0",id:e.id,error:{code:Ki.MethodNotFound,message:"Method not found"}}).catch(s=>this._onerror(new Error(`Failed to send an error response: ${s}`)));return}n(e).then(s=>{var o;(o=this._transport)===null||o===void 0||o.send({result:s,jsonrpc:"2.0",id:e.id})},s=>{var o,a;return(o=this._transport)===null||o===void 0?void 0:o.send({jsonrpc:"2.0",id:e.id,error:{code:Number.isSafeInteger(s.code)?s.code:Ki.InternalError,message:(a=s.message)!==null&&a!==void 0?a:"Internal error"}})}).catch(s=>this._onerror(new Error(`Failed to send response: ${s}`)))}_onprogress(e){let{progress:r,total:i,progressToken:n}=e.params,s=this._progressHandlers.get(Number(n));if(s===void 0){this._onerror(new Error(`Received a progress notification for an unknown token: ${JSON.stringify(e)}`));return}s({progress:r,total:i})}_onresponse(e){let r=e.id,i=this._responseHandlers.get(Number(r));if(i===void 0){this._onerror(new Error(`Received a response for an unknown message ID: ${JSON.stringify(e)}`));return}if(this._responseHandlers.delete(Number(r)),this._progressHandlers.delete(Number(r)),"result"in e)i(e);else{let n=new zn(e.error.code,e.error.message,e.error.data);i(n)}}get transport(){return this._transport}async close(){var e;await((e=this._transport)===null||e===void 0?void 0:e.close())}request(e,r,i){return new Promise((n,s)=>{if(!this._transport){s(new Error("Not connected"));return}let o=this._requestMessageId++,a={...e,jsonrpc:"2.0",id:o};i&&(this._progressHandlers.set(o,i),a.params={...e.params,_meta:{progressToken:o}}),this._responseHandlers.set(o,l=>{if(l instanceof Error)return s(l);try{let c=r.parse(l.result);n(c)}catch(c){s(c)}}),this._transport.send(a).catch(s)})}async notification(e){if(!this._transport)throw new Error("Not connected");let r={...e,jsonrpc:"2.0"};await this._transport.send(r)}setRequestHandler(e,r){this._requestHandlers.set(e.shape.method.value,i=>Promise.resolve(r(e.parse(i))))}removeRequestHandler(e){this._requestHandlers.delete(e)}setNotificationHandler(e,r){this._notificationHandlers.set(e.shape.method.value,i=>Promise.resolve(r(e.parse(i))))}removeNotificationHandler(e){this._notificationHandlers.delete(e)}};var ho=class extends uo{constructor(e){super(),this._serverInfo=e,this.setRequestHandler(Fl,r=>this._oninitialize(r)),this.setNotificationHandler(ql,()=>{var r;return(r=this.oninitialized)===null||r===void 0?void 0:r.call(this)})}async _oninitialize(e){let r=e.params.protocolVersion;return this._clientCapabilities=e.params.capabilities,this._clientVersion=e.params.clientInfo,{protocolVersion:Rf.includes(r)?r:Dl,capabilities:this.getCapabilities(),serverInfo:this._serverInfo}}getClientCapabilities(){return this._clientCapabilities}getClientVersion(){return this._clientVersion}getCapabilities(){return{prompts:this._requestHandlers.has(jl.shape.method.value)?{}:void 0,resources:this._requestHandlers.has(Bl.shape.method.value)?{}:void 0,tools:this._requestHandlers.has(Hn.shape.method.value)?{}:void 0,logging:this._requestHandlers.has(zl.shape.method.value)?{}:void 0}}async ping(){return this.request({method:"ping"},io)}async createMessage(e,r){return this.request({method:"sampling/createMessage",params:e},Hl,r)}async listRoots(e,r){return this.request({method:"roots/list",params:e},Wl,r)}async sendLoggingMessage(e){return this.notification({method:"notifications/message",params:e})}async sendResourceUpdated(e){return this.notification({method:"notifications/resources/updated",params:e})}async sendResourceListChanged(){return this.notification({method:"notifications/resources/list_changed"})}async sendToolListChanged(){return this.notification({method:"notifications/tools/list_changed"})}async sendPromptListChanged(){return this.notification({method:"notifications/prompts/list_changed"})}};var $l=hf(require("node:process"),1);var fo=class{append(e){this._buffer=this._buffer?Buffer.concat([this._buffer,e]):e}readMessage(){if(!this._buffer)return null;let e=this._buffer.indexOf(`
`);if(e===-1)return null;let r=this._buffer.toString("utf8",0,e);return this._buffer=this._buffer.subarray(e+1),gS(r)}clear(){this._buffer=void 0}};function gS(t){return Of.parse(JSON.parse(t))}function Ff(t){return JSON.stringify(t)+`
`}var po=class{constructor(e=$l.default.stdin,r=$l.default.stdout){this._stdin=e,this._stdout=r,this._readBuffer=new fo,this._started=!1,this._ondata=i=>{this._readBuffer.append(i),this.processReadBuffer()},this._onerror=i=>{var n;(n=this.onerror)===null||n===void 0||n.call(this,i)}}async start(){if(this._started)throw new Error("StdioServerTransport already started! If using Server class, note that connect() calls start() automatically.");this._started=!0,this._stdin.on("data",this._ondata),this._stdin.on("error",this._onerror)}processReadBuffer(){for(var e,r;;)try{let i=this._readBuffer.readMessage();if(i===null)break;(e=this.onmessage)===null||e===void 0||e.call(this,i)}catch(i){(r=this.onerror)===null||r===void 0||r.call(this,i)}}async close(){var e;this._stdin.off("data",this._ondata),this._stdin.off("error",this._onerror),this._readBuffer.clear(),(e=this.onclose)===null||e===void 0||e.call(this)}send(e){return new Promise(r=>{let i=Ff(e);this._stdout.write(i)?r():this._stdout.once("drain",r)})}};var f0=hf(h0()),cf=process.env.RAPIDAPP_API_KEY||"",lf=new f0.RapidappClient({apiKey:cf}),Tx=p.object({name:p.string()}),wx=p.object({id:p.string()}),uf=new ho({name:"Rapidapp",version:"1.0.0"});uf.setRequestHandler(Hn,async()=>({tools:[{name:"create_database",description:"Create a new Rapidapp PostgreSQL database",inputSchema:{type:"object",properties:{name:{type:"string",description:"Name of the database to create"}},required:["name"]}},{name:"list_databases",description:"List all Rapidapp PostgreSQL databases",inputSchema:{}},{name:"get_database",description:"Get details of a Rapidapp PostgreSQL database",inputSchema:{type:"object",properties:{id:{type:"string",description:"ID of the database to retrieve"}},required:["id"]}}]}));uf.setRequestHandler(Ul,async t=>{if(!cf||cf.trim()==="")throw new Error("RAPIDAPP_API_KEY environment variable not set. Please set this variable to use the Rapidapp API.");let{name:e,arguments:r}=t.params;try{if(e==="create_database"){let{name:i}=Tx.parse(r);return await lf.createPostgres(i),{content:[{type:"text",text:`Successfully created database: ${i}`}]}}else{if(e==="list_databases")return{content:[{type:"text",text:`Databases:
${(await lf.listPostgres()).getItemsList().map(s=>`${s.getId()}: ${s.getName()}`).join(`
`)}`}]};if(e==="get_database"){let{id:i}=wx.parse(r);return{content:[{type:"text",text:await lf.getPostgres(i)}]}}else throw new Error(`Unknown tool: ${e}`)}}catch(i){throw i instanceof p.ZodError?new Error(`Invalid arguments: ${i.errors.map(n=>`${n.path.join(".")}: ${n.message}`).join(", ")}`):i}});async function Rx(){try{let t=new po;await uf.connect(t),console.info("Rapidapp MCP Server running on stdio")}catch(t){console.error("Error during startup:",t),process.exit(1)}}Rx().catch(t=>{console.error("Fatal error in main():",t)});
/*! Bundled license information:

@grpc/proto-loader/build/src/util.js:
  (**
   * @license
   * Copyright 2018 gRPC authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   *)

long/umd/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)

@grpc/proto-loader/build/src/index.js:
  (**
   * @license
   * Copyright 2018 gRPC authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   *)
*/
